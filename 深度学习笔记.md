# 1. ä»‹ç»

## 1.1 Anaconda

Anacondaæ˜¯ä¸€ä¸ªåŒ…å«æ•°æ®ç§‘å­¦å¸¸ç”¨åŒ…çš„ Python å‘è¡Œç‰ˆæœ¬ã€‚å®ƒåŸºäº conda â€”â€”ä¸€ä¸ªåŒ…å’Œç¯å¢ƒç®¡ç†å™¨â€”â€”è¡ç”Ÿè€Œæ¥ã€‚ä½ å°†ä½¿ç”¨ conda åˆ›å»ºç¯å¢ƒï¼Œä»¥ä¾¿åˆ†éš”ä½¿ç”¨ä¸åŒ Python ç‰ˆæœ¬å’Œä¸åŒç¨‹åºåŒ…çš„é¡¹ç›®ã€‚ä½ è¿˜å°†ä½¿ç”¨å®ƒåœ¨ç¯å¢ƒä¸­å®‰è£…ã€å¸è½½å’Œæ›´æ–°åŒ…ã€‚

## 1.2 conda

condaæ˜¯ä¸€ä¸ªç¯å¢ƒç®¡ç†å™¨ï¼ŒCondaæ˜¯åœ¨Windowsã€macå’ŒLinuxä¸Šè¿è¡Œçš„å¼€æºè½¯ä»¶åŒ…ç®¡ç†ç³»ç»Ÿå’Œç¯å¢ƒç®¡ç†ç³»ç»Ÿ

Condaå¯ä»¥è½»æ¾åœ°åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šçš„ç¯å¢ƒå’Œç‰ˆæœ¬ä¸­åˆ›å»ºï¼Œä¿å­˜ï¼ŒåŠ è½½å’Œåˆ‡æ¢

ä¾‹å¦‚ï¼šåœ¨æˆ‘ä»¬åšå¤§å‹é¡¹ç›®ä¸­ï¼Œéœ€è¦3.5ç‰ˆæœ¬çš„pythonç¯å¢ƒæ—¶ï¼Œåˆ©ç”¨condaå¯ä»¥é…ç½®éœ€è¦çš„ç¯å¢ƒï¼Œå½“éœ€è¦3.8ç‰ˆæœ¬ç¯å¢ƒæ—¶ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨condaè¿›è¡Œç¯å¢ƒé…ç½®ã€‚æ–¹ä¾¿æˆ‘ä»¬åœ¨ä¹‹åæ›´æ–¹ä¾¿


# 2. ç»ˆç«¯

å¦‚å›¾åœ¨pycharmä¸­çš„Terminalä¹Ÿå¯ä»¥è¿›è¡Œç±»ä¼¼cmdçš„æ“ä½œã€‚

![image-20230512220525451](./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20230512220525451.png)

## 2.1 conda

æŸ¥çœ‹pythonç‰ˆæœ¬

```
python
python --version
```

æµ‹è¯•condaæ˜¯å¦æ­£å¸¸

```cmd
conda
```

æŸ¥çœ‹condaç‰ˆæœ¬

```
conda -V
conda --version
```

è¿›å…¥baseç¯å¢ƒ

```
activate
```

åˆ›å»ºç¯å¢ƒï¼ˆåˆ›å»º3.8ç‰ˆæœ¬åä¸ºxxxçš„ç¯å¢ƒï¼‰

```
conda create -n xxx python=3.6

egï¼šconda create -n python2 python=python2.7 numpy pandas
#åˆ›å»ºäº†python2ç¯å¢ƒï¼Œpythonç‰ˆæœ¬ä¸º2.7ï¼ŒåŒæ—¶è¿˜å®‰è£…äº†numpy pandasåŒ…
```

 é€‰æ‹©ç¯å¢ƒï¼ˆåä¸ºxxxçš„ç¯å¢ƒï¼‰

```
conda activate xxx
```

é€€å‡ºåˆ°baseç¯å¢ƒ

```
conda deactivate
```

åˆ é™¤æŸä¸ªç¯å¢ƒ

```
conda remove -n env_name --all
conda env remove -n env_name    	#ä¸Šé¢å¤±è´¥æ—¶ç”¨
conda remove package       			#åˆ é™¤å½“å‰ç¯å¢ƒä¸­çš„åŒ…
conda remove -n env_name  package   #åˆ é™¤æŒ‡å®šç¯å¢ƒä¸­çš„åŒ…
```

æŸ¥çœ‹å½“å‰æ‰€æœ‰ç¯å¢ƒ

```
conda  env  list
```

æŸ¥çœ‹å½“å‰ç¯å¢ƒçš„æ‰€æœ‰å®‰è£…åŒ…

```
conda  list  //éœ€è¿›å…¥è¯¥è™šæ‹Ÿç¯å¢ƒ
conda  list  -n  env_name
```

å®‰è£…orå¸è½½åŒ…

```
conda  install  xxx
conda  install  xxx=ç‰ˆæœ¬å·      		  	   # æŒ‡å®šç‰ˆæœ¬å·
conda  install  xxx -i æºåç§°æˆ–é“¾æ¥      		 # æŒ‡å®šä¸‹è½½æºï¼Œç›¸å¯¹ä¸Šé¢2è¡Œæ›´å¿«
conda  install --name env_name package_name  #åœ¨æŒ‡å®šç¯å¢ƒä¸­å®‰è£…åŒ…
conda  uninstall  xxx
```

condaå’Œpipçš„æ•°æ®æº

```
1ã€condaæ•°æ®æºç®¡ç†ï¼š
#æ˜¾ç¤ºç›®å‰condaçš„æ•°æ®æºæœ‰å“ªäº›
conda config --show channels
#æ·»åŠ æ•°æ®æºï¼šä¾‹å¦‚, æ·»åŠ æ¸…åanacondaé•œåƒï¼š
conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/
conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/
conda config --set show_channel_urls yes
#åˆ é™¤æ•°æ®æº
conda config --remove channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/
#æ˜¾ç¤ºç›®å‰pipçš„æ•°æ®æºæœ‰å“ªäº›
pip config list
pip config list --[user|global] # åˆ—å‡ºç”¨æˆ·|å…¨å±€çš„è®¾ç½®
pip config get global.index-url # å¾—åˆ°è¿™keyå¯¹åº”çš„value å¦‚ï¼šhttps://mirrors.aliyun.com/pypi/simple/
#æ·»åŠ æ•°æ®æºï¼šä¾‹å¦‚, æ·»åŠ USTCä¸­ç§‘å¤§çš„æºï¼š
pip config set global.index-url https://mirrors.ustc.edu.cn/pypi/web/simple
#æ·»åŠ å…¨å±€ä½¿ç”¨è¯¥æ•°æ®æº
pip config set global.trusted-host https://mirrors.ustc.edu.cn/pypi/web/simple
# åˆ é™¤
pip config unset key
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
tipsï¼š
#æœ¬äººçš„ ~/.condarc
auto_activate_base: false
channels:
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/pytorch/
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/menpo/
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/bioconda/
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/msys2/
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud/conda-forge/
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/
  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/
    show_channel_urls: true
```

## 1.3 cuda







# 3. IDE

## 3.1 pycharm

### 3.1.1 pytharmæ·»åŠ è§£é‡Šå™¨

é€‰æ‹©condaå®‰è£…è·¯å¾„çš„python.exe

![image-20230512222231529](./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20230512222231529.png)



## 3.2 ç¼–è¾‘å™¨Jupyter





# 4. å¸¸ç”¨åº“(å‡½æ•°)

## 4.0 python

### 4.0.1 for i,x in enumerate(xxx)

enumerate() å‡½æ•°ç”¨äºå°†ä¸€ä¸ªå¯éå†çš„æ•°æ®å¯¹è±¡(å¦‚åˆ—è¡¨ã€å…ƒç»„æˆ–å­—ç¬¦ä¸²)ç»„åˆä¸ºä¸€ä¸ªç´¢å¼•åºåˆ—ï¼ŒåŒæ—¶åˆ—å‡ºæ•°æ®å’Œæ•°æ®ä¸‹æ ‡ï¼Œä¸€èˆ¬ç”¨åœ¨ for å¾ªç¯å½“ä¸­

```py
seq = ['one', 'two', 'three']
 for i, element in enumerate(seq):
...     print i, element
... 
0 one
1 two
2 three
```

#### 4.0.1.1 åº”ç”¨:ç±»åˆ«åè½¬æ•°å­—æ ‡ç­¾

æ•°æ®é›†æ˜¯kaggleçš„dog breedè¿™ä¸ªç«èµ›ä¸­çš„æ ‡ç­¾æ–‡ä»¶ï¼Œåä¸º`'labels.csv'`ï¼Œå‰5è¡Œå¦‚ä¸‹ï¼š

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/20190610181254822.png)

```py
class_df = pd.read_csv('labels.csv')
class_df.head()
class_to_idx = {x:i for i,x in enumerate(class_df.breed.unique())}
idx_to_class = {i:x for i,x in enumerate(class_df.breed.unique())}
```



## 4.1 osåº“

### 4.1.1 os.path

os.path æ¨¡å—æ˜¯ç³»ç»Ÿè·¯å¾„æ“ä½œæ¨¡å—ï¼Œå…¶ä¸­ï¼Œæ–œæ ("/")æ˜¯ linux ç³»ç»Ÿä¸‹çš„è·¯å¾„åˆ†éš”ç¬¦ï¼Œå’Œåæ–œæ ("\")æ˜¯ windows ç³»ç»Ÿä¸‹çš„è·¯å¾„åˆ†éš”ç¬¦ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œåªè¦æä¾›ä¸€ä¸ªåŒ…å«æ–œæ å’Œåæ–œæ çš„å­—ç¬¦ä¸²ï¼Œos.path æ¨¡å—éƒ½èƒ½å¤„ç†ï¼Œå“ªæ€•è¯¥å­—ç¬¦ä¸²ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„çœŸæ­£è·¯å¾„ï¼Œå› ä¸º os.path æ¨¡å—çš„æºç å®ç°å°±æ˜¯æ ¹æ®æ“ä½œç³»ç»Ÿæ¥å¤„ç†æ–œæ å’Œåæ–œæ çš„æ“ä½œçš„ã€‚

#### os.path.join**(path1, path2, ...)**

è·¯å¾„åˆå¹¶å‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°ä¼šæŠŠæ‰€æœ‰å‚æ•°åˆå¹¶æˆä¸€ä¸ªè·¯å¾„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­é™¤äº†æœ€åä¸€ä¸ªå‚æ•°ä¹‹å¤–ï¼Œå…¶å®ƒæ‰€æœ‰å‚æ•°éƒ½ä¼šè‡ªåŠ¨åœ¨å­—ç¬¦ä¸²æœ«å°¾æ·»åŠ ç›®å½•åˆ†éš”ç¬¦(æ–œæ æˆ–è€…åæ–œæ )ï¼Œlinuxç³»ç»Ÿä¸‹é»˜è®¤æ·»åŠ æ–œæ ï¼Œwindowsä¸‹é»˜è®¤æ·»åŠ ä¸€ä¸ªåæ–œæ 

#### os.path.abspath(path)

*è·å–æ–‡ä»¶å½“å‰ç›®å½•çš„ç»å¯¹è·¯å¾„*

```py
import os
 
print(os.path.abspath(".")) #å½“å‰ç›®å½•çš„ç»å¯¹è·¯å¾„
 
print(os.path.abspath(r"..")) #ä¸Šçº§ç›®å½•çš„ç»å¯¹è·¯å¾„
 
print(os.path.abspath(r"D:\python_workshop\python6\revise\å‡½æ•°.py"))
```

##### è·å–å½“å‰ç›®å½•ä¸Šä¸€çº§ç›®å½•è·¯å¾„

```py
print(os.path.abspath(os.path.join(os.getcwd(), "..")))
```





### 4.1.2 osæ¨¡å—å¸¸ç”¨å‡½æ•°

#### [os.listdir(path)](https://www.runoob.com/python3/python3-os-listdir.html) 

è¿”å›pathæŒ‡å®šçš„æ–‡ä»¶å¤¹åŒ…å«çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„åå­—çš„listã€‚

```python
import os
path = "dataset\\train\\ants"
img_path_list = os.listdir(path) 
```

os.getcwd( )

```py
#getcwd()ï¼šè¯¥å‡½æ•°ä¸éœ€è¦ä¼ é€’å‚æ•°ï¼Œè·å¾—å½“å‰æ‰€è¿è¡Œè„šæœ¬çš„è·¯å¾„
```





## 4.2 [Pillow(PIL)](https://blog.csdn.net/weixin_43790276/article/details/108478270?ydreferer=aHR0cHM6Ly9jbi5iaW5nLmNvbS8%3D)

#### å®‰è£… pip install pillow

```python
#å¯¼åŒ…æ—¶è¦ç”¨PILæ¥å¯¼å…¥ï¼Œè€Œä¸èƒ½ç”¨pillowæˆ–Pillow
import PIL æˆ–
from PIL import Image
```

#### Image.open() ã€Image.show() 

```python
from PIL import Image
 
image = Image.open("yazi.jpg")
image.show()
#æ³¨æ„ï¼Œå¦‚æœå›¾ç‰‡æ˜¯pngæ ¼å¼ï¼Œåˆ™æœ‰4ä¸ªé€šé“(RGB+ä¸€ä¸ªé€æ˜é€šé“)ï¼Œåœ¨å¤„ç†æ—¶è¿˜éœ€è¦åŠ ä¸Š:
image = image.convert('RGB')
#å¹¶ä¸”ï¼Œä¸åŒæˆªå›¾è½¯ä»¶æˆªå›¾ä¿å­˜çš„é€šé“æ•°ä¸åŒ

#è½¬æ¢æˆtensoræ ¼å¼
image = transform(image)
```



## 4.3 pytorch

*pytorchå¯ä»¥è¯´æ˜¯torchçš„pythonç‰ˆï¼Œå¹¶å¢åŠ äº†å¾ˆå¤šæ–°åŠŸèƒ½*

*å®‰è£…pytorch*ï¼š

è¿›å…¥pytorchå®˜ç½‘é€‰æ‹©å¯¹åº”é…ç½®è¿›è¡Œå®‰è£…

```py
#è¿›å…¥å¯¹åº”è™šæ‹Ÿç¯å¢ƒ
conda activate xxx
#ç‹¬æ˜¾å®‰è£…ï¼š
#è¿™é‡Œè‹¥pythonä¸º3.6ï¼Œå®‰è£…1.8.1
conda install pytorch==1.8.1 torchvision==0.9.1 torchaudio==0.8.1 cudatoolkit=10.2
conda install pytorch torchvision torchaudio pytorch-cuda=11.7

#æ ¸æ˜¾å®‰è£…é€‰cpu=noneé€‰é¡¹

#æ£€æµ‹å®‰è£…æ˜¯å¦æˆåŠŸ
import torch 
print(torch.__version__)    #æ˜¾ç¤ºç‰ˆæœ¬
print("gpu", torch.cuda.is_available())  #gpu TRUE
```



### 4.3.1 [Datasetã€DataLoader](https://blog.csdn.net/weixin_44211968/article/details/123744513?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169405322416800186594999%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169405322416800186594999&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-123744513-null-null.142^v93^insert_down28v1&utm_term=torch%20Dataset&spm=1018.2226.3001.4187)

è®­ç»ƒæ¨¡å‹ä¸€èˆ¬éƒ½æ˜¯å…ˆå¤„ç† **æ•°æ®çš„è¾“å…¥é—®é¢˜** å’Œ **é¢„å¤„ç†é—®é¢˜** ã€‚Pytorchæä¾›äº†å‡ ä¸ªæœ‰ç”¨çš„å·¥å…·ï¼štorch.utils.data.Dataset ç±»å’Œ torch.utils.data.DataLoader ç±» ã€‚

æµç¨‹æ˜¯å…ˆæŠŠåŸå§‹æ•°æ®è½¬å˜æˆ torch.utils.data.Dataset ç±»ï¼Œéšåå†æŠŠå¾—åˆ°çš„ torch.utils.data.Dataset ç±»å½“ä½œä¸€ä¸ªå‚æ•°ä¼ é€’ç»™ torch.utils.data.DataLoader ç±»ï¼Œå¾—åˆ°ä¸€ä¸ªæ•°æ®åŠ è½½å™¨ï¼Œè¿™ä¸ªæ•°æ®åŠ è½½å™¨æ¯æ¬¡å¯ä»¥è¿”å›ä¸€ä¸ª Batch çš„æ•°æ®ä¾›æ¨¡å‹è®­ç»ƒä½¿ç”¨ã€‚

åœ¨ pytorch ä¸­ï¼Œæä¾›äº†ä¸€ç§ååˆ†æ–¹ä¾¿çš„æ•°æ®è¯»å–æœºåˆ¶ï¼Œå³ä½¿ç”¨ torch.utils.data.Dataset ä¸ Dataloader ç»„åˆå¾—åˆ°æ•°æ®è¿­ä»£å™¨ã€‚åœ¨æ¯æ¬¡è®­ç»ƒæ—¶ï¼Œåˆ©ç”¨è¿™ä¸ªè¿­ä»£å™¨è¾“å‡ºæ¯ä¸€ä¸ª batch æ•°æ®ï¼Œå¹¶èƒ½åœ¨è¾“å‡ºæ—¶å¯¹æ•°æ®è¿›è¡Œç›¸åº”çš„é¢„å¤„ç†æˆ–æ•°æ®å¢å¹¿æ“ä½œã€‚

#### Dataset

Dataset æ˜¯ä¸€ä¸ª **æ•°æ®é›†** æŠ½è±¡ç±»ï¼Œå®ƒæ˜¯å…¶ä»–æ‰€æœ‰æ•°æ®é›†ç±»çš„çˆ¶ç±»ï¼ˆæ‰€æœ‰å…¶ä»–æ•°æ®é›†ç±»éƒ½åº”è¯¥ç»§æ‰¿å®ƒï¼‰ï¼Œç»§æ‰¿æ—¶éœ€è¦é‡å†™æ–¹æ³• `__len__` å’Œ `__getitem__` ï¼Œ `__len__` æ˜¯æä¾›æ•°æ®é›†å¤§å°çš„æ–¹æ³•ï¼Œ `__getitem__` æ˜¯å¯ä»¥é€šè¿‡ç´¢å¼•å·æ‰¾åˆ°æ•°æ®çš„æ–¹æ³•ã€‚

ä»¥ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„è‡ªå®šä¹‰æ•°æ®é›†ç±»é‡å†™demo

```py
class MyDataset(Dataset):
    root_dir = ''
    label_dir = ''
    path = ''
    img_path_list = ''
    
    def __init__(self,root_dir,label_dir):
        ...
    
    def __getitem__(self,idx):
        img_name = self.img_path_list[idx]
        img_item_path = os.path.join(...)
    	img = Image.open(img_item_path)
        label = self.label_dir
        return img,label
    
    def __len__(self):
        return len(img_path_list)
```

â€‹			

## 4.4 torch.utils.tenserBoard

### 4.4.1 ä»‹ç»

TensorBoard æ˜¯ä¸€ç»„ç”¨äº[æ•°æ®å¯è§†åŒ–)çš„å·¥å…·ã€‚TensorBoard åŒ…å«åœ¨ TensorFlow åº“ä¸­ï¼Œå¯ä»¥ç›´æ¥ç”¨ï¼Œä½†åœ¨pytorchä¸­ä¸è¡Œï¼Œpytorchè¦å•ç‹¬å®‰è£… TensorBoard å¯ä»¥ä½¿ç”¨**pip install tensorboard**

å®‰è£…

```py
pip install tensorboard
```



### 4.4.2 åŸºæœ¬ä½¿ç”¨

#### 1 æ ‡é‡å±•ç¤ºwriter.add_scalar

```py
from torch.utils.tensorboard import SummaryWriter

writer = SummaryWriter("logs")
#y=x
for i in range(100):
    writer.add_scalar("y=2x",2i,i)  #å±•ç¤ºy=2xå‡½æ•°å›¾åƒ

writer.close()
```

#### 2 å›¾åƒå±•ç¤ºadd_image

```py
from torch.utils.tensorboard import SummaryWriter            tensorboardå¯è§†åŒ–åº“
import numpy as np								PILç±»å‹ä¸èƒ½ç›´æ¥è¢«writerè¯»å–ï¼Œè½¬æˆnumpy
from PIL import Image							ç”¨äºå¯¼å…¥å›¾ç‰‡

writer = SummaryWriter("logs")

image_path="D:\Pytorch_learn_project\data\\train\\ants_image\\24335309_c5ea483bb8.jpg"   å›¾ç‰‡è·¯å¾„
img_PIL= Image.open(image_path)         æ ¹æ®ä¸Šè¿°è·¯å¾„æ‰“å¼€å›¾ç‰‡
img_array = np.array(img_PIL)			è½¬ä¸ºnumpyç±»å‹ï¼Œæ–¹ä¾¿æŒ‰ç…§numpyç±»å‹ä¿å­˜å›¾ç‰‡çš„æ•°æ®ä¿¡æ¯

#ä½¿ç”¨writer.add_image()å‡½æ•°å±•ç¤ºå›¾ç‰‡ï¼Œæœ€åå…³é—­writer()ï¼Œè¿™é‡Œä¸æ˜¯é»˜è®¤çš„CHWå½¢çŠ¶ï¼Œè¿™é‡Œéœ€è®°å¾—æ ‡æ˜æ•°æ®çš„å½¢çŠ¶
writer.add_image("test1",img_array,2,dataformats='HWC')#2æ˜¯æ­¥é•¿
writer.close()

```

#### 3 ç»ˆç«¯å¯ç”¨tensorboard

```py
#åœ¨ç»ˆç«¯è¾“å…¥å‘½ä»¤å¯ç”¨tensorboardçš„webç«¯
#è®°ä½ä¸€å®šè¦åœ¨å¯¹åº”æ–‡ä»¶çš„ä¸Šçº§ç›®å½•çš„ç»ˆç«¯
tensorboard --logdir=è¦ä¿å­˜çš„ç›®æ ‡ç›®å½• --port=6007
```

#### 4 webç«¯æŸ¥çœ‹å›¾åƒäº‹é¡¹

***æ·±è‰²çº¿ï¼šå¹³æ»‘å¤„ç†ï¼›æµ…è‰²çº¿ï¼šçœŸå®æ›²çº¿***

![image-20230924103527899](./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20230924103527899.png)





## 4.5 torch.tensor

åœ¨[ç¥ç»ç½‘ç»œ](https://so.csdn.net/so/search?q=ç¥ç»ç½‘ç»œ&spm=1001.2101.3001.7020)çš„è®¡ç®—ä¸­ï¼Œæ•°æ®éƒ½æ˜¯ä»¥tensorï¼ˆå¼ é‡ï¼‰çš„å½¢å¼è¿›è¡Œä¼ é€’å’Œè¿ç®—çš„.
tensoræ˜¯å¯¹ä¸€ç±»æ•°å­¦æ¦‚å¿µçš„ä¸€ä¸ªæ¦‚æ‹¬ï¼š

- 0ç»´tensor = æ•°å­— = æ ‡é‡
- 1ç»´tensor = åºåˆ— = å‘é‡
- 2ç»´tensor = 2ç»´åºåˆ— = çŸ©é˜µ
- nç»´tensor = nç»´åºåˆ—

å…¶ä¸­nä¹Ÿä»£è¡¨äº†è®¿é—®tensorä¸­æŸä¸ªå…ƒç´ æ‰€éœ€è¦çš„indexsçš„æ•°é‡ï¼Œä¾‹å¦‚å¯¹äºä¸€ä¸ª2ç»´çš„tensor:

> a = [
> [1, 2],
> [3, 4]
> ]

å½“æˆ‘ä»¬æƒ³è¦è®¿é—®3è¿™ä¸ªå…ƒç´ æ—¶å€™éœ€è¦è¾“å…¥:a[1] [0] å¾—åˆ°3

å¯ä»¥çœ‹åˆ°ï¼Œéœ€è¦2ä¸ªindexs.

Tensorä¸­é™¤äº†æ•°æ®ï¼Œè¿˜åŒ…è£…äº†ç¥ç»ç½‘ç»œä¸­å¦‚æ¢¯åº¦ç­‰çš„ä¸€äº›åŸºæœ¬å±æ€§ï¼Œæ‰€ä»¥è¯´æ•°æ®åœ¨ç¥ç»ç½‘ç»œä¸­ä¸€å®šè¦è½¬æ¢æˆtensorå‹å†è¿›è¡Œè®­ç»ƒ

![image-20230911193346920](./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20230911193346920.png)

### 4.5.1 tensorä¸Tensorçš„åŒºåˆ«

é¦–å…ˆï¼Œtorch.Tensoræ˜¯ä¸€ä¸ªç±»ï¼Œæ‰€æœ‰çš„tensoréƒ½æ˜¯Tensorçš„ä¸€ä¸ªå®ä¾‹ï¼›è€Œtorch.tensoræ˜¯ä¸€ä¸ªå‡½æ•°ã€‚è¿™ä¹Ÿè¯´æ˜äº†ä¸ºä»€ä¹ˆä½¿ç”¨torch.Tensor()æ²¡æœ‰é—®é¢˜è€Œtorch.tensor()å´æœ‰é—®é¢˜ã€‚
å…¶æ¬¡ï¼Œtorch.tensorä¸»è¦æ˜¯å°†ä¸€ä¸ªdataå°è£…æˆtensorï¼Œå¹¶ä¸”å¯ä»¥æŒ‡å®šrequires_gradã€‚
torch.tensor(data,dtype=None,device=None,requires_grad=False) - > Tensor
æœ€åï¼Œæˆ‘ä»¬æ›´å¤šåœ°ä½¿ç”¨torch.tensorï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨torch.tensor(())æ¥è¾¾åˆ°ä¸torch.Tensor()åŒæ ·çš„æ•ˆæœã€‚

```py
import torch
import numpy as np

a = torch.Tensor([2,3])
print(a.dtype)  # torch.floaat32

b = torch.tensor([2,3])
print(b.dtype)  # torch.int64

c = np.array(2,3)
print(c.dtype) # int64
```

### 4.5.2 tensorçš„ä¸€äº›æ“ä½œ

#### 1 cat()

```py
#å®ç°æ‹¼æ¥
b=torch.randn(3,3)
print(b)
tensor([[-0.0733, -0.4884,  0.9050],
        [-1.2613,  0.8577,  0.2139],
        [ 0.3336, -1.9796, -0.1387]])

e=torch.cat((b,b), dim=0) #dim=0æ˜¯æŒ‰è¡Œæ‹¼æ¥
>>>e
tensor([[-0.0733, -0.4884,  0.9050],
        [-1.2613,  0.8577,  0.2139],
        [ 0.3336, -1.9796, -0.1387],
        [-0.0733, -0.4884,  0.9050],
        [-1.2613,  0.8577,  0.2139],
        [ 0.3336, -1.9796, -0.1387]])


d=torch.cat((b,b),dim=1)  #ç»´åº¦ä¸º1æ˜¯æŒ‰åˆ—æ‹¼æ¥
print(d)
tensor([[-0.0733, -0.4884,  0.9050, -0.0733, -0.4884,  0.9050],
        [-1.2613,  0.8577,  0.2139, -1.2613,  0.8577,  0.2139],
        [ 0.3336, -1.9796, -0.1387,  0.3336, -1.9796, -0.1387]])
```



### 4.5.3 tensorçš„å±æ€§

#### 1 æ¢¯åº¦ç›¸å…³

**requires_grad**: å¦‚æœéœ€è¦ä¸ºå¼ é‡è®¡ç®—æ¢¯åº¦ï¼Œåˆ™ä¸ºTrueï¼Œå¦åˆ™ä¸ºFalseã€‚æˆ‘ä»¬ä½¿ç”¨[pytorch](https://so.csdn.net/so/search?q=pytorch&spm=1001.2101.3001.7020)åˆ›å»ºtensoræ—¶ï¼Œå¯ä»¥æŒ‡å®šrequires_gradä¸ºTrueï¼ˆé»˜è®¤ä¸ºFalseï¼‰

**grad_fn**ï¼š grad_fnç”¨æ¥è®°å½•å˜é‡æ˜¯æ€ä¹ˆæ¥çš„ï¼Œæ–¹ä¾¿è®¡ç®—æ¢¯åº¦ï¼Œy = x*3,grad_fnè®°å½•äº†yç”±xè®¡ç®—çš„è¿‡ç¨‹ã€‚

**grad**ï¼šå½“æ‰§è¡Œå®Œäº†backward()ä¹‹åï¼Œé€šè¿‡x.gradæŸ¥çœ‹xçš„æ¢¯åº¦å€¼ã€‚

```py
>>x = torch.ones(2, 2, requires_grad=True)
 
tensor([[1., 1.],
 
        [1., 1.]], requires_grad=True)
 
>>print(x.grad_fn)  # None
------------------------------------------------
>>y = x + 2
tensor([[3., 3.],
 
        [3., 3.]], grad_fn=<AddBackward>)
 
>>print(y.grad_fn)  # <AddBackward object at 0x1100477b8>
```

æ³¨æ„ï¼šgradåœ¨åå‘ä¼ æ’­è¿‡ç¨‹ä¸­æ˜¯ç´¯åŠ çš„(accumulated)ï¼Œè¿™æ„å‘³ç€æ¯ä¸€æ¬¡è¿è¡Œåå‘ä¼ æ’­ï¼Œæ¢¯åº¦éƒ½ä¼šç´¯åŠ ä¹‹å‰çš„æ¢¯åº¦ï¼Œæ‰€ä»¥ä¸€èˆ¬åœ¨åå‘ä¼ æ’­ä¹‹å‰éœ€æŠŠæ¢¯åº¦æ¸…é›¶ã€‚



#### 2 item()

```py
import torch
a = torch.tensor(5)

print(a) #tensor(5)
print(a.item()) # 5
```





## 4.6 torchvision/torch

torchvision å·¥å…·åº“æ˜¯ pytorch æ¡†æ¶ä¸‹å¸¸ç”¨çš„å›¾åƒè§†é¢‘å¤„ç†åŒ…ï¼Œå¯ä»¥ç”¨æ¥ç”Ÿæˆå›¾ç‰‡å’Œè§†é¢‘æ•°æ®é›†ï¼ˆtorchvision.datasetsï¼‰ï¼Œåšä¸€äº›å›¾åƒé¢„å¤„ç†(torchvision.transforms)ï¼Œå¯¼å…¥é¢„è®­ç»ƒæ¨¡å‹(torchvision.models)ï¼Œä»¥åŠç”Ÿæˆå’Œä¿å­˜å›¾åƒï¼ˆtorchvision.utilsï¼‰ã€‚

### 4.6.1 torchvision.transforms

transformså‡½æ•°å¯¹å›¾åƒåšé¢„å¤„ç†å¯ä»¥æ˜¯ï¼šå½’ä¸€åŒ–(normalize)ï¼Œå°ºå¯¸å‰ªè£(resize)ï¼Œç¿»è½¬(flip) ç­‰ã€‚

ä¸Šé¢çš„è¿™äº›æ­¥éª¤å®é™…æ“ä½œèµ·æ¥å¾€å¾€æ˜¯ä¸€ç³»åˆ—çš„ï¼Œæ­¤æ—¶å¯ä»¥ç”¨composeå°†è¿™äº›å›¾åƒé¢„å¤„ç†æ“ä½œè¿èµ·æ¥ã€‚

#### 1 transforms.ToTensor

````py
- å¯ä»¥å°†PILå’Œnumpy.ndarryæ ¼å¼çš„æ•°æ®ä»[0,255]èŒƒå›´è½¬æ¢åˆ°[0,1] ï¼Œå…¶å®å†…éƒ¨å°±æ˜¯å°†åŸå§‹æ•°æ®ç›´æ¥é™¤ä»¥255ã€‚
- å¦å¤–åŸå§‹æ•°æ®çš„shapeæ˜¯ï¼ˆH x W x Cï¼‰ï¼Œé€šè¿‡`transforms.ToTensor()`åshapeä¼šå˜ä¸ºï¼ˆC x H x Wï¼‰ã€‚

```py
import cv2
import numpy as np
import torch
from torchvision import transforms

#åŸå§‹æ•°æ®æ¨¡å‹
data = np.array([
                [[1,1,1],[1,1,1],[1,1,1],[1,1,1],[1,1,1]],
                [[2,2,2],[2,2,2],[2,2,2],[2,2,2],[2,2,2]],
                [[3,3,3],[3,3,3],[3,3,3],[3,3,3],[3,3,3]],
                [[4,4,4],[4,4,4],[4,4,4],[4,4,4],[4,4,4]],
                [[5,5,5],[5,5,5],[5,5,5],[5,5,5],[5,5,5]]
        ],dtype='uint8')

#toTensorè½¬æ¢
data = transforms.ToTensor()(data)

#è¾“å‡º
print(data)
print(data.shape) #torch.Size([3, 5, 5])CHW
--------------------------------------------------------
#1/255=0.0039
tensor([[[0.0039, 0.0039, 0.0039, 0.0039, 0.0039],
         [0.0078, 0.0078, 0.0078, 0.0078, 0.0078],
         [0.0118, 0.0118, 0.0118, 0.0118, 0.0118],
         [0.0157, 0.0157, 0.0157, 0.0157, 0.0157],
         [0.0196, 0.0196, 0.0196, 0.0196, 0.0196]],
        .......
         [[0.0039, 0.0039, 0.0039, 0.0039, 0.0039],
         [0.0078, 0.0078, 0.0078, 0.0078, 0.0078],
         [0.0118, 0.0118, 0.0118, 0.0118, 0.0118],
         [0.0157, 0.0157, 0.0157, 0.0157, 0.0157],
         [0.0196, 0.0196, 0.0196, 0.0196, 0.0196]]])
```

#ToTensoråŠŸèƒ½æ˜¯å°† PIL Image ç±»å‹ æˆ–è€…numpy.ndarrayç±»å‹çš„å›¾ç‰‡å¯¹è±¡è½¬æ¢ä¸º tensorç±»å‹ã€‚from torchvision import transforms

#è¿™æ˜¯å°†PILimageç±»å‹è½¬æ¢æˆtensorç±»å‹ï¼Œç›´æ¥ç”¨transformsçš„è½¬æ¢å·¥å…·
from PIL import Image
from torchvision import transforms

img_path = "testdata/train/ants_image/6743948_2b8c096dda.jpg"
img = Image.open(img_path)
tensor_tool = transforms.ToTensor()
tensor_img = tensor_tool(img)
print(tensor_img)

#è¿™å…ˆå¾—åˆ°numpy.ndarryç±»å‹å†è½¬æ¢æˆtensorç±»å‹ï¼Œå¾—åˆ°ndarryç±»å‹éœ€è¦ä½¿ç”¨opencvï¼ˆcv2ï¼‰
````

#### 2 [transforms.Normalize](https://blog.csdn.net/qq_40507857/article/details/116600119?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169448288016800227484660%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169448288016800227484660&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-116600119-null-null.142^v93^insert_down28v1&utm_term=transforms.normalize&spm=1018.2226.3001.4187&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g%2Fc3BtPTEwMDEuMjEwMS4zMDAxLjQ0OTgmcT10cmFuc2Zvcm1zLm5vcm1hbGl6ZSZ0PSZ1PQ%3D%3D)

![image-20220416200305159](https://img-blog.csdnimg.cn/img_convert/c9ac9390e825a69f6af3763baac8852e.png#pic_center)

å¯ä»¥çœ‹åˆ°è¿™ä¸ªå‡½æ•°çš„è¾“å‡º`output[channel] = (input[channel] - mean[channel]) / std[channel]`ã€‚è¿™é‡Œ[channel]çš„æ„æ€æ˜¯æŒ‡å¯¹ç‰¹å¾å›¾çš„æ¯ä¸ªé€šé“éƒ½è¿›è¡Œè¿™æ ·çš„æ“ä½œã€‚ã€meanä¸ºå‡å€¼ï¼Œstdä¸ºæ ‡å‡†å·®ã€‘

è¿™é‡Œçš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆ0.5ï¼Œ0.5ï¼Œ0.5ï¼‰è¡¨ç¤ºæ¯ä¸ªé€šé“çš„å‡å€¼éƒ½æ˜¯0.5ï¼Œç¬¬äºŒä¸ªå‚æ•°ï¼ˆ0.5ï¼Œ0.5ï¼Œ0.5ï¼‰è¡¨ç¤ºæ¯ä¸ªé€šé“çš„æ–¹å·®éƒ½ä¸º0.5ã€‚ã€å› ä¸ºå›¾åƒä¸€èˆ¬æ˜¯ä¸‰ä¸ªé€šé“ï¼Œæ‰€ä»¥è¿™é‡Œçš„å‘é‡éƒ½æ˜¯1x3çš„ğŸµğŸµğŸµã€‘æœ‰äº†è¿™ä¸¤ä¸ªå‚æ•°åï¼Œå½“æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªå›¾åƒæ—¶ï¼Œå°±ä¼šæŒ‰ç…§ä¸Šé¢çš„å…¬å¼å¯¹å›¾åƒè¿›è¡Œå˜æ¢ã€‚ã€**æ³¨æ„ï¼šè¿™é‡Œè¯´å›¾åƒå…¶å®ä¹Ÿä¸å¤Ÿå‡†ç¡®ï¼Œå› ä¸ºè¿™ä¸ªå‡½æ•°ä¼ å…¥çš„æ ¼å¼ä¸èƒ½ä¸ºPIL Imageï¼Œæˆ‘ä»¬åº”è¯¥å…ˆå°†å…¶è½¬æ¢ä¸ºTensoræ ¼å¼**ã€‘è¯´äº†è¿™ä¹ˆå¤šï¼Œé‚£ä¹ˆè¿™ä¸ªå‡½æ•°åˆ°åº•æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿæˆ‘ä»¬é€šè¿‡å‰é¢çš„ToTensorå·²ç»å°†æ•°æ®å½’ä¸€åŒ–åˆ°äº†0-1ä¹‹é—´ï¼Œç°åœ¨åˆæ¥ä¸Šäº†ä¸€ä¸ªNormalizeå‡½æ•°æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿå…¶å®Normalizeå‡½æ•°åšçš„æ˜¯å°†æ•°æ®å˜æ¢åˆ°äº†[-1,1]ä¹‹é—´ã€‚ä¹‹å‰çš„æ•°æ®ä¸º0-1ï¼Œå½“å–0æ—¶ï¼Œoutput =ï¼ˆ0 - 0.5ï¼‰/ 0.5 = -1ï¼›å½“å–1æ—¶ï¼Œoutput =ï¼ˆ1 - 0.5ï¼‰/ 0.5 = 1ã€‚è¿™æ ·å°±æŠŠæ•°æ®ç»Ÿä¸€åˆ°äº†[-1ï¼Œ1]ä¹‹é—´äº†ğŸŒ±ğŸŒ±ğŸŒ±é‚£ä¹ˆé—®é¢˜åˆæ¥äº†ï¼Œæ•°æ®ç»Ÿä¸€åˆ°[-1ï¼Œ1]æœ‰ä»€ä¹ˆå¥½å¤„å‘¢ï¼Ÿæ•°æ®å¦‚æœåˆ†å¸ƒåœ¨(0,1)ä¹‹é—´ï¼Œå¯èƒ½å®é™…çš„biasï¼Œå°±æ˜¯ç¥ç»ç½‘ç»œçš„è¾“å…¥bä¼šæ¯”è¾ƒå¤§ï¼Œè€Œæ¨¡å‹åˆå§‹åŒ–æ—¶b=0çš„ï¼Œè¿™æ ·ä¼šå¯¼è‡´ç¥ç»ç½‘ç»œæ”¶æ•›æ¯”è¾ƒæ…¢ï¼Œç»è¿‡Normalizeåï¼Œå¯ä»¥åŠ å¿«æ¨¡å‹çš„æ”¶æ•›é€Ÿåº¦ã€‚ã€è¿™å¥è¯æ˜¯å†ç½‘ç»œä¸Šæ‰¾åˆ°æœ€å¤šçš„è§£é‡Šï¼Œè‡ªå·±ä¹Ÿä¸ç¡®å®šå…¶æ­£ç¡®æ€§ã€‘

â€ƒâ€ƒè¯»åˆ°è¿™é‡Œå¤§å®¶æ˜¯ä¸æ˜¯ä»¥ä¸ºå°±å®Œäº†å‘¢ï¼Ÿè¿™é‡Œè¿˜æƒ³å’Œå¤§å®¶å” ä¸Šä¸€å” ğŸ“ğŸ“ğŸ“ä¸Šé¢çš„ä¸¤ä¸ªå‚æ•°ï¼ˆ0.5ï¼Œ0.5ï¼Œ0.5ï¼‰æ˜¯æ€ä¹ˆå¾—æ¥çš„å‘¢ï¼Ÿè¿™æ˜¯æ ¹æ®æ•°æ®é›†ä¸­çš„æ•°æ®è®¡ç®—å‡ºçš„å‡å€¼å’Œæ ‡å‡†å·®ï¼Œæ‰€ä»¥å¾€å¾€ä¸åŒçš„æ•°æ®é›†è¿™ä¸¤ä¸ªå€¼æ˜¯ä¸åŒçš„
â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

ç»è¿‡ä¸Šé¢normalize()çš„å˜æ¢åå˜æˆäº†å‡å€¼ä¸º0 æ–¹å·®ä¸º1ï¼ˆå…¶å®å°±æ˜¯æœ€å¤§æœ€å°å€¼ä¸º1å’Œ-1ï¼‰

æ¯ä¸ªæ ·æœ¬å›¾åƒå˜æˆäº†å‡å€¼ä¸º0 æ–¹å·®ä¸º1 çš„æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œè¿™å°±æ˜¯æœ€æ™®é€šï¼ˆç§‘å­¦ç ”ç©¶ä»·å€¼æœ€å¤§çš„ï¼‰çš„æ ·æœ¬æ•°æ®äº†



#### 3 [transforms.Resize()](https://blog.csdn.net/qq_35008185/article/details/118224044?ops_request_misc=&request_id=&biz_id=102&utm_term=transforms.resize&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-118224044.nonecase&spm=1018.2226.3001.4187)

è°ƒæ•´**PILImageå¯¹è±¡**çš„å°ºå¯¸ï¼Œæˆ–ç»“åˆCompose([...])ä½¿ç”¨

> æç¤ºï¼šä¸èƒ½æ˜¯ç”¨**io.imreadæˆ–è€…cv2.imread**è¯»å–çš„å›¾ç‰‡ï¼Œè¿™ä¸¤ç§æ–¹æ³•å¾—åˆ°çš„æ˜¯**ndarray**ã€‚

```py
#åŒæ—¶æŒ‡å®šé•¿å®½
transforms.Resize([h, w])
#å°†å›¾ç‰‡ç¼©æ”¾è‡³xï¼Œé•¿å®½æ¯”ä¿æŒä¸å˜
transforms.Resize(x)
```



#### 4 [transforms.RandomCrop()](https://blog.csdn.net/u011995719/article/details/85107009?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169460376016800197090384%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169460376016800197090384&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-85107009-null-null.142^v93^insert_down28v1&utm_term=transforms.randomcrop%28%29&spm=1018.2226.3001.4187)

```py
class torchvision.transforms.RandomCrop(size, padding=None, pad_if_needed=False, fill=0, padding_mode=â€˜constantâ€™)
'''
åŠŸèƒ½ï¼šä¾æ®ç»™å®šçš„sizeéšæœºè£å‰ª
å‚æ•°ï¼š
size- (sequence or int)ï¼Œè‹¥ä¸ºsequence,åˆ™ä¸º(h,w)ï¼Œè‹¥ä¸ºintï¼Œåˆ™(size,size)

padding-(sequence or int, optional)ï¼Œæ­¤å‚æ•°æ˜¯è®¾ç½®å¡«å……å¤šå°‘ä¸ªpixelã€‚
å½“ä¸ºintæ—¶ï¼Œå›¾åƒä¸Šä¸‹å·¦å³å‡å¡«å……intä¸ªï¼Œä¾‹å¦‚padding=4ï¼Œåˆ™ä¸Šä¸‹å·¦å³å‡å¡«å……4ä¸ªpixelï¼Œè‹¥ä¸º3232ï¼Œåˆ™ä¼šå˜æˆ4040ã€‚
å½“ä¸ºsequenceæ—¶ï¼Œè‹¥æœ‰2ä¸ªæ•°ï¼Œåˆ™ç¬¬ä¸€ä¸ªæ•°è¡¨ç¤ºå·¦å³æ‰©å……å¤šå°‘ï¼Œç¬¬äºŒä¸ªæ•°è¡¨ç¤ºä¸Šä¸‹çš„ã€‚å½“æœ‰4ä¸ªæ•°æ—¶ï¼Œåˆ™ä¸ºå·¦ï¼Œä¸Šï¼Œå³ï¼Œä¸‹ã€‚

fill- (int or tuple) å¡«å……çš„å€¼æ˜¯ä»€ä¹ˆï¼ˆä»…å½“å¡«å……æ¨¡å¼ä¸ºconstantæ—¶æœ‰ç”¨ï¼‰ã€‚intæ—¶ï¼Œå„é€šé“å‡å¡«å……è¯¥å€¼ï¼Œå½“é•¿åº¦ä¸º3çš„tupleæ—¶ï¼Œè¡¨ç¤ºRGBé€šé“éœ€è¦å¡«å……çš„å€¼ã€‚

padding_mode- å¡«å……æ¨¡å¼ï¼Œè¿™é‡Œæä¾›äº†4ç§å¡«å……æ¨¡å¼ï¼Œ1.constantï¼Œå¸¸é‡ã€‚2.edge æŒ‰ç…§å›¾ç‰‡è¾¹ç¼˜çš„åƒç´ å€¼æ¥å¡«å……ã€‚				  3.reflectï¼Œæš‚ä¸äº†è§£ã€‚ 4. symmetricï¼Œæš‚ä¸äº†è§£ã€‚
'''
```

â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”

#### 5 transforms.Compose()

ä¸€èˆ¬ç”¨Compose**æŠŠå¤šä¸ªæ­¥éª¤æ•´åˆåˆ°ä¸€èµ·**ï¼š

```py
transforms.Compose([
 
    transforms.CenterCrop(10),
    transforms.ToTensor(),
 
])

#ä¹Ÿå¯ä»¥æå‰å®šä¹‰å†ç›´æ¥æ”¾è¿›å»
trans_toTensor = transforms.ToTensor()
trans_crop = transforms.CenterCrop(10)
transforms.Compose([trans_crop, trans_toTensor])
```





### 4.6.2 torchvision.datasets

#### 4.6.2.1 æ•°æ®é›†

##### COCOï¼šç›®æ ‡æ£€æµ‹ï¼Œè¯­ä¹‰åˆ†å‰²

##### MNISTï¼šæ‰‹å†™æ–‡å­—

##### CIFARï¼šç‰©ä½“è¯†åˆ«

```py
CIFAR10çš„10ä¸ªclassesï¼šairplane,automobile,bird,cat,deer,dog,frog,horse,ship,truck
```

```py
torchvision.datasets.CIFAR10(root: str, train: bool = True, transform: Optional[Callable] = None, target_transform: Optional[Callable] = None, download: bool = False)
root:ç›®å½•
transformï¼šæ˜¯å¦éœ€è¦transformså¤„ç†å›¾ç‰‡
downloadè‹¥ä¸ºtrueï¼Œåˆ™ä¼šä»ç½‘ä¸Šè‡ªåŠ¨ä¸‹è½½æ•°æ®é›†ï¼Œå¦åˆ™è¦è‡ªå·±ä¸‹è½½ï¼Œä¸€èˆ¬è®¾ç½®ä¸ºtrue
```

```py
import torchvision
from torch.utils.tensorboard import SummaryWriter

dataset_transform = torchvision.transforms.Compose([
    torchvision.transforms.ToTensor()
])

#datasetsè‹¥å‘ç°æ•°æ®é›†å·²ç»ä¸‹è½½å¹¶æ ¡éªŒé€šè¿‡ï¼Œåˆ™ä¸ä¼šé‡æ–°ä¸‹è½½
train_set = torchvision.datasets.CIFAR10(root="./dataset", train=True, transform=dataset_transform, download=True)
test_set = torchvision.datasets.CIFAR10(root="./dataset", train=False, transform=dataset_transform, download=True)


print(test_set[0])#(<PIL.Image.Image image mode=RGB size=32x32 at 0x2176E5FD0C8>, 3)

print(test_set.classes) #airplane,automobile,bird,cat,deer,dog,frog,horse,ship,truck

img, target = test_set[0]
print(img)#<PIL.Image.Image image mode=RGB size=32x32 at 0x2541358AA88>
print(target)#3
print(test_set.classes[target])#cat

#ç”»å›¾
writer = SummaryWriter('summary_event')
for i in range(10):
    set_img, target = test_set[i]
    writer.add_image('cifar10', set_img, i)
```



#### 4.6.2.2 [torchvision.datasets.ImageFolder](https://blog.csdn.net/weixin_43135178/article/details/115139178?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169698699016800197077224%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169698699016800197077224&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-115139178-null-null.142^v95^insert_down28v1&utm_term=datasets.ImageFolder&spm=1018.2226.3001.4187)

mageFolderæ˜¯ä¸€ä¸ªé€šç”¨çš„æ•°æ®åŠ è½½å™¨ï¼Œå®ƒè¦æ±‚æˆ‘ä»¬ä»¥ä¸‹é¢è¿™ç§æ ¼å¼æ¥ç»„ç»‡æ•°æ®é›†çš„è®­ç»ƒã€éªŒè¯æˆ–è€…æµ‹è¯•å›¾ç‰‡ã€‚

```py
root/dog/xxx.png
root/dog/xxy.png
root/dog/xxz.png
 
root/cat/123.png
root/cat/nsdf3.png
root/cat/asd932_.png
```

rootä¸€èˆ¬éƒ½æ˜¯å¦‚ä¸‹è¿™ç§å½¢å¼ï¼š./data/train å’Œ ./data/valid

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/20200408203816378.png)

ImageFolderå‚æ•°

```py
dataset=torchvision.datasets.ImageFolder(
                       root, transform=None, 
                       target_transform=None, 
                       loader=<function default_loader>, 
                       is_valid_file=None)
---------------------------------------------------------
#æ¡ˆä¾‹
from torchvision.datasets import ImageFolder
from torchvision import transforms
 
#åŠ ä¸Štransforms
normalize=transforms.Normalize(mean=[.5,.5,.5],std=[.5,.5,.5])
transform=transforms.Compose([
    transforms.RandomCrop(180),
    transforms.RandomHorizontalFlip(),
    transforms.ToTensor(), #å°†å›¾ç‰‡è½¬æ¢ä¸ºTensor,å½’ä¸€åŒ–è‡³[0,1]
    normalize
])
 
dataset=ImageFolder('./data/train',transform=transform)

print(dataset[0])
'''
è¾“å‡ºï¼š
(tensor([[[-0.5137, -0.4667, -0.4902,  ..., -0.0980, -0.0980, -0.0902],
         [-0.5922, -0.5529, -0.5059,  ..., -0.0902, -0.0980, -0.0667],
         [-0.5373, -0.5294, -0.4824,  ..., -0.0588, -0.0824, -0.0196],
         ...,
         [-0.3098, -0.3882, -0.3725,  ..., -0.4353, -0.4510, -0.4196],
         ...
```





### 4.6.3 torch.nn

#### nn.Module

æä¾›äº†ä¸€äº›æ¯”è¾ƒå¸¸è§çš„ç¥ç»ç½‘ç»œï¼ŒåŒ…æ‹¬é¢„è®­ç»ƒçš„

è‡ªå®šä¹‰ç¥ç»ç½‘ç»œï¼Œç»§æ‰¿nn.Moduleæ—¶ï¼Œéœ€è¦é‡å†™initå’Œforwardå‡½æ•°

***è‡ªå®šä¹‰ä¸€ä¸ªç±»ï¼Œç»§æ‰¿è‡ªModuleç±»ï¼Œå¹¶ä¸”ä¸€å®šè¦å®ç°ä¸¤ä¸ªåŸºæœ¬çš„å‡½æ•°ï¼Œç¬¬ä¸€æ˜¯æ„é€ å‡½æ•°initï¼Œç¬¬äºŒä¸ªæ˜¯å±‚çš„é€»è¾‘è¿ç®—å‡½æ•°ï¼Œå³æ‰€è°“çš„å‰å‘è®¡ç®—å‡½æ•°forwardå‡½æ•°ã€‚***

```py
#è‡ªå®šä¹‰ä¸€ä¸ªç±»ï¼Œç»§æ‰¿è‡ªModuleç±»ï¼Œå¹¶ä¸”ä¸€å®šè¦å®ç°ä¸¤ä¸ªåŸºæœ¬çš„å‡½æ•°ï¼Œç¬¬ä¸€æ˜¯æ„é€ å‡½æ•°__init__ï¼Œç¬¬äºŒä¸ªæ˜¯å±‚çš„é€»è¾‘è¿ç®—å‡½æ•°ï¼Œå³æ‰€è°“çš„å‰å‘è®¡ç®—å‡½æ•°forwardå‡½æ•°ã€‚
import torch
from torch import nn

class Tudui(nn.Module):
    def __init__(self):
        super().__init__()
    
    def forward(self, input):
        out = inout + 1
        return output
```



#### nn.functional.conv2d

```py
#è¾“å…¥å‚æ•°ï¼Œä¸»è¦è¿˜æ˜¯inputï¼Œ kernel, stride
def conv2d(input: Tensor, weight: Tensor, bias: Optional[Tensor]=None, 
           stride: Union[_int, _size]=1, padding: Union[_int, _size]=0, 
           dilation: Union[_int, _size]=1, groups: _int=1) -> Tensor: ...ï¼Œ
```

```py
import torch

input = torch.tensor([
    [1, 2, 0, 3, 1],
    [0, 1, 2, 3, 1],
    [1, 2, 1, 0, 0],
    [5, 2, 3, 1, 1],
    [2, 1, 0, 1, 1]
])

kernel = torch.tensor([
    [1, 2, 1],
    [0, 1, 0],
    [2, 1, 0]
])

input = torch.reshape(input, (1, 1, 5, 5))
kernel = torch.reshape(kernel, (1, 1, 3, 3))

torch.nn.functional.conv2d(input, kernel, stride=1)
```

![image-20230914202328633](./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20230914202328633.png)





#### [nn.Conv2d](https://blog.csdn.net/qq_34243930/article/details/107231539?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169474775616800211533990%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169474775616800211533990&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-107231539-null-null.142^v94^insert_down28v1&utm_term=nn.CONV2d&spm=1018.2226.3001.4187&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g%2Fc3BtPTEwMDEuMjEwMS4zMDAxLjQ0OTgmcT1ubi5DT05WMmQmdD0mdT0%3D)

```py
#å‚æ•°è¯¦è§£
torch.nn.Conv2d(in_channels, out_channels, kernel_size, stride=1, padding=0, dilation=1, groups=1, bias=True)
```

outputçš„H,Wè®¡ç®—å…¬å¼

![image-20230915111908894](./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20230915111908894.png)

```py
import torchvision
from torch import nn
from torch.nn import Conv2d
from torch.utils.data import DataLoader

dataset = torchvision.datasets.CIFAR10("dataset", train=False,
                                       transform=torchvision.transforms.ToTensor(), download=True)

dataloader = DataLoader(dataset, batch_size=64)

print(dataset.__len__()) #10000

class Tudui(nn.Module):
    def __init__(self):
        super(Tudui,self).__init__()
        self.conv1 = Conv2d(in_channels=3, out_channels=6, kernel_size=3, stride=1, padding=0)

    #åœ¨å‰å‘ä¼ æ’­forwardå‡½æ•°é‡Œé¢å®ç°å‰å‘è¿ç®—ã€‚
    def forward(self, x):
        x = self.conv1(x)
        return x

tudui = Tudui()

for data in dataloader:
    imgs, targets = data
    output = tudui(imgs)
    print(imgs.shape) #torch.Size([64, 3, 32, 32])
    print(output.shape) #torch.Size([64, 6, 30, 30])--->è¿™é‡Œè¾“å‡ºé€šé“å˜æˆäº†6ï¼Œæ ¹æ®ä¸Šå›¾å…¬å¼ï¼Œtensorå°ºå¯¸ä¹Ÿè¢«å‹ç¼©
    
    #è‹¥è¦è¿›è¡Œtensorboardï¼Œåˆ™éœ€è¿›è¡Œreshapeï¼Œå› ä¸ºå›¾ç‰‡çš„æ˜¾ç¤ºæ˜¯3é€šé“
    torch.reshape(output, (-1,3,30,30))
```



#### nn.MaxPool2d

ä½œç”¨:
*å¯¹é‚»åŸŸå†…ç‰¹å¾ç‚¹å–æœ€å¤§*
å‡å°**å·ç§¯å±‚å‚æ•°è¯¯å·®**é€ æˆä¼°è®¡**å‡å€¼çš„åç§»**çš„è¯¯å·®ï¼Œæ›´å¤šçš„ä¿ç•™çº¹ç†ä¿¡æ¯ã€‚

```py
#å‚æ•° ä¸€èˆ¬åªå¡«size
MaxPool2d(kernel_size, stride=None, padding=0, dilation=1, return_indices=False, ceil_mode=False)

#stride é»˜è®¤å€¼æ˜¯ kernel_size
#dilation (int or tuple, optional)ã€å¯é€‰ã€‘ï¼šä¸€ä¸ªæ§åˆ¶çª—å£ä¸­å…ƒç´ æ­¥å¹…çš„å‚æ•°
#ceil_mode (bool)ã€å¯é€‰ã€‘ï¼šå¦‚æœç­‰äºTrueï¼Œè®¡ç®—è¾“å‡ºä¿¡å·å¤§å°çš„æ—¶å€™ï¼Œå¦‚æœè¶…å‡ºèŒƒå›´ä¹Ÿä¼šè®¡ç®—ï¼Œä¼šä½¿ç”¨å‘ä¸Šå–æ•´ï¼Œä»£æ›¿é»˜è®¤çš„å‘ä¸‹å–æ•´çš„æ“ä½œ
```



#### nn.ReLU/nn.Sigmoid

```py
torch.nn.ReLU(inplace=False)
```



#### [nn.Linear](https://blog.csdn.net/sazass/article/details/123568203?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169508710916800185813549%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169508710916800185813549&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-123568203-null-null.142^v94^insert_down28v1&utm_term=torch%20linear&spm=1018.2226.3001.4187)

Linearè¿ç®—çš„æœ¬è´¨å°±æ˜¯å¤šç»´ï¼ˆçŸ©é˜µï¼‰çš„ä¹˜æ³•åŠ åç½®

```py
torch.nn.Linear(in_features, # è¾“å…¥çš„ç¥ç»å…ƒä¸ªæ•°
           out_features, # è¾“å‡ºç¥ç»å…ƒä¸ªæ•°
           bias=True # æ˜¯å¦åŒ…å«åç½®
           )
'''
in_featureï¼š intå‹, åœ¨forwardä¸­è¾“å…¥Tensoræœ€åä¸€ç»´(ç¬¬ä¸‰ä½)çš„é€šé“æ•°

out_featureï¼š intå‹, åœ¨forwardä¸­è¾“å‡ºTensoræœ€åä¸€ç»´çš„é€šé“æ•°

bias: boolå‹ï¼Œ Linearçº¿æ€§å˜æ¢ä¸­æ˜¯å¦æ·»åŠ biasåç½®
'''
```

```py
#ç¤ºä¾‹
X = torch.Tensor([
    [0.1,0.2,0.3,0.3,0.3],
    [0.4,0.5,0.6,0.6,0.6],
    [0.7,0.8,0.9,0.9,0.9],
])
>>>X
tensor([[0.1000, 0.2000, 0.3000, 0.3000, 0.3000],
        [0.4000, 0.5000, 0.6000, 0.6000, 0.6000],
        [0.7000, 0.8000, 0.9000, 0.9000, 0.9000]])
#å®šä¹‰æ¨¡å‹-------------------------------------------
model = nn.Linear(in_features=5, out_features=10, bias=True)

model(X).size()#torch.Size([3, 10])
```



#### nn.Sequential

ä¸€ä¸ªåºåˆ—å®¹å™¨ï¼Œç”¨äºæ­å»ºç¥ç»ç½‘ç»œçš„æ¨¡å—è¢«æŒ‰ç…§è¢«ä¼ å…¥æ„é€ å™¨çš„é¡ºåºæ·»åŠ åˆ°nn.Sequential()å®¹å™¨ä¸­ã€‚

åˆ©ç”¨nn.Sequential()æ­å»ºå¥½æ¨¡å‹æ¶æ„ï¼Œæ¨¡å‹å‰å‘ä¼ æ’­æ—¶è°ƒç”¨forward()æ–¹æ³•ï¼Œæ¨¡å‹æ¥æ”¶çš„è¾“å…¥é¦–å…ˆè¢«ä¼ å…¥nn.Sequential()åŒ…å«çš„ç¬¬ä¸€ä¸ªç½‘ç»œæ¨¡å—ä¸­ã€‚ç„¶åï¼Œç¬¬ä¸€ä¸ªç½‘ç»œæ¨¡å—çš„è¾“å‡ºä¼ å…¥ç¬¬äºŒä¸ªç½‘ç»œæ¨¡å—ä½œä¸ºè¾“å…¥ï¼ŒæŒ‰ç…§é¡ºåºä¾æ¬¡è®¡ç®—å¹¶ä¼ æ’­ï¼Œç›´åˆ°nn.Sequential()é‡Œçš„æœ€åä¸€ä¸ªæ¨¡å—è¾“å‡ºç»“æœã€‚

***è¿™é‡Œä»¥å¦‚ä¸‹CIFAR10çš„ä¸€ä¸ªåˆ†ç±»æ¨¡å‹ä¸ºä¾‹ï¼Œå°†æ¨¡å‹è¿›è¡Œæ­å»ºï¼š***

***å¯ä»¥çœ‹å‡ºæœ€åç”Ÿæˆäº†ä¸€ä¸ªé•¿åº¦ä¸º10çš„tensorï¼Œæ­£å¥½å¯¹åº”è¯¥æ•°æ®é›†çš„10ä¸ªclasses***

![image-20230918111430252](./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20230918111430252.png)

```py
from torch import nn
from torch.nn import Sequential, Conv2d, MaxPool2d, Flatten, Linear


class Tudui(nn.Module):
    def __init__(self):
        super(Tudui, self).__init__()
        self.model = Sequential(
            Conv2d(3, 32, 5, padding=2),
            MaxPool2d(2),
            Conv2d(32, 32, 5, padding=2),
            MaxPool2d(2),
            Conv2d(32, 64, 5, padding=2),
            MaxPool2d(2),
            Flatten(),
            Linear(1024, 64),
            Linear(64, 10)
        )

    def forward(self, x):
        s = self.model(x)
        return x
    
tudui = Tudui()
input = torch.ones(64, 3, 32, 32)
output = tudui(input)
print(output.shape)

#å¯ä»¥é€šè¿‡tensorboardè¿›è¡Œç½‘ç»œæ¨¡å‹å¯è§†åŒ–
writer = SummaryWriter('./logs_model')
writer.add_graph(tudui, input)
writer.close()
```



#### nn.L1Loss()

L1Loss è®¡ç®—æ–¹æ³•æ¯”è¾ƒç®€å•ï¼ŒåŸç†å°±æ˜¯å–é¢„æµ‹å€¼å’ŒçœŸå®å€¼çš„ç»å¯¹è¯¯å·®çš„å¹³å‡æ•°ã€‚è®¡ç®—å…¬å¼å¦‚ä¸‹

![img](https://img-blog.csdnimg.cn/20191202215436113.png)

```py
#æŸå¤±å‡½æ•°nn.L1Loss()   ä½œç”¨å…¶å®å°±æ˜¯è®¡ç®—ç½‘ç»œè¾“å‡ºä¸æ ‡ç­¾ä¹‹å·®çš„ç»å¯¹å€¼ï¼Œè¿”å›çš„æ•°æ®ç±»å‹å¯ä»¥æ˜¯å¼ é‡ï¼Œä¹Ÿå¯ä»¥æ˜¯æ ‡é‡ã€‚
#å‚æ•°å¯ä»¥è®¾ç½®å–ä¸å–å¹³å‡å€¼
nn.L1Loss(size_average=True, reduce=False,reduction='mean')
```

```py
# output ä¸ºç½‘ç»œçš„è¾“å‡º
# target ä¸ºç›®æ ‡è¾“å‡ºå³å¯¹åº”è¾“å…¥çœŸå®çš„æ ‡ç­¾
output = torch.ones(2, 3, requires_grad=True)*2.5
target = torch.ones(1, 3)

LOSSresult = nn.L1Loss()
result = LOSSresult(output, target)
 
print('æ±‚å¹³å‡:{}'.format(result))
```



#### **nn.MSELoss**

nn.MSELossï¼šè®¡ç®—å…¬å¼æ˜¯é¢„æµ‹å€¼å’ŒçœŸå®å€¼ä¹‹é—´çš„å¹³æ–¹å’Œçš„å¹³å‡æ•°ã€‚

![img](https://img-blog.csdnimg.cn/20191202215934649.png)

```py
torch.nn.MSELoss(size_average=None, reduce=None, reduction='mean')
```

```py

outputs = torch.tensor([1, 2, 3], dtype=torch.float32)
targets = torch.tensor([1, 2, 5], dtype=torch.float32)

outputs = torch.reshape(outputs, (1,1,1,3))
targets = torch.reshape(targets, (1,1,1,3))

loss_mse = MSELoss()
result_mse = loss_mse(inputs, targets)

print(result_mse) #Tensor(1.333)  --->  (0+0+(3-5)^2)/3=4/3=1.333
```



#### nn.CrossEntropyLoss

nn.CrossEntropyLossæ˜¯[pytorch](https://so.csdn.net/so/search?q=pytorch&spm=1001.2101.3001.7020)ä¸‹çš„**äº¤å‰ç†µæŸå¤±å‡½æ•°**ï¼Œç”¨äºåˆ†ç±»ä»»åŠ¡ä½¿ç”¨

> æŸå¤±å‡½æ•°çš„ä¸¤å¤§ä½œç”¨ï¼š
>
> 1. è®¡ç®—å®é™…è¾“å‡ºå’Œç›®æ ‡ä¹‹é—´çš„å·®è·
> 2. ä¸ºæˆ‘ä»¬æ›´æ–°è¾“å‡ºæä¾›ä¸€å®šçš„ä¾æ®ï¼ˆé€šè¿‡åå‘ä¼ æ’­ï¼‰

è®¡ç®—å…¬å¼ï¼šxå°±æ˜¯ç½‘ç»œçš„outputsï¼Œå¯ä»¥çœ‹å‡ºï¼Œè¦æ£€æµ‹çš„å¯¹åº”å€¼æ¦‚ç‡è¶Šå¤§ï¼Œ-x[class]å°±å‡çš„è¶Šå¤šï¼Œè®¡ç®—å‡ºæ¥çš„æŸå¤±å°±è¶Šå°

![image-20230918170952717](./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20230918170952717.png)



```py
#åŠŸèƒ½ï¼šåˆ›å»ºä¸€ä¸ªäº¤å‰ç†µæŸå¤±å‡½æ•°ï¼š
#ä¸€èˆ¬é»˜è®¤ä¸å¡«å‚æ•°
torch.nn.CrossEntropyLoss(weight=None, ignore_index=-100, reduction='mean', label_smoothing=0.0)
```

```py

loss = nn.CrossEntropyLoss()

tudui = Tudui()

for data in dataLoader:
    imgs, targets = data
    outputs = tudui(imgs)
    #è®¡ç®—æ¯ä¸ªbatch_sizeè¾“å‡ºå’Œæ ‡ç­¾çš„æŸå¤±
    result_loss = loss(outputs, tagets)
    print(result_loss)
```







#### [nn.Softmax()](https://blog.csdn.net/nefetaria/article/details/114411953?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169502603716800185890599%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169502603716800185890599&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~baidu_landing_v2~default-7-114411953-null-null.142^v94^insert_down28v1&utm_term=nn.Softmax%28%29&spm=1018.2226.3001.4187)

```py
tf.nn.softmax(
    logits, # è¾“å…¥ï¼šå…¨è¿æ¥å±‚ï¼ˆå¾€å¾€æ˜¯æ¨¡å‹çš„æœ€åä¸€å±‚ï¼‰çš„å€¼ï¼Œä¸€èˆ¬ä»£ç ä¸­å«åšlogits
    axis = None,
    name = None
    dim = None
)
```

ä½œç”¨ï¼šsoftmaxå‡½æ•°çš„ä½œç”¨å°±æ˜¯å½’ä¸€åŒ–ã€‚
è¾“å…¥ï¼šå…¨è¿æ¥å±‚ï¼ˆå¾€å¾€æ˜¯æ¨¡å‹çš„æœ€åä¸€å±‚ï¼‰çš„å€¼ï¼Œä¸€èˆ¬ä»£ç ä¸­å«åšlogits
è¾“å‡ºï¼šå½’ä¸€åŒ–çš„å€¼ï¼Œå«ä¹‰æ˜¯å±äºè¯¥ä½ç½®çš„æ¦‚ç‡ï¼Œä¸€èˆ¬ä»£ç å«åšprobs,ä¾‹å¦‚è¾“å‡º[0.4, 0.1, 0.2, 0.3],é‚£ä¹ˆè¿™ä¸ªæ ·æœ¬æœ€å¯èƒ½å±äºç¬¬0ä¸ªä½ç½®ï¼Œä¹Ÿå°±æ˜¯ç¬¬0ç±»ã€‚è¿™æ˜¯ç”±äºlogitsçš„ç»´åº¦å¤§å°å°±è®¾å®šçš„ä»»åŠ¡çš„ç±»åˆ«ï¼Œæ‰€ä»¥ç¬¬0ä¸ªä½ç½®å°±ä»£è¡¨ç¬¬0ç±»ã€‚softmaxå‡½æ•°çš„è¾“å‡ºä¸æ”¹å˜ç»´åº¦çš„å¤§å°ã€‚(è¯¥æ ·æœ¬å±äºå„ä¸ªç±»çš„æ¦‚ç‡)
ç”¨é€”ï¼šå¦‚æœåšå•åˆ†ç±»çš„é—®é¢˜ï¼Œé‚£ä¹ˆè¾“å‡ºçš„å€¼å°±å–top1(æœ€å¤§, argmax)ï¼› å¦‚æœåšå¤šåˆ†ç±»é—®é¢˜ï¼Œé‚£ä¹ˆè¾“å‡ºçš„å€¼å°±å–topNã€‚



#### nn.BatchNorm2d( )

```py
torch.nn.BatchNorm2d(num_features, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True, device=None, dtype=None)
#num_featuresï¼šè¾“å…¥å›¾åƒçš„é€šé“æ•°é‡-Cã€‚
#track_running_statsï¼šBatchNorm2dä¸­å­˜å‚¨çš„çš„å‡å€¼å’Œæ–¹å·®æ˜¯å¦éœ€è¦æ›´æ–°ï¼Œè‹¥ä¸ºTrueï¼Œè¡¨ç¤ºéœ€è¦æ›´æ–°ï¼›åä¹‹ä¸éœ€è¦æ›´æ–°ã€‚é»˜è®¤å°±å¥½
```

åŠŸèƒ½ï¼šå¯¹è¾“å…¥çš„å››ç»´æ•°ç»„è¿›è¡Œæ‰¹é‡æ ‡å‡†åŒ–å¤„ç†

å¯¹äº**æ‰€æœ‰çš„batch**ä¸­æ ·æœ¬çš„**åŒä¸€ä¸ªchannel**çš„æ•°æ®å…ƒç´ è¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ï¼Œå³å¦‚æœæœ‰Cä¸ªé€šé“ï¼Œæ— è®ºbatchä¸­æœ‰å¤šå°‘ä¸ªæ ·æœ¬ï¼Œéƒ½ä¼šåœ¨é€šé“ç»´åº¦ä¸Šè¿›è¡Œæ ‡å‡†åŒ–å¤„ç†ï¼Œä¸€å…±è¿›è¡ŒCæ¬¡ã€‚







### 4.6.4 [result_loss.backward()](https://blog.csdn.net/sinat_28731575/article/details/90342082?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169503593016800185840467%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169503593016800185840467&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-90342082-null-null.142^v94^insert_down28v1&utm_term=pytorch%20backword&spm=1018.2226.3001.4187)

å°†æŸå¤±losså‘è¾“å…¥æµ‹è¿›è¡Œåå‘ä¼ æ’­ï¼Œå¾—åˆ°æ¯ä¸ªtensorå†…éƒ¨è¦æ›´æ–°å‚æ•°(optimizer.step())å¯¹åº”çš„ä¸€ä¸ªæ¢¯åº¦å‚æ•°

```py
result_loss = loss(outputs, targets)
#ä½¿ç”¨åå‘ä¼ æ’­åŒæ—¶è®¡ç®—æ¢¯åº¦
result_loss.backward() #è¿™è¡Œè¿è¡Œå®Œåå°±ä¼šæ›´æ–°æ¨¡å‹å†…çš„grad
```



<img src="https://img-blog.csdnimg.cn/20210405102817343.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L20wXzQ2NTEwMjQ1,size_16,color_FFFFFF,t_70" alt="img" style="zoom:67%;" />



### 4.6.5 [torch.norm()](https://blog.csdn.net/qq_36556893/article/details/90698186?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169508938916800225511162%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169508938916800225511162&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-90698186-null-null.142^v94^insert_down28v1&utm_term=torch%20norm&spm=1018.2226.3001.4187)

`torch.norm()` æ˜¯ PyTorch ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºè®¡ç®—è¾“å…¥å¼ é‡æ²¿æŒ‡å®šç»´åº¦çš„[èŒƒæ•°](https://so.csdn.net/so/search?q=èŒƒæ•°&spm=1001.2101.3001.7020)ã€‚å…·ä½“è€Œè¨€ï¼Œå½“ç»™å®šä¸€ä¸ªè¾“å…¥å¼ é‡ `x` å’Œä¸€ä¸ªæ•´æ•° `p` æ—¶ï¼Œ`torch.norm(x, p)` å°†è¿”å›è¾“å…¥å¼ é‡ `x` æ²¿ç€æœ€åä¸€ä¸ªç»´åº¦ï¼ˆé»˜è®¤ä¸ºæ‰€æœ‰ç»´åº¦ï¼‰ä¸Šæ‰€æœ‰å…ƒç´ çš„ `p` èŒƒæ•°ã€‚

[ä»€ä¹ˆæ˜¯èŒƒæ•°ï¼Ÿ](https://blog.csdn.net/zhaohongfei_358/article/details/122818616?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169503825316800188522280%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169503825316800188522280&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-122818616-null-null.142^v94^insert_down28v1&utm_term=%E8%8C%83%E6%95%B0&spm=1018.2226.3001.4187)

```py
#å‚æ•°
def norm(input, p=2, dim=None, keepdim=False, out=None, dtype=None):
    
'''
inputï¼šè¾“å…¥tensorç±»å‹çš„æ•°æ®

pï¼šæŒ‡å®šçš„èŒƒæ•°ï¼Œé»˜è®¤ä¸ºp=â€˜froâ€™ï¼Œè®¡ç®—çŸ©é˜µçš„Frobenius norm (Frobenius èŒƒæ•°)ï¼Œå°±æ˜¯çŸ©é˜µå„é¡¹å…ƒç´ çš„ç»å¯¹å€¼å¹³æ–¹çš„æ€»å’Œã€‚
p='nucâ€™æ—¶ï¼Œ  æ˜¯æ±‚æ ¸èŒƒæ•°ï¼Œæ ¸èŒƒæ•°æ˜¯çŸ©é˜µå¥‡å¼‚å€¼çš„å’Œã€‚ï¼ˆä¸å¸¸ç”¨ï¼‰
pä¸ºintçš„å½¢å¼ï¼Œæ˜¯æ±‚p-èŒƒæ•°ã€‚ï¼ˆå¸¸ç”¨ï¼‰

dimï¼šæŒ‡å®šåœ¨å“ªä¸ªç»´åº¦è¿›è¡Œï¼Œå¦‚æœä¸æŒ‡å®šï¼Œåˆ™æ˜¯åœ¨æ‰€æœ‰ç»´åº¦è¿›è¡Œè®¡ç®—

keepdimï¼šTrue or Falseï¼Œå¦‚æœTrueï¼Œåˆ™ä¿ç•™dimæŒ‡å®šçš„ç»´åº¦ï¼ŒFalseåˆ™ä¸ä¿ç•™

outï¼šè¾“å‡ºçš„ tensor

dtypeï¼šæŒ‡å®šè¾“å‡ºçš„tensorçš„æ•°æ®ç±»å‹
'''
```

```py
tensor([[ 1.,  2.,  3.,  4.],
        [ 2.,  4.,  6.,  8.],
        [ 3.,  6.,  9., 12.]])

#æ¥ç€æˆ‘ä»¬åˆ†åˆ«å¯¹å…¶è¡Œå’Œåˆ—åˆ†åˆ«æ±‚2èŒƒæ•°
inputs1 = torch.norm(inputs, p=2, dim=1, keepdim=True) #è¡Œ
print(inputs1)
inputs2 = torch.norm(inputs, p=2, dim=0, keepdim=True) #åˆ—
print(inputs2)
#ç»“æœï¼š
tensor([[ 5.4772],
        [10.9545],
        [16.4317]])
tensor([[ 3.7417,  7.4833, 11.2250, 14.9666]])
```



### 4.6.6 ä¼˜åŒ–å™¨

#### 1 [torch.optim.SGD](https://blog.csdn.net/echo_gou/article/details/119536350?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169517442516800197019450%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169517442516800197019450&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-119536350-null-null.142^v94^insert_down28v1&utm_term=optim.SGD&spm=1018.2226.3001.4187)

å…¶ä¸­çš„SGDå°±æ˜¯optimä¸­çš„ä¸€ä¸ªç®—æ³•ï¼ˆä¼˜åŒ–å™¨ï¼‰ï¼š**éšæœºæ¢¯åº¦ä¸‹é™ç®—æ³•**

ä¸ºäº†ä½¿ç”¨torch.optimï¼Œä½ éœ€è¦æ„å»ºä¸€ä¸ªoptimizerå¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡èƒ½å¤Ÿä¿æŒå½“å‰å‚æ•°çŠ¶æ€å¹¶åŸºäºè®¡ç®—å¾—åˆ°çš„æ¢¯åº¦è¿›è¡Œå‚æ•°æ›´æ–°ã€‚

```py
#å‚æ•°
optimizer = torch.optim.SGD(params, lr=<required parameter>, momentum=0, dampening=0, weight_decay=0, nesterov=False, *, maximize=False, foreach=None, differentiable=False)
'''
lr (float) â€“ å­¦ä¹ ç‡
momentum (float, å¯é€‰) â€“ åŠ¨é‡å› å­ï¼ˆé»˜è®¤ï¼š0ï¼‰
weight_decay (float, å¯é€‰) â€“ æƒé‡è¡°å‡ï¼ˆL2æƒ©ç½šï¼‰ï¼ˆé»˜è®¤ï¼š0ï¼‰
dampening (float, å¯é€‰) â€“ åŠ¨é‡çš„æŠ‘åˆ¶å› å­ï¼ˆé»˜è®¤ï¼š0ï¼‰
nesterov (bool, å¯é€‰) â€“ ä½¿ç”¨NesterovåŠ¨é‡ï¼ˆé»˜è®¤ï¼šFalseï¼‰
'''

#ä¸€èˆ¬ä½¿ç”¨
tudui = Tudui()
#å­¦ä¹ ç‡å¤ªå°è·‘å¾—å¤ªæ…¢ï¼Œå¤ªå¤§æ—¶æ¨¡å‹è®­ç»ƒä¸ç¨³å®š
optimizer = torch.optim.SGD(tudui.parameters, lr=0.01)
```

##### [**ä¼˜åŒ–å™¨çš„å‡ ä¸ªæ–¹æ³•**](https://blog.csdn.net/weixin_43863869/article/details/128120719?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169517544416800192260220%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169517544416800192260220&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-128120719-null-null.142^v94^insert_down28v1&utm_term=optimizer.zero_grad%28%29%E7%9A%84%E4%BD%9C%E7%94%A8&spm=1018.2226.3001.4187)

```py
optimizer.step()
'''
ä½œç”¨ï¼šåˆ©ç”¨ä¼˜åŒ–å™¨å¯¹å‚æ•°xè¿›è¡Œè°ƒä¼˜ï¼Œä»¥éšæœºæ¢¯åº¦ä¸‹é™SGDä¸ºä¾‹ï¼Œæ›´æ–°çš„å…¬å¼ä¸ºï¼šx=xâˆ’lrâˆ—(xâˆ—grad)
ï¼Œlr è¡¨ç¤ºå­¦ä¹ ç‡ lr ï¼Œå‡å·è¡¨ç¤ºæ²¿ç€æ¢¯åº¦çš„åæ–¹å‘è¿›è¡Œæ›´æ–°ï¼›
'''

optimizer.zero_grad()
'''
ä½œç”¨ï¼šæ¸…0ä¼˜åŒ–å™¨å…³äºæ‰€æœ‰å‚æ•°xçš„ç´¯è®¡æ¢¯åº¦å€¼ xâˆ—grad
ï¼Œä¸€èˆ¬åœ¨loss.backward()å‰ä½¿ç”¨
'''
```

ä¸€æ¬¡å®Œæ•´çš„é’ˆå¯¹CIFAR10çš„æ¨¡å‹è®­ç»ƒï¼Œå¯¹æ¯æ¬¡è®­ç»ƒè¿­ä»£è¿›è¡ŒæŸå¤±çš„è®¡ç®—

```py
import torch
import torchvision
from torch import nn
from torch.nn import Sequential, Conv2d, MaxPool2d, Flatten, Linear
#å¼•å…¥æ•°æ®é›†å’Œå¤„ç†å™¨
dataset = torchvision.datasets.CIFAR10('./dataset', train=False,
                                         transform=torchvision.transforms.ToTensor(), download=True)
dataLoader = torch.utils.data.DataLoader(dataset=dataset, batch_size=1)

#åˆ›å»ºæ¨¡å‹
class Tudui(nn.Module):
    def __init__(self):
        super(Tudui, self).__init__()
        self.model = Sequential(
            Conv2d(3, 32, 5, padding=2),
            MaxPool2d(2),
            Conv2d(32, 32, 5, padding=2),
            MaxPool2d(2),
            Conv2d(32, 64, 5, padding=2),
            MaxPool2d(2),
            Flatten(),
            Linear(1024, 64),
            Linear(64, 10)
        )

    def forward(self, x):
        x = self.model(x)
        return x


tudui = Tudui()
loss = nn.CrossEntropyLoss()
optimizer = torch.optim.SGD(tudui.parameters(), lr=0.01)

#å¼€å§‹è®­ç»ƒ
for epoch in range(3):
    sum_loss = 0.0
    for data in dataLoader:
        imgs, targets = data
        outputs = tudui.forward(imgs)
        #è®¡ç®—æŸå¤±
        result_loss = loss(outputs, targets)
        #optimizer.zero_grad() ä½œç”¨ï¼šæ¸…é™¤ä¹‹å‰ç§¯ç´¯çš„æ¢¯åº¦
        # ä¸€èˆ¬åœ¨loss.backward()å‰ä½¿ç”¨ï¼Œå³æ¸…é™¤ (xâˆ—grad)pre
        optimizer.zero_grad()
        #åå‘ä¼ æ’­ï¼Œæ›´æ–°æ¢¯åº¦
        result_loss.backward()
        #å¯¹æ¯ä¸ªå‚æ•°è¿›è¡Œè°ƒä¼˜
        optimizer.step()
        sum_loss += result_loss
    print(sum_loss)
```

```py
#è¾“å‡º
C:\Users\1\miniconda3\envs\pytorchlearn\python.exe D:\pycharmProjects\pytorchlearn\nn_optim.py 
Files already downloaded and verified
tensor(18721.0879, grad_fn=<AddBackward0>)
tensor(16111.2578, grad_fn=<AddBackward0>)
tensor(15386.7744, grad_fn=<AddBackward0>)
```

### 4.6.7 torchvision.models

#### 1  VGG(å¸¸ç”¨ï¼šVGG16/19)

##### åˆ›å»ºæ¨¡å‹

```py
torchvision.models.vgg16(*, weights: Optional[VGG16_Weights] = None, progress: bool = True, **kwargs: Any) â†’ VGG
'''
weights:è¦ä½¿ç”¨çš„è®­ç»ƒæƒé‡,è‹¥ä¸ä½¿ç”¨é¢„è®­ç»ƒï¼Œåˆ™å¡«ä¸€ä¸ªweight=Noneï¼Œè‹¥è¦ä½¿ç”¨é¢„è®­ç»ƒæ¨¡å‹ï¼Œåˆ™ç”¨é»˜è®¤(weight='VGG16_Weights.DEFAULT')
progressï¼šå¦‚æœä¸ºTrueï¼Œåˆ™æ˜¾ç¤ºä¸‹è½½åˆ°æ ‡å‡†ç¨‹åºçš„è¿›åº¦æ¡ã€‚é»˜è®¤ä¸ºTrue
ä¸€èˆ¬å¡«è¿™ä¸¤ä¸ªå°±è¡Œ
'''
```

```py
vgg16_true = torchvision.models.vgg16( weights='DEFAULT')

vgg16_false = torchvision.models.vgg16(weights=None)

print(vgg16_true)
#---------------------------------------------------------
VGG(
  #æå–ç‰¹å¾
  (features): Sequential(
    (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): ReLU(inplace=True)
    (2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (3): ReLU(inplace=True)
    (4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (5): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (6): ReLU(inplace=True)
    (7): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (8): ReLU(inplace=True)
    (9): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (10): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (11): ReLU(inplace=True)
    (12): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (13): ReLU(inplace=True)
    (14): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (15): ReLU(inplace=True)
    (16): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (17): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (18): ReLU(inplace=True)
    (19): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (20): ReLU(inplace=True)
    (21): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (22): ReLU(inplace=True)
    (23): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (24): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (25): ReLU(inplace=True)
    (26): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (27): ReLU(inplace=True)
    (28): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (29): ReLU(inplace=True)
    (30): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  #map_location=torch.device('cpu')ï¼Œæ„æ€æ˜¯æ˜ å°„åˆ°cpuä¸Šï¼Œåœ¨cpuä¸ŠåŠ è½½æ¨¡å‹ï¼Œæ— è®ºä½ è¿™ä¸ªæ¨¡å‹ä»å“ªé‡Œè®­ç»ƒä¿å­˜çš„ï¼Œä¸»è¦æ˜¯æ”¹å˜åˆ†è¾¨ç‡
  (avgpool): AdaptiveAvgPool2d(output_size=(7, 7))
  #åˆ†ç±»å™¨ï¼Œé¢„æµ‹ç”¨
  (classifier): Sequential(
    (0): Linear(in_features=25088, out_features=4096, bias=True)
    (1): ReLU(inplace=True)
    (2): Dropout(p=0.5, inplace=False)
    (3): Linear(in_features=4096, out_features=4096, bias=True)
    (4): ReLU(inplace=True)
    (5): Dropout(p=0.5, inplace=False)
    (6): Linear(in_features=4096, out_features=1000, bias=True)
  )
)
```

##### **ä¿®æ”¹æ¨¡å‹**

```py
#å¯¹ç°æœ‰æ¨¡å‹æ·»åŠ å±‚
vgg16_true.classifier.add_module('add_Linear', nn.Linear(1000, 10))
print(vgg16_true)
---------------------------------------------
  (classifier): Sequential(
    (0): Linear(in_features=25088, out_features=4096, bias=True)
    (1): ReLU(inplace=True)
    (2): Dropout(p=0.5, inplace=False)
    (3): Linear(in_features=4096, out_features=4096, bias=True)
    (4): ReLU(inplace=True)
    (5): Dropout(p=0.5, inplace=False)
    (6): Linear(in_features=4096, out_features=1000, bias=True)
    (add_Linear): Linear(in_features=1000, out_features=10, bias=True) #-->æ·»åŠ äº†ä¸€å±‚
  )

#å¯¹ç°æœ‰æ¨¡å‹ä¿®æ”¹å±‚
vgg16_false.classifier[6] = nn.Linear(4096, 10)
print(vgg16_false)
----------------------------------------------
  (classifier): Sequential(
    (0): Linear(in_features=25088, out_features=4096, bias=True)
    (1): ReLU(inplace=True)
    (2): Dropout(p=0.5, inplace=False)
    (3): Linear(in_features=4096, out_features=4096, bias=True)
    (4): ReLU(inplace=True)
    (5): Dropout(p=0.5, inplace=False)
    (6): Linear(in_features=4096, out_features=10, bias=True) #-->è¢«ä¿®æ”¹äº†
  )
```

##### ä¿å­˜æ¨¡å‹

```py
vgg16 = torchvision.models.vgg16(weights=None)

#ä¿å­˜æ–¹å¼ä¸€
torch.save(vgg16, 'vgg16_method1.pth')

#ä¿å­˜æ–¹å¼äºŒï¼šä»¥å­—å…¸çš„å½¢å¼ä¿å­˜,åªä¿å­˜è®­ç»ƒå¥½çš„æƒé‡
torch.save(vgg16.state_dict(), 'vgg16_method2.pth')
```

##### [åŠ è½½æ¨¡å‹](https://blog.csdn.net/pearl8899/article/details/109566084?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169529774616800192295944%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169529774616800192295944&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-109566084-null-null.142^v94^insert_down28v1&utm_term=torch.load&spm=1018.2226.3001.4187)

```py
#æ–¹å¼ä¸€
model1 = torch.load('vgg16_method1.pth')
# print(model1)

#æ–¹å¼äºŒ:ä»¥å­—å…¸æ–¹å¼åŠ è½½
map_location=torch.device('cpu') #æ„æ€æ˜¯æ˜ å°„åˆ°cpuä¸Šï¼Œåœ¨cpuä¸ŠåŠ è½½æ¨¡å‹ï¼Œæ— è®ºä½ è¿™ä¸ªæ¨¡å‹ä»å“ªé‡Œè®­ç»ƒä¿å­˜çš„
model2 = torch.load('vgg16_method2.pth',map_location=map_location)
print(model2)

#æ–¹å¼äºŒï¼šåŠ è½½æ¨¡å‹
vgg16 = torchvision.models.vgg16(weights=None)
vgg16.load_state_dict(torch.load('vgg16_method2.pth'))
#è¿™æ ·å°±èƒ½æŠŠdictå­˜å‚¨çš„æ¨¡å‹è½¬å›åŸæ¥çš„æ–¹å¼è¾“å‡º
print(vgg16)
```

#### 2 [model.train()/eval()](https://blog.csdn.net/weixin_44211968/article/details/123774649?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169552175216800215086602%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169552175216800215086602&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-123774649-null-null.142^v94^insert_down28v1&utm_term=model.eval%28%29&spm=1018.2226.3001.4187)

pytorchæä¾›çš„ä¸¤ç§æ–¹å¼æ¥åˆ‡æ¢è®­ç»ƒå’Œè¯„ä¼°(æ¨æ–­)çš„æ¨¡å¼ï¼Œåˆ†åˆ«æ˜¯ï¼š`model.train()` å’Œ `model.eval()`ã€‚

ä¸€èˆ¬ç”¨æ³•æ˜¯ï¼šåœ¨è®­ç»ƒå¼€å§‹ä¹‹å‰å†™ä¸Š model.trian() ï¼Œåœ¨æµ‹è¯•æ—¶å†™ä¸Š model.eval() ã€‚

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20230924102237721.png" alt="image-20230924102237721" style="zoom:80%;" />

å¯ä»¥ä»å®˜æ–¹æ–‡æ¡£ä¸­çœ‹åˆ°ï¼Œtrain()/eval()éƒ½åªå¯¹å¦‚Dropoutï¼ŒBatchç­‰ç‰¹å®šå±‚èµ·ä½œç”¨ï¼Œè‹¥æ¨¡å‹ç”¨ä¸åˆ°è¿™äº›å±‚åˆ™å¯ä»¥ä¸ç”¨

### 4.6.8 å®Œæ•´æ¨¡å‹è®­ç»ƒå¥—è·¯

#### 1 é›†æ˜¾è®­ç»ƒ

```py
import torch.utils.data
import torchvision.datasets
from torch import nn
from torch.utils.tensorboard import SummaryWriter

#å‡†å¤‡æ•°æ®é›†
train_dataset = torchvision.datasets.CIFAR10('./dataset', train=True,
                                         transform=torchvision.transforms.ToTensor(), download=True)
test_dataset = torchvision.datasets.CIFAR10('./dataset', train=False,
                                         transform=torchvision.transforms.ToTensor(), download=True)

#è¾“å‡ºé•¿åº¦
train_dataset_len = len(train_dataset)
test_dataset_len = len(test_dataset)
print('len(train_dataset):{}'.format(train_dataset_len))
print('len(test_dataset):{}'.format(test_dataset_len))

#dataloader
train_dataloader = torch.utils.data.DataLoader(train_dataset, 64)
test_dataloader = torch.utils.data.DataLoader(test_dataset, 64)

#tensorboard
writer = SummaryWriter('./logs_train_loss')

#æ­å»ºCIFAR10çš„ç½‘ç»œ
class Tudui(nn.Module):
    def __init__(self):
        super().__init__()
        self.model = nn.Sequential(
            nn.Conv2d(3, 32, 5, 1, 2),
            nn.MaxPool2d(2),
            nn.Conv2d(32, 32, 5, 1, 2),
            nn.MaxPool2d(2),
            nn.Conv2d(32, 64, 5, 1, 2),
            nn.MaxPool2d(2),
            nn.Flatten(),
            nn.Linear(64*4*4, 64),
            nn.Linear(64, 10)
        )
    def forward(self, x):
        x = self.model(x)
        return x

tudui = Tudui()

#æŸå¤±å‡½æ•°
loss_func = nn.CrossEntropyLoss()

#ä¼˜åŒ–å™¨
learning_rate = 0.01
optimizer = torch.optim.SGD(tudui.parameters(), lr=learning_rate)

#è®¾ç½®è®­ç»ƒå‚æ•°
epoch = 10
#å®æ—¶è®­ç»ƒæ¬¡æ•°
train_step = 0
#å®æ—¶æµ‹è¯•æ¬¡æ•°
test_step = 0



for i in range(epoch):
    print("---------epoch {} start---------".format(i+1))
    #è®­ç»ƒ
    tudui.train()
    for data in train_dataloader:
        imgs, targets = data
        outputs = tudui(imgs)
        #è®¡ç®—æŸå¤±
        loss = loss_func(outputs, targets)

        #ä¼˜åŒ–æ¨¡å‹
        optimizer.zero_grad() #æ¢¯åº¦æ¸…é›¶
        loss.backward() #åå‘ä¼ æ’­å¾—å‡ºæ¢¯åº¦
        optimizer.step() #æ›´æ–°æ¢¯åº¦

        #ç´¯è®¡æ¬¡æ•°,è®­ç»ƒä¸éœ€è¦ç´¯è®¡loss
        train_step += 1

        if train_step % 100 == 0:
            print("train times:{}, loss:{}".format(train_step, loss.item()))
            # tensorboard
            writer.add_scalar('train_loss', loss.item(), train_step)

    #æµ‹è¯•
    tudui.eval()
    test_total_loss = 0
    total_accuracy = 0
    #ä½¿ç”¨with torch.no_grad,è¡¨æ˜å½“å‰è®¡ç®—ä¸éœ€è¦åå‘ä¼ æ’­ï¼Œä½¿ç”¨ä¹‹åï¼Œå¼ºåˆ¶åè¾¹çš„å†…å®¹ä¸è¿›è¡Œè®¡ç®—å›¾çš„æ„å»ºï¼›è¿˜èƒ½èŠ‚çº¦æ€§èƒ½
    with torch.no_grad():
        for data in test_dataloader:
            imgs, targets = data
            outputs = tudui(imgs)
            loss = loss_func(outputs, targets)

            test_total_loss += loss.item()
            accuracy = (outputs.argmax(1)==targets).sum()
            total_accuracy += accuracy

    #æ¯æ¬¡epochåç»Ÿè®¡
    print("epoch {} test_loss:{}".format((i+1), test_total_loss))
    print("epoch {} test_acc:{}".format((i+1), total_accuracy/test_dataset_len))
    # tensorboard
    test_step += 1
    writer.add_scalar('test_total_loss', test_total_loss, test_step)
    writer.add_scalar('test_acc', total_accuracy/test_dataset_len, test_step)

    #æ¯æ¬¡epochåä¿å­˜æ¨¡å‹,è¿™é‡Œé‡‡ç”¨æ–¹å¼ä¸€
    torch.save(tudui, 'tudui_epoch{}'.format(i+1))
```

#### 2 GPUè®­ç»ƒ

ä½¿ç”¨gpuè®­ç»ƒæ—¶ï¼Œåœ¨ä»£ç ä¸­æ‰¾åˆ°ä»¥ä¸‹3å¤„ï¼ŒåŠ å…¥.cuda()å³å¯

1. ***ç½‘ç»œæ¨¡å‹***
2. ***è®­ç»ƒå’Œæµ‹è¯•çš„æ•°æ®ï¼ˆè¾“å…¥ï¼Œæ ‡æ³¨ï¼‰***
3. ***æŸå¤±å‡½æ•°***

```py
#æ–¹å¼ä¸€
if torch.cuda.is_avaliable():
    model = model.cuda()
----------------------------------------
if torch.cuda.is_avaliable():
    imgs = imgs.cuda()
    targets = targets.cuda()
----------------------------------------
if torch.cuda.is_avaliable():
    loss_fn = loss.cuda()
```

```py
#æ–¹å¼äºŒ
#å®šä¹‰è®­ç»ƒçš„è®¾å¤‡
device = torch.device("cpu")
device = torch.device("cuda")
device = torch.device("cuda:0")#å’Œä¸Šé¢ä¸€æ¡åŒç†
#æ¨èå†™æ³•
device = torch.device("cuda" if torch.cuda.is_avaliable() else 'cpu')

#éšååœ¨ä»£ç æ¨¡å‹ï¼Œæ•°æ®ï¼ŒæŸå¤±å‡½æ•°3å¤„ä¸­æ·»åŠ è®¾å¤‡
model = model.to(device)
loss_fn = loss_fn.to(device)
imgs = imgs.to(device)
targets = targets.to(device)
```

### 4.6.9 å®Œæ•´æ¨¡å‹éªŒè¯å¥—è·¯

```py
#è¿™é‡Œéšä¾¿è®­ç»ƒå®Œåä»ç½‘ä¸Šæ‰¾ä¸€å¼ ç‹—çš„å›¾ç‰‡è¿›è¡ŒéªŒè¯
import torch
from PIL import Image
from torch import nn
from torchvision import transforms

img_path = './test_data/dog.png'

image = Image.open(img_path)
image = image.convert('RGB')

trans_tool = transforms.Compose([
    transforms.ToTensor(),
    transforms.Resize((32, 32))
])

print(image.size)
image = trans_tool(image)
image = torch.reshape(image, (1, 3, 32, 32))
print(image.shape) #torch.Size([3, 32, 32])


class Tudui(nn.Module):
    def __init__(self):
        super().__init__()
        self.model = nn.Sequential(
            nn.Conv2d(3, 32, 5, 1, 2),
            nn.MaxPool2d(2),
            nn.Conv2d(32, 32, 5, 1, 2),
            nn.MaxPool2d(2),
            nn.Conv2d(32, 64, 5, 1, 2),
            nn.MaxPool2d(2),
            nn.Flatten(),
            nn.Linear(64*4*4, 64),
            nn.Linear(64, 10)
        )
    def forward(self, x):
        x = self.model(x)
        return x
#å…·ä½“æ¥è¯´ï¼Œmap_locationå‚æ•°æ˜¯ç”¨äºé‡å®šå‘ï¼Œæ¯”å¦‚æ­¤å‰æ¨¡å‹çš„å‚æ•°æ˜¯åœ¨cpuä¸­çš„ï¼Œæˆ‘ä»¬å¸Œæœ›å°†å…¶åŠ è½½åˆ°cuda:0ä¸­ã€‚
model = torch.load('./tudui_epoch10', map_location='cuda')

model.eval()
with torch.no_grad():
    output = model(image)

print(output.argmax(1))
```





## 4.7 opencv

```py
#windowsä½¿ç”¨pipå®‰è£…
pip install opencv-python -i https://pypi.tuna.tsinghua.edu.cn/simple
```

## 4.8 [tqdm](https://blog.csdn.net/All_In_gzx_cc/article/details/126664224?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169698826916800215024475%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169698826916800215024475&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-126664224-null-null.142^v95^insert_down28v1&utm_term=tqdm%E5%BA%93&spm=1018.2226.3001.4187)

```py
import time
from tqdm import *

for i in tqdm(range(1000)):
	time.sleep(.01) #è¿›åº¦æ¡æ¯0.01så‰è¿›ä¸€æ¬¡ï¼Œæ€»æ—¶é—´ä¸º1000*0.01=10s 

# è¿è¡Œç»“æœå¦‚ä¸‹
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1000/1000 [00:10<00:00, 93.21it/s]  
------------------------------------------------------------
from tqdm import trange
#trange(i)æ˜¯ tqdm(range(i))çš„ç®€å•å†™æ³•
for i in trange(1000):
	time.sleep(.01)

# è¿è¡Œç»“æœå¦‚ä¸‹
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1000/1000 [00:10<00:00, 93.21it/s]  
```





# 5 é—®é¢˜

## 5.1 pythoné—®é¢˜

### 5.1.1 [pythonè·¯å¾„ä¸ºå•¥è¦ç”¨â€œ//â€?](https://www.cnblogs.com/zwt20120701/p/11267457.html)

### 5.1.2 [r'å­—ç¬¦ä¸²'æ˜¯ä»€ä¹ˆæ„æ€]([Pythonä¸­çš„rå­—ç¬¦ä¸²å‰ç¼€åŠå…¶ç”¨æ³•è¯¦è§£_python å­—ç¬¦ä¸²å‰å¸¦r_å¿µå¹¿éš¶çš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/lsoxvxe/article/details/132001495?ops_request_misc=%7B%22request%5Fid%22%3A%22169405062216777224494582%22%2C%22scm%22%3A%2220140713.130102334..%22%7D&request_id=169405062216777224494582&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-2-132001495-null-null.142^v93^insert_down28v1&utm_term=python rå­—ç¬¦ä¸²&spm=1018.2226.3001.4187))

### 5.1.3 Pythonä¸ºä»€ä¹ˆè¦ç”¨Numpyï¼Ÿ

Pythonä¸­æä¾›äº†listå®¹å™¨ï¼Œå¯ä»¥å½“ä½œæ•°ç»„ä½¿ç”¨ã€‚ä½†åˆ—è¡¨ä¸­çš„å…ƒç´ å¯ä»¥æ˜¯ä»»ä½•å¯¹è±¡ï¼Œå› æ­¤åˆ—è¡¨ä¸­ä¿å­˜çš„æ˜¯å¯¹è±¡çš„æŒ‡é’ˆï¼Œè¿™æ ·ä¸€æ¥ï¼Œä¸ºäº†ä¿å­˜ä¸€ä¸ªç®€å•çš„åˆ—è¡¨[1,2,3]ã€‚å°±éœ€è¦ä¸‰ä¸ªæŒ‡é’ˆå’Œä¸‰ä¸ªæ•´æ•°å¯¹è±¡ã€‚å¯¹äºæ•°å€¼è¿ç®—æ¥è¯´ï¼Œè¿™ç§ç»“æ„æ˜¾ç„¶ä¸å¤Ÿé«˜æ•ˆã€‚
Pythonè™½ç„¶ä¹Ÿæä¾›äº†arrayæ¨¡å—ï¼Œä½†å…¶åªæ”¯æŒä¸€ç»´æ•°ç»„ï¼Œä¸æ”¯æŒå¤šç»´æ•°ç»„ï¼Œä¹Ÿæ²¡æœ‰å„ç§è¿ç®—å‡½æ•°ã€‚å› è€Œä¸é€‚åˆæ•°å€¼è¿ç®—ã€‚
Numpyå†…ç½®ä¸°å¯Œçš„æ–¹æ³•ï¼Œèƒ½æ›´åŠ è½»æ¾é«˜æ•ˆåœ°è¿›è¡Œç§‘å­¦è®¡ç®—ã€‚

### 5.1.4 ä½¿ç”¨å„ç±»æ–¹æ³•çš„æ³¨æ„

å…³äºä½¿ç”¨å„ç±»å‡½æ•°æ—¶çš„æ³¨æ„ç‚¹ï¼šè‹¥å£°æ˜å¤„æœ‰é»˜è®¤å€¼ï¼Œä¸€èˆ¬ä¸åŠ¨ï¼Œå¡«å‚æ•°æ—¶åªéœ€å¡«æ²¡æœ‰é»˜è®¤å€¼çš„å€¼å°±å¯ä»¥äº†

ä¸çŸ¥é“æ–°å‡½æ•°çš„è¿”å›å€¼æ—¶ï¼Œä»¥ä¸‹å‡ ç§æ€è·¯ï¼š

> print
>
> print(type(...))
>
> debug
>
> ä¸Šç½‘æŸ¥

### 5.1.5 å®šä¹‰ç±»æ—¶å¯ä»¥ç›´æ¥ä½¿ç”¨self.xxä»£æ›¿å˜é‡çš„å£°æ˜





# 6 aiåŸºç¡€

## 6.1 æ·±åº¦å­¦ä¹ 

### 6.1.1 [å›¾åƒåŸºç¡€](https://blog.csdn.net/weixin_44211968/article/details/123876506?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169459167716800222837715%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169459167716800222837715&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-1-123876506-null-null.142^v93^insert_down28v1&utm_term=%E5%9B%BE%E5%83%8F%E9%80%9A%E9%81%93&spm=1018.2226.3001.4187)

å›¾ç‰‡å¯ä»¥çœ‹ä½œæ˜¯ **ä¸‰å±‚** **äºŒç»´æ•°ç»„** çš„**å åŠ **ï¼Œæ¯ä¸€å±‚äºŒç»´æ•°ç»„éƒ½æ˜¯ä¸€ä¸ªé€šé“ã€‚å•é€šé“çš„å›¾åƒæ˜¯ç°è‰²çš„ï¼Œæ¯ä¸ªåƒç´ pixelåªæœ‰ä¸€ä¸ªvalueï¼Œæ•°å­—è¶Šé«˜ï¼Œé¢œè‰²è¶Šç™½ï¼Œä¹Ÿå°±è¶Šäº®ã€‚å³ä¸‰é€šé“ï¼Œæ¯ä¸ªé€šé“ç”±äºŒç»´æ•°ç»„å­˜å‚¨ã€‚

ä¸‰å±‚çš„ value åˆ†åˆ«ä»£è¡¨ç€è¿™ä¸ªç‚¹åœ¨ä¸‰ä¸ªé€šé“çš„æ•°å€¼ï¼Œè®¡ç®—æœºæ ¹æ®è¿™äº›æ•°å€¼æ¥ç¡®å®šè¿™ä¸€ä¸ªåƒç´ ç‚¹çš„é¢œè‰²ã€‚è¿™å°±å¸¸è§çš„ä¸‰å±‚ RGB è‰²å½©ç©ºé—´çš„å·¥ä½œæ–¹å¼ã€‚

RGB æ ¼å¼é‡Œ(0,0,0)ä»£è¡¨ç€é»‘è‰²ï¼Œ(255,255,255)ä»£è¡¨ç€ç™½è‰²ã€‚

æ³¨æ„: OpenCV(å¼€æºè®¡ç®—æœºè§†è§‰åº“ï¼ŒåŒ…å«äº†è®¸å¤šå¯ç”¨çš„è§†è§‰ç®—æ³•ï¼Œå›¾åƒå¤„ç†å¿…å¤‡ç¥å™¨)å›¾åƒé€šé“çš„**é»˜è®¤æ’åºæ˜¯ BGR**ã€‚

#### 6.1.1.1 [HWCå’ŒCHW](https://blog.csdn.net/hh1357102/article/details/130622666?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169459146616800227429193%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169459146616800227429193&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-130622666-null-null.142^v93^insert_down28v1&utm_term=RGB%E5%9B%BE%E5%83%8F%E7%9A%84%E5%AD%98%E5%82%A8&spm=1018.2226.3001.4187)

##### 1 HWC

**HWCå¯ä»¥çœ‹ä½œæ˜¯ä¸€å¹…å›¾åƒçš„shape**ï¼ŒHè¡¨ç¤ºå›¾åƒçš„é«˜åº¦(height)ï¼ŒWè¡¨ç¤ºå›¾åƒçš„å®½åº¦(Width)ï¼Œè€ŒCè¡¨ç¤ºä¸€å¹…å›¾åƒçš„é€šé“æ•°(Channel)ã€‚HWCæ ¼å¼æ˜¯æŒ‡æŒ‰ç…§é«˜åº¦ã€å®½åº¦å’Œé€šé“æ•°çš„é¡ºåºæ’åˆ—å›¾åƒå°ºå¯¸çš„æ ¼å¼ã€‚ä¾‹å¦‚ï¼Œä¸€å¼ å½¢çŠ¶ä¸º256Ã—256Ã—3çš„RGBå›¾åƒï¼Œåœ¨HWCæ ¼å¼ä¸­è¡¨ç¤ºä¸º[256, 256, 3]ã€‚åœ¨ä¸€äº›å›¾åƒå¤„ç†åº“æˆ–è€…åº•å±‚æ¡†æ¶ä¸­ï¼Œä¾‹å¦‚**OpenCVå’ŒTensorFlowï¼Œé€šå¸¸ä½¿ç”¨HWCæ ¼å¼è¡¨ç¤ºå›¾åƒå°ºå¯¸ã€‚**

åœ¨OpenCVä¸­ï¼Œè¯»å–çš„å›¾ç‰‡é»˜è®¤æ˜¯HWCæ ¼å¼

**ä¸¾ä¸ªå°æ —å­**

hwc=[5,5,3] çš„å«ä¹‰æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ

å¤§å®¶å¯ä»¥æ€è€ƒä¸€ä¸‹ï¼Œä»¥å›¾åƒä¸ºä¾‹ï¼Œé‚£ä¹ˆé«˜å®½éƒ½æ˜¯5ï¼Œ3å°±æ˜¯å…¶ä¸­çš„é€šé“æ•°ã€‚å› æ­¤æˆ‘ä»¬ä¹Ÿå¯ä»¥ç†è§£ä¸º***\*3ä¸ª 5\*5 å¤§å°çš„ç‰¹å¾å›¾\****ã€‚ 



##### 2 CHW

CHWæ ¼å¼æ˜¯æŒ‡æŒ‰ç…§é€šé“æ•°ã€é«˜åº¦å’Œå®½åº¦çš„é¡ºåºæ’åˆ—å›¾åƒå°ºå¯¸çš„æ ¼å¼ã€‚ä¾‹å¦‚ï¼Œä¸€å¼ å½¢çŠ¶ä¸º3Ã—256Ã—256çš„RGBå›¾åƒï¼Œåœ¨CHWæ ¼å¼ä¸­è¡¨ç¤ºä¸º[3, 256, 256]ã€‚**åœ¨è®¡ç®—æœºè§†è§‰å’Œæ·±åº¦å­¦ä¹ ä¸­å¦‚pytorchï¼Œé€šå¸¸ä½¿ç”¨CHWæ ¼å¼è¡¨ç¤ºå›¾åƒå°ºå¯¸ã€‚**

ä¾‹å¦‚ï¼Œä¸€ä¸ª2x2çš„RGBå›¾åƒåœ¨CHWæ ¼å¼ä¸‹å¯èƒ½ä¼šä»¥ä»¥ä¸‹æ–¹å¼è½¬ä¸ºä¸€ç»´æ•°ç»„ï¼š

```py
åŸå§‹çš„CHWæ ¼å¼è¡¨ç¤ºä¸ºï¼š
[
    [[R11, R12], [R21, R22]],
    [[G11, G12], [G21, G22]],
    [[B11, B12], [B21, B22]]
]
è¡Œä¼˜å…ˆæ‰å¹³åŒ–åçš„ä¸€ç»´è¡¨ç¤ºä¸ºï¼š
[R11, R12, R21, R22, G11, G12, G21, G22, B11, B12, B21, B22]
```

**ä¸ºä»€ä¹ˆpytorchä¸­transforms.ToTorchè¦æŠŠ(H,W,C)çš„çŸ©é˜µè½¬ä¸º(C,H,W)?** 

- å› ä¸ºpytorchå¾ˆå¤šå‡½æ•°éƒ½æ˜¯è®¾è®¡æˆå‡è®¾ä½ çš„è¾“å…¥æ˜¯ ï¼ˆcï¼Œhï¼Œwï¼‰çš„æ ¼å¼ï¼Œå½“ç„¶ä½ å¦‚æœä¸å«Œéº»çƒ¦çš„è¯å¯ä»¥æ¯æ¬¡è¦ç”¨è¿™äº›å‡½æ•°çš„æ—¶å€™è½¬æˆchwæ ¼å¼ï¼Œä½†æˆ‘æƒ³è¿™ä¼šæ¯”ä½ è¾“å…¥çš„æ—¶å€™å°±è½¬æˆchwè¦éº»çƒ¦å¾ˆå¤šã€‚
- è‡³äºä¸ºä»€ä¹ˆpytorché€‰æ‹©è®¾è®¡æˆchwè€Œä¸æ˜¯hwcï¼ˆæ¯•ç«Ÿä¼ ç»Ÿçš„è¯»å›¾ç‰‡çš„å‡½æ•°opencvçš„cv2.imreadæˆ–è€…sklearnçš„imreadéƒ½æ˜¯è¯»æˆhwcçš„æ ¼å¼çš„ï¼‰è¿™ç‚¹ç¡®å®æ¯”è¾ƒä»¤åˆå­¦è€…å›°æƒ‘ã€‚ä¸ªäººæ„Ÿè§‰æ˜¯å› ä¸ºpytorchåšçŸ©é˜µåŠ å‡ä¹˜é™¤ä»¥åŠå·ç§¯ç­‰è¿ç®—æ˜¯éœ€è¦è°ƒç”¨cudaå’Œcudnnçš„å‡½æ•°çš„ï¼Œè€Œè¿™äº›æ¥å£éƒ½è®¾æˆæˆchwæ ¼å¼äº†ï¼Œæ•…è€Œpytorchä¸ºäº†æ–¹ä¾¿èµ·è§ä¹Ÿè®¾è®¡æˆchwæ ¼å¼äº†ã€‚
- é‚£æ–°é—®é¢˜å°±æ¥äº†ï¼Œcudaå’Œcudnnä¸ºä»€ä¹ˆè®¾è®¡æˆchwæ ¼å¼å‘¢ï¼Ÿæˆ‘æƒ³è¿™æ˜¯ç”±äºæ¶‰åŠåˆ°å›¾ç‰‡æ“ä½œçš„éƒ½æ˜¯å’Œå·ç§¯ç›¸å…³çš„ï¼Œè€Œå†…éƒ¨åšå·ç§¯è¿ç®—çš„åŠ é€Ÿè®¾è®¡æˆchwåœ¨æ“ä½œä¸Šä¼šæ¯”hwcå¤„ç†èµ·æ¥æ›´å®¹æ˜“ï¼Œæ›´å¿«ã€‚



##### 3 Torchå°†HWCæ ¼å¼è½¬ä¸ºCHW

```py
from PIL import Image
from torchvision.transforms import ToTensor
 
img = Image.open('image_path')
#äº§ç”Ÿçš„PIL_imageæ ¼å¼æ•°æ®çš„å–å€¼èŒƒå›´æ˜¯[0,255]
#å½¢çŠ¶(shape)æ˜¯[h, w, c]
#åƒç´ é¡ºåºæ˜¯RGB
 
tensor = ToTensor()(PIL_img)
 	
# æˆ–è€…
np_data = np.asarray(PIL_img)
tensor = ToTensor()(np_data)
```



### 6.1.2 æ•°å­¦åŸºç¡€

#### 6.1.2.1 [å½’ä¸€åŒ–ï¼ˆnormalizationï¼‰](https://blog.csdn.net/yangbindxj/article/details/125294045?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169448177316800215060118%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169448177316800215060118&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-2-125294045-null-null.142^v93^insert_down28v1&utm_term=%E5%BD%92%E4%B8%80%E5%8C%96&spm=1018.2226.3001.4187&ydreferer=aHR0cHM6Ly9zby5jc2RuLm5ldC9zby9zZWFyY2g%2Fc3BtPTEwMDEuMjEwMS4zMDAxLjQ0OTgmcT0lRTUlQkQlOTIlRTQlQjglODAlRTUlOEMlOTYmdD0mdT0%3D)

**å½’ä¸€åŒ–å°±æ˜¯è¦æŠŠå›¾ç‰‡3ä¸ªé€šé“ä¸­çš„æ•°æ®æ•´ç†åˆ°[-1, 1]åŒºé—´**

ä¸ºäº†æ¶ˆé™¤æŒ‡æ ‡ä¹‹é—´çš„é‡çº²å½±å“ï¼Œéœ€è¦è¿›è¡Œ[æ•°æ®æ ‡å‡†åŒ–å¤„ç†](https://so.csdn.net/so/search?q=æ•°æ®æ ‡å‡†åŒ–å¤„ç†&spm=1001.2101.3001.7020)ï¼Œä»¥è§£å†³æ•°æ®æŒ‡æ ‡ä¹‹é—´çš„å¯æ¯”æ€§ã€‚åŸå§‹æ•°æ®ç»è¿‡æ•°æ®æ ‡å‡†åŒ–å¤„ç†åï¼Œå„æŒ‡æ ‡å¤„äºåŒä¸€æ•°é‡çº§ï¼Œé€‚åˆè¿›è¡Œç»¼åˆå¯¹æ¯”è¯„ä»·ã€‚å…¶ä¸­ï¼Œæœ€å…¸å‹çš„å°±æ˜¯æ•°æ®çš„å½’ä¸€åŒ–å¤„ç†ã€‚

**ç®€è€Œè¨€ä¹‹ï¼Œå½’ä¸€åŒ–çš„ç›®çš„å°±æ˜¯ä½¿å¾—é¢„å¤„ç†çš„æ•°æ®è¢«é™å®šåœ¨ä¸€å®šçš„èŒƒå›´å†…ï¼ˆæ¯”å¦‚[0,1]æˆ–è€…[-1,1]ï¼‰ï¼Œä»è€Œæ¶ˆé™¤å¥‡å¼‚æ ·æœ¬æ•°æ®å¯¼è‡´çš„ä¸è‰¯å½±å“ã€‚**

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/3e6e5ae01efdc6e97353275439b307de.png">

> **å¥‡å¼‚æ ·æœ¬æ•°æ®çš„å­˜åœ¨ä¼šå¼•èµ·è®­ç»ƒæ—¶é—´å¢å¤§ï¼ŒåŒæ—¶ä¹Ÿå¯èƒ½å¯¼è‡´æ— æ³•æ”¶æ•›ï¼Œå› æ­¤ï¼Œå½“å­˜åœ¨å¥‡å¼‚æ ·æœ¬æ•°æ®æ—¶ï¼Œåœ¨è¿›è¡Œè®­ç»ƒä¹‹å‰éœ€è¦å¯¹é¢„å¤„ç†æ•°æ®è¿›è¡Œå½’ä¸€åŒ–ï¼›åä¹‹ï¼Œä¸å­˜åœ¨å¥‡å¼‚æ ·æœ¬æ•°æ®æ—¶ï¼Œåˆ™å¯ä»¥ä¸è¿›è¡Œå½’ä¸€åŒ–ã€‚**

**å½’ä¸€åŒ–çš„å¯¹æ¯”**

> å¦‚æœä¸è¿›è¡Œå½’ä¸€åŒ–ï¼Œé‚£ä¹ˆç”±äºç‰¹å¾å‘é‡ä¸­ä¸åŒç‰¹å¾çš„å–å€¼ç›¸å·®è¾ƒå¤§ï¼Œä¼šå¯¼è‡´ç›®æ ‡å‡½æ•°å˜â€œæ‰â€ã€‚è¿™æ ·åœ¨è¿›è¡Œæ¢¯åº¦ä¸‹é™çš„æ—¶å€™ï¼Œæ¢¯åº¦çš„æ–¹å‘å°±ä¼šåç¦»æœ€å°å€¼çš„æ–¹å‘ï¼Œèµ°å¾ˆå¤šå¼¯è·¯ï¼Œå³è®­ç»ƒæ—¶é—´è¿‡é•¿ã€‚

**å½’ä¸€åŒ–çš„ä¾‹å­**

å½’ä¸€åŒ–å°±æ˜¯ä¸ªå¾—åˆ†è½¬æ¢æˆæ¦‚ç‡çš„è¿‡ç¨‹

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20230928090826996.png" alt="image-20230928090826996" style="zoom:67%;" />



#### 6.1.2.3 æ ‡å‡†åŒ–



#### 6.1.2.4 æ­£åˆ™åŒ–(æƒ©ç½šé¡¹)

æ­£åˆ™åŒ–æ˜¯ç”¨æ¥é˜²æ­¢æ¨¡å‹è¿‡æ‹Ÿåˆè€Œé‡‡å–çš„æ‰‹æ®µã€‚

ç¬¬ä¸€é¡¹æ˜¯æ¨¡å‹æ•°æ®æŸå¤±ï¼Œåé¢ä¸€é¡¹æ˜¯å½“å‰è¿™ä¸ªæ¨¡å‹çš„æƒé‡å‚æ•°Wæ‰€å¸¦æ¥çš„æŸå¤±ã€‚è¿™é‡Œä¸»è¦æ˜¯é€šè¿‡è°ƒèŠ‚lamdaæ¥è°ƒèŠ‚æŸå¤±

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20230927192227055.png" alt="image-20230927192227055" style="zoom: 50%;" />

å¯ä»¥çœ‹åˆ°ï¼Œlamdaè¶Šå¤§ï¼Œæƒ©ç½šåŠ›åº¦è¶Šå°ï¼Œå¯ä»¥çœ‹åˆ°æ•´ä¸ªè®­ç»ƒç»“æœå¥‡å½¢æ€ªçŠ¶ï¼Œè¿™æ˜¯ç½‘ç»œä¸­æƒé‡å‚æ•°ä¸ç¨³å®šæœ‰çš„å°æœ‰çš„å¤§å¯¼è‡´ï¼Œå› æ­¤å°†lamdaè°ƒå¤§ä¼šæ¯”è¾ƒåˆé€‚ã€‚

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20231007093410070.png" alt="image-20231007093410070" style="zoom: 50%;" />



#### 6.1.2.5 å¾—åˆ†å‡½æ•°

xç»è¿‡ç½‘ç»œWX+bå°±ä¼šå¾—åˆ°å¾—åˆ†è¾“å‡ºï¼Œè¿™é‡Œå‡è®¾xæ˜¯3072Ã—1çš„å‘é‡ï¼Œ3072æ˜¯åƒç´ ç‚¹ï¼Œè¦å°†xåˆ†ä¸º10ç±»ï¼Œåˆ™éœ€è¦ä½¿ç”¨10Ã—3072çš„çŸ©é˜µç›¸ä¹˜å¾—åˆ°10Ã—1çš„å‘é‡ï¼Œå¦‚æ­¤ä¸€çœ‹çœ‹å‘é‡å“ªä¸ªå€¼å¾—åˆ†ï¼ˆå€¼ï¼‰å¤§å°±è¯´æ˜å“ªä¸ªåˆ†ç±»çš„å¾—åˆ†é«˜ã€‚

- è¿™é‡Œå¯ä»¥å¯¹åº”ç¥ç»ç½‘ç»œçš„æœ€åä¸€å±‚æˆ–è€…æ˜¯solfmaxå±‚æ¥ç†è§£
- ***Wæƒé‡çŸ©é˜µèµ·å†³å®šæ€§ä½œç”¨ï¼Œåç½®bèµ·å¾®è°ƒä½œç”¨***

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20230927155242190.png" alt="image-20230927155242190" style="zoom: 50%;" />



#### 6.1.2.6 [èŒƒæ•°](https://blog.csdn.net/weixin_42066990/article/details/118636995?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169508767416800188597670%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169508767416800188597670&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-118636995-null-null.142^v94^insert_down28v1&utm_term=%E8%8C%83%E6%95%B0%E6%98%AF%E4%BB%80%E4%B9%88&spm=1018.2226.3001.4187)

å®ƒå¸¸å¸¸è¢«ç”¨æ¥åº¦é‡æŸä¸ªå‘é‡ç©ºé—´ï¼ˆæˆ–çŸ©é˜µï¼‰ä¸­çš„æ¯ä¸ªå‘é‡çš„é•¿åº¦æˆ–å¤§å°ã€‚



#### 6.1.2.7 [æœ€å°äºŒä¹˜æ³•](https://blog.csdn.net/MoreAction_/article/details/106443383?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169581087116800197077799%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169581087116800197077799&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-106443383-null-null.142^v94^insert_down28v1&utm_term=%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E6%B3%95&spm=1018.2226.3001.4187)

æœ€å°äºŒä¹˜æ³•å°±æ˜¯ä¸€ç§æ€æƒ³ï¼Œå®ƒå¯ä»¥æ‹Ÿåˆä»»æ„å‡½æ•°ï¼Œçº¿æ€§å›å½’åªæ˜¯å…¶ä¸­ä¸€ä¸ªæ¯”è¾ƒç®€å•è€Œä¸”ä¹Ÿå¾ˆå¸¸ç”¨çš„å‡½æ•°ï¼Œæ‰€ä»¥è®²æœ€å°äºŒä¹˜æ³•åŸºæœ¬éƒ½ä¼šä»¥å®ƒä¸ºä¾‹ã€‚

æ±‚æ³•ï¼š

å¤§æ¦‚å°±æ˜¯å…ˆæ±‚å‡ºæŸå¤±å‡½æ•°è¡¨è¾¾å¼ï¼Œç„¶åå¯¹æŸå¤±å‡½æ•°æ±‚(å)å¯¼ï¼Œæœ€åæ±‚å‡ºä½¿å¾—æŸå¤±æœ€ä½çš„å‚æ•°ã€‚



#### 6.1.2.8 [æ¢¯åº¦](https://blog.csdn.net/walilk/article/details/50978864?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169586736916800197083413%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=169586736916800197083413&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~hot_rank-9-50978864-null-null.142^v94^insert_down28v1&utm_term=%E6%A2%AF%E5%BA%A6&spm=1018.2226.3001.4187)

æ¢¯åº¦å®šä¹‰å¦‚ä¸‹ï¼š
ã€€å‡½æ•°åœ¨æŸä¸€ç‚¹çš„æ¢¯åº¦æ˜¯è¿™æ ·ä¸€ä¸ªå‘é‡ï¼Œå®ƒçš„æ–¹å‘ä¸å–å¾—æœ€å¤§æ–¹å‘å¯¼æ•°çš„æ–¹å‘ä¸€è‡´ï¼Œè€Œå®ƒçš„æ¨¡ä¸ºæ–¹å‘å¯¼æ•°çš„æœ€å¤§å€¼ã€‚
ã€€è¿™é‡Œæ³¨æ„ä¸‰ç‚¹ï¼š
ã€€1ï¼‰æ¢¯åº¦æ˜¯ä¸€ä¸ªå‘é‡ï¼Œå³æœ‰æ–¹å‘æœ‰å¤§å°ï¼›
ã€€2ï¼‰æ¢¯åº¦çš„æ–¹å‘æ˜¯æœ€å¤§æ–¹å‘å¯¼æ•°çš„æ–¹å‘ï¼›
ã€€3ï¼‰æ¢¯åº¦çš„å€¼æ˜¯æœ€å¤§æ–¹å‘å¯¼æ•°çš„å€¼ã€‚

***å¼•å‡ºæ¢¯åº¦ä¸‹é™æ³•ï¼š***

æ—¢ç„¶åœ¨å˜é‡ç©ºé—´çš„æŸä¸€ç‚¹å¤„ï¼Œå‡½æ•°æ²¿æ¢¯åº¦æ–¹å‘å…·æœ‰æœ€å¤§çš„å˜åŒ–ç‡ï¼Œé‚£ä¹ˆåœ¨ä¼˜åŒ–ç›®æ ‡å‡½æ•°çš„æ—¶å€™ï¼Œè‡ªç„¶æ˜¯æ²¿ç€**è´Ÿæ¢¯åº¦æ–¹å‘**å»å‡å°å‡½æ•°å€¼ï¼Œä»¥æ­¤è¾¾åˆ°æˆ‘ä»¬çš„ä¼˜åŒ–ç›®æ ‡ã€‚

åŒæ—¶æ¢¯åº¦å’Œåå¯¼æ•°éƒ½æ˜¯å‘é‡ï¼Œé‚£ä¹ˆå‚è€ƒå‘é‡è¿ç®—æ³•åˆ™ï¼Œæˆ‘ä»¬åœ¨æ¯ä¸ªå˜é‡è½´ä¸Šå‡å°å¯¹åº”å˜é‡å€¼å³å¯ï¼Œæ¢¯åº¦ä¸‹é™æ³•å¯ä»¥æè¿°å¦‚ä¸‹ï¼š
ã€€![æ¢¯åº¦ä¸‹é™æ³•](./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/20160325132853497.png)

***æ¢¯åº¦çš„é“¾å¼æ³•åˆ™ï¼šç»“åˆåå‘ä¼ æ’­***

è¦è®¡ç®—q=x+yï¼Œf=q*zï¼Œè¦è®¡ç®—få¯¹xåå¯¼(æ¢¯åº¦)ï¼Œåˆ™è¦ä½¿ç”¨é“¾å¼æ³•åˆ™--->fxåå¯¼=fqåå¯¼*Ã—qxåå¯¼

![image-20230928111040977](./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20230928111040977.png)



### 6.1.3 ç†è®ºåŸºç¡€

#### 6.1.3.1 ç†µ

##### 1 å®šä¹‰

é‚£ä¹ˆç†µçš„é‚£äº›æè¿°å’Œè§£é‡Š(æ··ä¹±ç¨‹åº¦ï¼Œä¸ç¡®å®šæ€§ï¼ŒæƒŠå¥‡ç¨‹åº¦ï¼Œä¸å¯é¢„æµ‹æ€§ï¼Œä¿¡æ¯é‡ç­‰)ä»£è¡¨äº†ä»€ä¹ˆå‘¢ï¼Ÿ

å¦‚æœç†µæ¯”è¾ƒå¤§(å³å¹³å‡ç¼–ç é•¿åº¦è¾ƒé•¿)ï¼Œæ„å‘³ç€è¿™ä¸€ä¿¡æ¯æœ‰è¾ƒå¤šçš„å¯èƒ½çŠ¶æ€ï¼Œç›¸åº”çš„æ¯ä¸ªçŠ¶æ€çš„å¯èƒ½æ€§æ¯”è¾ƒä½ï¼›å› æ­¤æ¯å½“æ¥äº†ä¸€ä¸ªæ–°çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬å¾ˆéš¾å¯¹å…¶ä½œå‡ºå‡†ç¡®é¢„æµ‹ï¼Œå³æœ‰ç€æ¯”è¾ƒå¤§çš„æ··ä¹±ç¨‹åº¦/ä¸ç¡®å®šæ€§/ä¸å¯é¢„æµ‹æ€§ã€‚

å¹¶ä¸”å½“ä¸€ä¸ªç½•è§çš„ä¿¡æ¯åˆ°è¾¾æ—¶ï¼Œæ¯”ä¸€ä¸ªå¸¸è§çš„ä¿¡æ¯æœ‰ç€æ›´å¤šçš„ä¿¡æ¯é‡ï¼Œå› ä¸ºå®ƒæ’é™¤äº†åˆ«çš„å¾ˆå¤šçš„å¯èƒ½æ€§ï¼Œå‘Šè¯‰äº†æˆ‘ä»¬ä¸€ä¸ªç¡®åˆ‡çš„ä¿¡æ¯ã€‚åœ¨å¤©æ°”çš„ä¾‹å­ä¸­ï¼ŒRainyå‘ç”Ÿçš„æ¦‚ç‡ä¸º12.5%ï¼Œå½“æ¥æ”¶åˆ°è¯¥ä¿¡æ¯æ—¶ï¼Œæˆ‘ä»¬å‡å°‘äº†87.5%çš„ä¸ç¡®å®šæ€§(Fine,Cloudy,Snow)ï¼›å¦‚æœæ¥æ”¶åˆ°Fine(50%)çš„æ¶ˆæ¯ï¼Œæˆ‘ä»¬åªå‡å°‘äº†50%çš„ä¸ç¡®å®šæ€§ã€‚

##### 2 [äº¤å‰ç†µï¼ˆåˆ†ç±»å¸¸è§çš„æŸå¤±å‡½æ•°ï¼‰](https://blog.csdn.net/Yue_Zengying/article/details/117111510?ops_request_misc=&request_id=&biz_id=102&utm_term=%E4%BA%A4%E5%8F%89%E7%86%B5&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-9-117111510.142^v94^insert_down28v1&spm=1018.2226.3001.4187)

å‡è®¾æœ‰ä¸¤ä¸ªæœºå™¨å­¦ä¹ æ¨¡å‹å¯¹ç¬¬ä¸€å¼ ç…§ç‰‡åˆ†åˆ«ä½œå‡ºäº†é¢„æµ‹ï¼šQ1å’ŒQ2,è€Œç¬¬ä¸€å¼ ç…§ç‰‡çš„çœŸå®æ ‡ç­¾ä¸º[1,0,0,0,0]ã€‚![img](https://img-blog.csdnimg.cn/202105211147578.png#pic_center)

ä¸¤ä¸ªæ¨¡å‹é¢„æµ‹æ•ˆæœå¦‚ä½•å‘¢ï¼Œå¯ä»¥åˆ†åˆ«è®¡ç®—ä¸‹äº¤å‰ç†µï¼š

<img src="https://img-blog.csdnimg.cn/20210521114815834.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L1l1ZV9aZW5neWluZw==,size_16,color_FFFFFF,t_70#pic_center" alt="img" style="zoom:67%;" />

äº¤å‰ç†µå¯¹æ¯”äº†æ¨¡å‹çš„é¢„æµ‹ç»“æœå’Œæ•°æ®çš„çœŸå®æ ‡ç­¾ï¼Œéšç€é¢„æµ‹è¶Šæ¥è¶Šå‡†ç¡®ï¼Œäº¤å‰ç†µçš„å€¼è¶Šæ¥è¶Šå°ï¼Œå¦‚æœé¢„æµ‹å®Œå…¨æ­£ç¡®ï¼Œäº¤å‰ç†µçš„å€¼å°±ä¸º0ã€‚å› æ­¤ï¼Œè®­ç»ƒåˆ†ç±»æ¨¡å‹æ—¶ï¼Œå¯ä»¥ä½¿ç”¨äº¤å‰ç†µä½œä¸ºæŸå¤±å‡½æ•°ã€‚

##### 3 äºŒåˆ†ç±»äº¤å‰ç†µ

åœ¨äºŒåˆ†ç±»æ¨¡å‹ä¸­ï¼Œæ ‡ç­¾åªæœ‰æ˜¯å’Œå¦ä¸¤ç§ï¼›è¿™æ—¶ï¼Œå¯ä»¥ä½¿ç”¨äºŒåˆ†ç±»äº¤å‰ç†µä½œä¸ºæŸå¤±å‡½æ•°ã€‚å‡è®¾æ•°æ®é›†ä¸­åªæœ‰çŒ«å’Œç‹—çš„ç…§ç‰‡ï¼Œåˆ™äº¤å‰ç†µå…¬å¼ä¸­åªåŒ…å«ä¸¤ç§å¯èƒ½æ€§ï¼š![img](https://img-blog.csdnimg.cn/202105211150414.jpg#pic_center)

è€ŒP(cat) = 1 - P(dog)
æ‰€ä»¥äº¤å‰ç†µå¯ä»¥è¡¨ç¤ºä¸ºï¼š
H(P,Q)=-P(cat)logQ(cat)-(1-P(cat))log(1-Q(cat))
ä½¿ç”¨å¦‚ä¸‹å®šä¹‰ï¼š

![img](https://img-blog.csdnimg.cn/20210521115229397.png#pic_center)

äºŒåˆ†ç±»çš„äº¤å‰ç†µå¯ä»¥å†™ä½œå¦‚ä¸‹å½¢å¼ï¼Œçœ‹èµ·æ¥å°±ç†Ÿæ‚‰å¤šäº†ã€‚

![img](https://img-blog.csdnimg.cn/20210521115247963.png#pic_center)



#### 6.1.3.2 [æ³›åŒ–](https://blog.csdn.net/sc2079/article/details/103090727?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169580296016800185845355%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169580296016800185845355&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-103090727-null-null.142^v94^insert_down28v1&utm_term=%E6%B3%9B%E5%8C%96&spm=1018.2226.3001.4187)

æœºå™¨å­¦ä¹ ï¼ˆæ·±åº¦å­¦ä¹ ï¼‰çš„æ ¹æœ¬é—®é¢˜æ˜¯ä¼˜åŒ–å’Œæ³›åŒ–ä¹‹é—´çš„å¯¹ç«‹ã€‚

- ä¼˜åŒ–ï¼ˆoptimizationï¼‰æ˜¯æŒ‡è°ƒèŠ‚æ¨¡å‹ä»¥åœ¨è®­ç»ƒæ•°æ®ä¸Šå¾—åˆ°æœ€ä½³æ€§èƒ½ï¼ˆå³æœºå™¨å­¦ä¹ ä¸­çš„å­¦ä¹ ï¼‰ï¼Œè€Œæ³›åŒ–ï¼ˆgeneralizationï¼‰æ˜¯æŒ‡è®­ç»ƒå¥½çš„æ¨¡å‹åœ¨å‰æ‰€æœªè§çš„æ•°æ®ä¸Šçš„æ€§èƒ½å¥½åã€‚

- æœºå™¨å­¦ä¹ çš„ç›®çš„å½“ç„¶æ˜¯å¾—åˆ°è‰¯å¥½çš„æ³›åŒ–ï¼Œä½†ä½ æ— æ³•æ§åˆ¶æ³›åŒ–ï¼Œåªèƒ½åŸºäºè®­ç»ƒæ•°æ®è°ƒèŠ‚æ¨¡å‹ã€‚



#### 6.1.3.3 [è¿‡æ‹Ÿåˆ](https://blog.csdn.net/sinat_38079265/article/details/121687241?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169579860516800180613574%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169579860516800180613574&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_click~default-2-121687241-null-null.142^v94^insert_down28v1&utm_term=%E8%BF%87%E6%8B%9F%E5%90%88&spm=1018.2226.3001.4187)

##### 1 å®šä¹‰

è¿‡æ‹Ÿåˆï¼šæ¨¡å‹åœ¨è®­ç»ƒé›†ä¸Šè¡¨ç°çš„éå¸¸å¥½ï¼Œä½†åœ¨æµ‹è¯•é›†çš„æ•°æ®ä¸‹è¡¨ç°å¾ˆå·®ã€‚

> å…·ä½“è§‚å¯Ÿlosså‡½æ•°å°±æ˜¯ï¼Œtrain lossä¸€ç›´é™ä½ï¼Œè€Œtest losså…ˆé™ä½ï¼Œè€Œåéšç€epoachçš„å¢åŠ ï¼Œè€Œä¸æ–­å¢åŠ ã€‚

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/watermark,type_d3F5LXplbmhlaQ,shadow_50,text_Q1NETiBAWWVsbG93MDUyMw==,size_20,color_FFFFFF,t_70,g_se,x_16.png" alt="img" style="zoom: 50%;" />

- æ¬ æ‹Ÿåˆï¼šæ¨¡å‹ä¸èƒ½åœ¨è®­ç»ƒé›†ä¸Šè·å¾—è¶³å¤Ÿä½çš„è¯¯å·®ï¼›
- æ‹Ÿåˆï¼šæµ‹è¯•è¯¯å·®ä¸è®­ç»ƒè¯¯å·®å·®è·è¾ƒå°ï¼›
- è¿‡æ‹Ÿåˆï¼šè®­ç»ƒè¯¯å·®å’Œæµ‹è¯•è¯¯å·®ä¹‹é—´çš„å·®è·å¤ªå¤§ï¼›å¢å¼ºæ³›åŒ–èƒ½åŠ›å°±æ˜¯é˜²æ­¢è¿‡æ‹Ÿåˆçš„æ„æ€
- ä¸æ”¶æ•›ï¼šæ¨¡å‹ä¸æ˜¯æ ¹æ®è®­ç»ƒé›†è®­ç»ƒå¾—åˆ°çš„ã€‚

##### 2 è¿‡æ‹Ÿåˆçš„åŸå› 

1.è®­ç»ƒæ•°æ®å¤ªå°‘ï¼ˆæ¯”å¦‚åªæœ‰å‡ ç™¾ç»„ï¼‰

2.æ¨¡å‹çš„å¤æ‚åº¦å¤ªé«˜ï¼ˆæ¯”å¦‚éšè—å±‚å±‚æ•°è®¾ç½®çš„è¿‡å¤šï¼Œ[ç¥ç»å…ƒ](https://so.csdn.net/so/search?q=ç¥ç»å…ƒ&spm=1001.2101.3001.7020)çš„æ•°é‡è®¾ç½®çš„è¿‡å¤§ï¼‰ï¼Œä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½ çš„æ¨¡å‹æ˜¯é«˜å°„ç‚®ï¼Œç»“æœä½ çš„æ•°æ®æ˜¯èšŠå­ï¼Œè¿™ä¸å°±å¾ˆæ‰¯æ·¡äº†å—ã€‚

3.ç‰¹å¾å¤ªå¤š

4.åªå…³å¿ƒå±€éƒ¨ç‰¹å¾



##### 3 è§£å†³æ–¹æ¡ˆ

- 1.é™ä½æ¨¡å‹çš„å¤æ‚åº¦
  è¿™ä¹Ÿæ˜¯æœ€é‡è¦çš„ä¸€æ­¥ï¼Œä¸ºäº†é™ä½æ¨¡å‹çš„å¤æ‚åº¦ï¼Œæˆ‘ä»¬å¯ä»¥å‡å°‘ç¥ç»å…ƒçš„ä¸ªæ•°ï¼Œå‡å°‘éšè—å±‚çš„å±‚æ•°ï¼ˆç½‘ç»œæ·±åº¦ï¼‰ï¼Œå°è¯•å°†å¤æ‚çš„ç½‘ç»œç»“æ„ä¸€æ­¥æ­¥æ›´æ¢ä¸ºè¾ƒç®€å•çš„ç½‘ç»œç»“æ„ã€‚æˆ–è€…å°è¯•ä½¿ç”¨ä¼ ç»Ÿçš„æœºå™¨å­¦ä¹ æ¨¡å‹ï¼ˆæ¯”å¦‚éšæœºæ£®æ—ï¼Œé«˜æ–¯è¿‡ç¨‹å›å½’ï¼Œæ¢¯åº¦æå‡å›å½’æ ‘ä¹‹ç±»çš„æ¨¡å‹ï¼‰ã€‚

- 2.è®­ç»ƒé›†å¢åŠ æ›´å¤šçš„æ•°æ®
  æ·±åº¦å­¦ä¹ é€‚åº”çš„åœºæ™¯å¾€å¾€å°±æ˜¯å¤§æ•°æ®é›†ï¼Œå¯¹äºå°æ ·æœ¬ï¼Œè¿‡æ‹Ÿåˆç°è±¡çš„äº§ç”Ÿå¾€å¾€æ˜¯ä¸å¯é¿å…çš„ã€‚é€šè¿‡å¢åŠ æ•°æ®åªèƒ½ç¼“è§£è¿‡æ‹Ÿåˆï¼Œå¹¶ä¸èƒ½é¿å…ã€‚

- 3.æ•°æ®å¢å¼º

  ä½¿ç”¨æ•°æ®å¢å¼ºå¯ä»¥ç”Ÿæˆå¤šå¹…ç›¸ä¼¼å›¾åƒã€‚è¿™å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¢åŠ æ•°æ®é›†è§„æ¨¡ä»è€Œå‡å°‘è¿‡æ‹Ÿåˆã€‚å› ä¸ºéšç€æ•°æ®é‡çš„å¢åŠ ï¼Œæ¨¡å‹æ— æ³•è¿‡æ‹Ÿåˆæ‰€æœ‰æ ·æœ¬ï¼Œå› æ­¤ä¸å¾—ä¸è¿›è¡Œæ³›åŒ–ã€‚

  è®¡ç®—æœºè§†è§‰é¢†åŸŸé€šå¸¸çš„åšæ³•æœ‰ï¼šç¿»è½¬ã€å¹³ç§»ã€æ—‹è½¬ã€ç¼©æ”¾ã€æ”¹å˜äº®åº¦ã€æ·»åŠ å™ªå£°ç­‰ç­‰

- 4.æ•°æ®å¢å¼º

- 5.å¢åŠ æƒ©ç½šå› å­ï¼ˆæ­£åˆ™åŒ–ï¼‰ï¼Œä¿ç•™æ‰€æœ‰çš„ç‰¹å¾ï¼Œä½†æ˜¯å‡å°‘å‚æ•°çš„å¤§å°ï¼ˆmagnitudeï¼‰ã€‚

#### 6.1.3.4 [æ„Ÿå—é‡](https://blog.csdn.net/qq_43665602/article/details/126754736?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169664348116800211581763%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169664348116800211581763&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-126754736-null-null.142^v94^insert_down28v1&utm_term=%E6%84%9F%E5%8F%97%E9%87%8E&spm=1018.2226.3001.4187)

ç½‘ç»œè¶Šæ·±ï¼Œå·ç§¯è¶Šå¤šï¼Œæ„Ÿå—é‡å°±è¶Šå¤§

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20231007095057222.png" alt="image-20231007095057222" style="zoom: 50%;" />

#### 6.1.3.5 [nlpè¯å‘é‡æ¨¡å‹Word2Vec](https://blog.csdn.net/weixin_51545953/article/details/128622118?ops_request_misc=&request_id=&biz_id=102&utm_term=%E8%AF%8D%E5%90%91%E9%87%8F%E6%A8%A1%E5%9E%8B&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-128622118.nonecase&spm=1018.2226.3001.4187)

##### 1 å®šä¹‰

ä¸‹å›¾å±•ç¤ºäº†ä¸€ä¸ª50ç»´çš„è¯å‘é‡ï¼šï¼ˆå¯ä»¥æ˜¯éšä¾¿ä¸€ä¸ªå•è¯happyã€carã€person...ï¼‰

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/8caa4d081c4c4bad9738561186553d45.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" style="zoom:67%;" />

åœ¨çƒ­åº¦å›¾ç»“æœä¸­æ¯”è¾ƒå¯ä»¥å‘ç°ï¼Œç›¸ä¼¼çš„è¯åœ¨ç‰¹å¾è¡¨è¾¾ä¸­æ¯”è¾ƒç›¸ä¼¼ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜è¯çš„ç‰¹å¾æ˜¯æœ‰å®é™…æ„ä¹‰çš„ï¼

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/d10ea50c86e3415ba0d5d0d5b7fe9562.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" style="zoom:50%;" />

æ–‡å­—æ€ä¹ˆè¾“å…¥åˆ°ç¥ç»ç½‘ç»œä¸­å•Š ï¼Ÿè¿™ä¸ªé—®é¢˜å¾ˆå¥½ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šç”¨ä¸€ä¸ª Embedding å±‚æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨ç¥ç»ç½‘ç»œåˆå§‹åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šéšæœºåˆå§‹åŒ–ä¸€ä¸ª NÃ—K çš„çŸ©é˜µï¼Œå…¶ä¸­ N æ˜¯ è¯å…¸çš„å¤§å°ï¼ŒK æ˜¯è¯å‘é‡çš„ç»´æ•°ï¼ˆä¸€ä¸ªè‡ªè¡Œè®¾å®šçš„è¶…å‚æ•°ï¼‰ã€‚ç„¶åï¼Œæˆ‘ä»¬ä¼šç”¨ä¸€ä¸ª NÃ—N çš„çŸ©é˜µå’Œ NÃ—K çš„çŸ©é˜µç›¸ä¹˜ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„ NÃ—Kçš„çŸ©é˜µå‘ä¸‹è¿›è¡Œå‰å‘ä¼ æ’­ã€‚å…¶ä¸­ï¼ŒNÃ—N çš„çŸ©é˜µä¼šåœ¨è¾“å…¥çš„æ–‡å­—çš„å¯¹åº”å¯¹è§’çº¿ä¸Šè®¾ç½®ä¸º1ï¼Œå…¶ä½™ä½ç½®å‡ä¸º0ã€‚NÃ—K çš„çŸ©é˜µæ˜¯éšæœºåˆå§‹åŒ–çš„ï¼Œé€šè¿‡åå‘ä¼ æ’­è¿›è¡Œæ›´æ–°è°ƒæ•´ã€‚
<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/a7304a36424b40b38f581e2b186e06a4.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" style="zoom:50%;" />

##### 2 è®­ç»ƒæ•°æ®æ„å»º

ä¸€åˆ‡å…·æœ‰æ­£å¸¸é€»è¾‘çš„è¯­å¥éƒ½å¯ä»¥ä½œä¸ºè®­ç»ƒæ•°æ®ã€‚å¦‚å°è¯´ã€è®ºæ–‡ç­‰ã€‚å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªå¥å­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŒ‰ç…§ä¸‹é¢ä½ çš„æ–¹å¼æ„å»ºæ•°æ®é›†ï¼Œé€‰å‡ºå‰ä¸‰ä¸ªè¯ï¼Œç”¨å‰ä¸¤ä¸ªä½œä¸ºè¯æ¨¡å‹çš„è¾“å…¥ï¼Œæœ€åä¸€ä¸ªè¯ä½œä¸ºè¯æ¨¡å‹è¾“å‡ºçš„ç›®æ ‡ï¼Œç»§è€Œè¿›è¡Œè®­ç»ƒã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/3eb22fe32c07443b8e1dc60769a1d3db.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" style="zoom: 67%;" />

##### 3 CBOW/ Skip-gramæ¨¡å‹



##### 4 è´Ÿé‡‡æ ·æ¨¡å‹



#### 6.1.3.6 [ä¸‹é‡‡æ ·](https://blog.csdn.net/tingzhiyi/article/details/114368433?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169682232316800222888876%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169682232316800222888876&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-114368433-null-null.142^v95^insert_down28v1&utm_term=%E4%B8%8B%E9%87%87%E6%A0%B7&spm=1018.2226.3001.4187)

ä¸‹é‡‡æ ·ï¼ˆsubsampledï¼‰ï¼šåˆåé™é‡‡æ ·ã€ç¼©å°å›¾åƒï¼›

ä¸»è¦ç›®çš„æœ‰ä¸¤ä¸ªï¼š1ã€ä½¿å¾—å›¾åƒç¬¦åˆæ˜¾ç¤ºåŒºåŸŸçš„å¤§å°ï¼›2ã€ç”Ÿæˆå¯¹åº”å›¾åƒçš„ç¼©ç•¥å›¾ï¼›

ä¸‹é‡‡æ ·çš„æ–¹å¼ä¸»è¦æœ‰ä¸¤ç§ï¼š

- 1 é‡‡ç”¨strideä¸º2çš„æ± åŒ–å±‚ï¼Œå¦‚Max-poolingå’ŒAverage-poolingï¼Œç›®å‰é€šå¸¸ä½¿ç”¨Max-poolingï¼Œå› ä¸ºä»–è®¡ç®—ç®€å•è€Œä¸”èƒ½å¤Ÿæ›´å¥½çš„ä¿ç•™çº¹ç†ç‰¹å¾ï¼›
- 2 é‡‡ç”¨strideä¸º2çš„å·ç§¯å±‚ï¼Œä¸‹é‡‡æ ·çš„è¿‡ç¨‹æ˜¯ä¸€ä¸ªä¿¡æ¯æŸå¤±çš„è¿‡ç¨‹ï¼Œè€Œæ± åŒ–å±‚æ˜¯ä¸å¯å­¦ä¹ çš„ï¼Œç”¨strideä¸º2çš„å¯å­¦ä¹ å·ç§¯å±‚æ¥ä»£æ›¿poolingå¯ä»¥å¾—åˆ°æ›´å¥½çš„æ•ˆæœï¼Œå½“ç„¶åŒæ—¶ä¹Ÿå¢åŠ äº†ä¸€å®šçš„è®¡ç®—é‡ã€‚





#### 6.1.3.7 feature map

å°±æ˜¯ç‰¹å¾å›¾ï¼Œå¦‚æœæ˜¯RGBåˆ™ç§°å…¶æœ‰3ä¸ªfeatrue map



## 6.2 ç¥ç»ç½‘ç»œæ¶æ„

### 6.2.1 å·ç§¯Convolution

#### 6.2.1.1 å®šä¹‰

æœ€å¼€å§‹çš„å·ç§¯æ ¸å¯èƒ½æ˜¯äººä¸ºè®¾å®šçš„ï¼Œä½†ç°åœ¨æœºå™¨å­¦ä¹ ä¼šæ ¹æ®è‡ªå·±çš„æ•°æ®å»åå‘è°ƒèŠ‚å·ç§¯æ ¸ï¼Œæœ€ç»ˆæ‰¾åˆ°æœ€åˆé€‚çš„å·ç§¯æ ¸ã€‚

æ¯ä¸€ä¸ªå·ç§¯æ ¸ä¼šå¯¹åº”ä¸€å¼ ç‰¹å¾å›¾ã€‚æœ‰å‡ ä¸ªå·ç§¯æ ¸ï¼Œå°±ä¼šæœ‰å‡ ä¸ªç‰¹å¾å›¾ã€‚

å›¾æ˜¯å‡ ç»´çš„ï¼Œå·ç§¯æ ¸å°±æ˜¯å‡ ç»´çš„ã€‚

![image-20230926210101752](./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20230926210101752.png)

#### 6.2.1.2 å°ºå¯¸è®¡ç®—å…¬å¼

è¿™é‡Œè‹¥å‡ºç°åˆ†æ•°ï¼Œå‘ä¸‹å–æ•´å°±å¥½

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20231007091923931.png" alt="image-20231007091923931" style="zoom: 50%;" />



### 6.2.2 æ± åŒ–Pooling

ç²¾é«“å°±æ˜¯â€œå‹ç¼©â€

å°†å›¾ç‰‡ä¸­æœ‰ç‰¹å¾çš„éƒ¨åˆ†æ”¾å¤§ï¼Œæ²¡æœ‰ç‰¹å¾çš„å°±ä¸ç®¡äº†ã€‚å…·ä½“åšæ³•å°±æ˜¯å°†nÃ—nçš„æ ¼å­ä¸­æœ€å¤§çš„æ•°æ·»è¿›æ–°æ ¼å­ä¸­

åœ¨æ¨¡ç³Šçš„åŒæ—¶å°½é‡çš„ä¿ç•™äº†åŸå§‹ç‰¹å¾å›¾çš„é‡è¦ä¿¡æ¯ã€‚

æ± åŒ–ä¼šæŠŠæ•°æ®å˜å°ã€‚



### 6.2.3 éçº¿æ€§æ¿€æ´»

â€‚â€‚â€‚â€‚å¦‚æœ[ç¥ç»å…ƒ](https://so.csdn.net/so/search?q=ç¥ç»å…ƒ&spm=1001.2101.3001.7020)çš„è¾“å‡ºæ˜¯è¾“å…¥çš„çº¿æ€§å‡½æ•°ï¼Œè€Œçº¿æ€§å‡½æ•°ä¹‹é—´çš„åµŒå¥—ä»»ç„¶ä¼šå¾—åˆ°çº¿æ€§å‡½æ•°ã€‚å¦‚æœä¸åŠ éçº¿æ€§å‡½æ•°å¤„ç†ï¼Œé‚£ä¹ˆæœ€ç»ˆå¾—åˆ°çš„ä»ç„¶æ˜¯çº¿æ€§å‡½æ•°ã€‚æ‰€ä»¥éœ€è¦åœ¨ç¥ç»ç½‘ç»œä¸­å¼•å…¥éçº¿æ€§æ¿€æ´»å‡½æ•°ã€‚åœ¨[äººå·¥ç¥ç»ç½‘ç»œ](https://so.csdn.net/so/search?q=äººå·¥ç¥ç»ç½‘ç»œ&spm=1001.2101.3001.7020)ä¸­ï¼Œæ¿€æ´»å‡½æ•°å†³å®šæ˜¯å¦éœ€è¦ä¼ é€’ä¿¡å·ã€‚

â€‹	æ¿€æ´»ä¹Ÿä¼šæŠŠæ•°æ®å˜å°ã€‚

â€‹	å¸¸è§çš„æ¿€æ´»å‡½æ•°æœ‰ï¼š

- reluï¼šéçº¿æ€§çŸ«æ­£å‡½æ•°ï¼ŒæŠŠå°äº0çš„xå€¼å…¨éƒ¨å»æ‰ï¼Œç”¨0æ¥ä»£æ›¿ã€‚
- tanhï¼šåŒæ›²æ­£åˆ‡å¤„ç†å‡½æ•°ï¼ŒæŠŠç‰¹å¾xçš„å€¼å‹ç¼©è¿›-1åˆ°1çš„åŒºé—´å†…ï¼Œ-1ä»£è¡¨çš„æ˜¯xä¸­è¾ƒå°çš„æ•°å€¼ï¼Œè€Œ1ä»£è¡¨xä¸­è¾ƒå¤§çš„æ•°å€¼ã€‚
- logisticï¼šsigmodå‡½æ•°ï¼Œå°†ç‰¹å¾xçš„å€¼å‹ç¼©è¿›0åˆ°1çš„åŒºé—´å†…ã€‚

â€‹	é€šè¿‡å¯¹æ¯”éçº¿æ€§æ“ä½œå‰åçš„å›¾åƒï¼Œå‘ç°ç»è¿‡éçº¿æ€§æ¿€æ´»å‡½æ•°å¤„ç†ä¹‹åçš„å›¾åƒä¸­çš„ä¸»è¦å†…å®¹æ›´çªå‡ºäº†ã€‚
â€‚â€‚â€‚â€‚ReLUå‡½æ•°å¤„ç†è‡ªç„¶è¯­è¨€æ•ˆæœæ›´ä½³ï¼ŒSigmoidå‡½æ•°å¤„ç†å›¾åƒæ•ˆæœæ›´ä½³ã€‚

å›¾ä¸­reluæ˜¯ä¸è®¡å…¥å±‚æ•°çš„ï¼Œæ‰€ä»¥ä¸€å…±æœ‰9å±‚

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20231007092951391.png" alt="image-20231007092951391" style="zoom:50%;" />

### 6.2.4 Dropoutå±‚

dropoutæ˜¯ä½¿æŒ‡å®šæ¦‚ç‡çš„æƒé‡éšæœºå¤±æ´»ï¼Œä½œç”¨æ˜¯åŠ å¿«è®­ç»ƒé€Ÿåº¦ï¼Œæµ‹è¯•çš„æ—¶å€™æ˜¯ä¸ç”¨çš„



### 6.2.5 [å…¨è¿æ¥å±‚](https://blog.csdn.net/qq_39521554/article/details/81385159?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169573564916800222887711%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=169573564916800222887711&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~hot_rank-4-81385159-null-null.142^v94^insert_down28v1&utm_term=%E5%85%A8%E8%BF%9E%E6%8E%A5%E7%BD%91%E7%BB%9C&spm=1018.2226.3001.4187)

â€‹	å…¨è¿æ¥å±‚ï¼ˆfully connected layersï¼ŒFCï¼‰åœ¨æ•´ä¸ªå·ç§¯ç¥ç»ç½‘ç»œä¸­èµ·åˆ°â€œåˆ†ç±»å™¨â€çš„ä½œç”¨ã€‚å¦‚æœè¯´å·ç§¯å±‚ã€æ± åŒ–å±‚å’Œæ¿€æ´»å‡½æ•°å±‚ç­‰æ“ä½œæ˜¯å°†åŸå§‹æ•°æ®æ˜ å°„åˆ°éšå±‚ç‰¹å¾ç©ºé—´çš„è¯ï¼Œå…¨è¿æ¥å±‚åˆ™èµ·åˆ°å°†å­¦åˆ°çš„â€œåˆ†å¸ƒå¼ç‰¹å¾è¡¨ç¤ºâ€æ˜ å°„åˆ°æ ·æœ¬æ ‡è®°ç©ºé—´çš„ä½œç”¨ã€‚åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œå…¨è¿æ¥å±‚å¯ç”±å·ç§¯æ“ä½œå®ç°ï¼š	

â€‹	åœ¨CNNç»“æ„ä¸­ï¼Œç»å¤šä¸ªå·ç§¯å±‚å’Œæ± åŒ–å±‚åï¼Œè¿æ¥ç€1ä¸ªæˆ–1ä¸ªä»¥ä¸Šçš„å…¨è¿æ¥å±‚ï¼ä¸MLPç±»ä¼¼ï¼Œå…¨è¿æ¥å±‚ä¸­çš„æ¯ä¸ªç¥ç»å…ƒä¸å…¶å‰ä¸€å±‚çš„æ‰€æœ‰ç¥ç»å…ƒè¿›è¡Œå…¨è¿æ¥ï¼å…¨è¿æ¥å±‚å¯ä»¥æ•´åˆå·ç§¯å±‚æˆ–è€…æ± åŒ–å±‚ä¸­å…·æœ‰ç±»åˆ«åŒºåˆ†æ€§çš„å±€éƒ¨ä¿¡æ¯ï¼ä¸ºäº†æå‡ CNNç½‘ç»œæ€§èƒ½ï¼Œå…¨è¿æ¥å±‚æ¯ä¸ªç¥ç»å…ƒçš„æ¿€åŠ±å‡½æ•°ä¸€èˆ¬é‡‡ç”¨ReLUå‡½æ•°ã€‚



â€‹	æœ€åä¸€å±‚å…¨è¿æ¥å±‚çš„è¾“å‡ºå€¼è¢«ä¼ é€’ç»™ä¸€ä¸ªè¾“å‡ºï¼Œå¯ä»¥é‡‡ç”¨softmaxé€»è¾‘å›å½’ï¼ˆsoftmax regressionï¼‰è¿›è¡Œåˆ†ç±»ï¼Œè¯¥å±‚ä¹Ÿå¯ç§°ä¸º softmaxå±‚ï¼ˆsoftmax layerï¼‰ï¼å¯¹äºä¸€ä¸ªå…·ä½“çš„åˆ†ç±»ä»»åŠ¡ï¼Œé€‰æ‹©ä¸€ä¸ªåˆé€‚çš„æŸå¤±å‡½æ•°æ˜¯ååˆ†é‡è¦çš„ï¼ŒCNNå‡ ç§å¸¸ç”¨çš„æŸå¤±å‡½æ•°å¹¶åˆ†æäº†å®ƒä»¬å„è‡ªçš„ç‰¹ç‚¹ï¼é€šå¸¸ï¼ŒCNNçš„å…¨è¿æ¥å±‚ä¸MLPç»“æ„ä¸€æ ·ï¼ŒCNNçš„è®­ç»ƒç®—æ³•ä¹Ÿå¤šé‡‡ç”¨BPç®—æ³•ã€‚![img](./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/Center.png)

æœ€åçš„ä¸¤åˆ—å°åœ†çƒå°±æ˜¯ä¸¤ä¸ªå…¨è¿æ¥å±‚ï¼Œåœ¨æœ€åä¸€å±‚å·ç§¯ç»“æŸåï¼Œè¿›è¡Œäº†æœ€åä¸€æ¬¡æ± åŒ–ï¼Œè¾“å‡ºäº†20ä¸ª12*12çš„å›¾åƒï¼Œç„¶åé€šè¿‡äº†ä¸€ä¸ªå…¨è¿æ¥å±‚å˜æˆäº†1*100çš„å‘é‡ã€‚

è¿™æ˜¯æ€ä¹ˆåšåˆ°çš„å‘¢ï¼Œå…¶å®å°±æ˜¯æœ‰20*100ä¸ª12*12çš„å·ç§¯æ ¸å·ç§¯å‡ºæ¥çš„ï¼Œå¯¹äºè¾“å…¥çš„æ¯ä¸€å¼ å›¾ï¼Œç”¨äº†ä¸€ä¸ªå’Œå›¾åƒä¸€æ ·å¤§å°çš„æ ¸å·ç§¯ï¼Œè¿™æ ·æ•´å¹…å›¾å°±å˜æˆäº†ä¸€ä¸ªæ•°äº†ï¼Œå¦‚æœåšåº¦æ˜¯20å°±æ˜¯é‚£20ä¸ªæ ¸å·ç§¯å®Œäº†ä¹‹åç›¸åŠ æ±‚å’Œã€‚è¿™æ ·å°±èƒ½æŠŠä¸€å¼ å›¾é«˜åº¦æµ“ç¼©æˆä¸€ä¸ªæ•°äº†ã€‚å…¨è¿æ¥çš„ç›®çš„æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ

å› ä¸ºä¼ ç»Ÿçš„ç½‘ç»œæˆ‘ä»¬çš„è¾“å‡ºéƒ½æ˜¯åˆ†ç±»ï¼Œä¹Ÿå°±æ˜¯å‡ ä¸ªç±»åˆ«çš„æ¦‚ç‡ç”šè‡³å°±æ˜¯ä¸€ä¸ªæ•°--ç±»åˆ«å·ï¼Œé‚£ä¹ˆ**å…¨è¿æ¥å±‚å°±æ˜¯é«˜åº¦æçº¯çš„ç‰¹å¾**äº†ï¼Œæ–¹ä¾¿äº¤ç»™æœ€åçš„åˆ†ç±»å™¨æˆ–è€…å›å½’ã€‚ä½†æ˜¯å…¨è¿æ¥çš„å‚æ•°å®åœ¨æ˜¯å¤ªå¤šäº†ï¼Œä½ æƒ³è¿™å¼ å›¾é‡Œå°±æœ‰20*12*12*100ä¸ªå‚æ•°ï¼Œå‰é¢éšä¾¿ä¸€å±‚å·ç§¯ï¼Œå‡è®¾å·ç§¯æ ¸æ˜¯7*7çš„ï¼Œåšåº¦æ˜¯64ï¼Œé‚£ä¹Ÿæ‰7*7*64ï¼Œæ‰€ä»¥ç°åœ¨çš„è¶‹åŠ¿æ˜¯å°½é‡é¿å…å…¨è¿æ¥ï¼Œç›®å‰ä¸»æµçš„ä¸€ä¸ªæ–¹æ³•æ˜¯å…¨å±€å¹³å‡å€¼ã€‚

ä¹Ÿå°±æ˜¯***æœ€åé‚£ä¸€å±‚çš„feature mapï¼ˆæœ€åä¸€å±‚å·ç§¯çš„è¾“å‡ºç»“æœï¼‰ï¼Œç›´æ¥æ±‚å¹³å‡å€¼ã€‚æœ‰å¤šå°‘ç§åˆ†ç±»å°±è®­ç»ƒå¤šå°‘å±‚ï¼Œè¿™åä¸ªæ•°å­—å°±æ˜¯å¯¹åº”çš„æ¦‚ç‡æˆ–è€…å«ç½®ä¿¡åº¦ã€‚***


### 6.2.6 [solfmaxå±‚](https://blog.csdn.net/yangwohenmai1/article/details/96156497?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169577759416800188578769%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169577759416800188578769&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-96156497-null-null.142^v94^insert_down28v1&utm_term=softmax%E5%B1%82&spm=1018.2226.3001.4187)

ä¹Ÿå«solfmaxåˆ†ç±»å™¨

***ä¸»è¦ä½œç”¨æ˜¯å°†å¾—åˆ†å‡½æ•°å¾—å‡ºçš„å¾—åˆ†å€¼è½¬åŒ–æˆæ¯ä¸ªç±»å¯¹åº”çš„æ¦‚ç‡***

Softmaxå›å½’æ¨¡å‹æ˜¯logisticå›å½’æ¨¡å‹åœ¨å¤šåˆ†ç±»é—®é¢˜ä¸Šçš„æ¨å¹¿ï¼Œåœ¨å¤šåˆ†ç±»é—®é¢˜ä¸­ï¼Œå¾…åˆ†ç±»çš„ç±»åˆ«æ•°é‡å¤§äº2ï¼Œä¸”ç±»åˆ«ä¹‹é—´äº’æ–¥ã€‚æ¯”å¦‚æˆ‘ä»¬çš„ç½‘ç»œè¦å®Œæˆçš„åŠŸèƒ½æ˜¯è¯†åˆ«0-9è¿™10ä¸ªæ‰‹å†™æ•°å­—ï¼Œè‹¥æœ€åä¸€å±‚çš„è¾“å‡ºä¸º[0,1,0, 0, 0, 0, 0, 0, 0, 0]ï¼Œåˆ™è¡¨æ˜æˆ‘ä»¬ç½‘ç»œçš„è¯†åˆ«ç»“æœä¸ºæ•°å­—1ã€‚

åœ¨æˆ‘ä»¬çš„ç½‘ç»œä¸­ï¼Œæœ€åä¸€å±‚æ˜¯softmaxå±‚ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸ä¼šç”¨åˆ°åå‘ä¼ æ’­ã€‚

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/20160823161702519.png" alt="img" style="zoom: 33%;" />

é€šè¿‡sigmodå‡½æ•°ï¼Œå°†å¾—åˆ†è½¬åŒ–æˆæ¦‚ç‡å€¼

å¼•ç”¨ä¸€å¼ ç½‘ä¸Šçš„åŸç†å›¾ï¼Œè¯¥å›¾æè¿°äº†*softmax*å¯¹è¾“å‡ºç»“æœçš„è®¡ç®—è¿‡ç¨‹ï¼šå…¶ä¸­[3,1,-3]æ˜¯ä¸Šä¸€å±‚çš„è¾“å‡º

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3lhbmd3b2hlbm1haTE=,size_16,color_FFFFFF,t_70.png" alt="img" style="zoom:67%;" />

### 6.2.7 æŸå¤±å‡½æ•°

æŸå¤±å‡½æ•°ä¸€èˆ¬ä¹ æƒ¯ç”¨å½’ä¸€åŒ–åçš„æ¦‚ç‡å–-log()çš„å½¢å¼æ¥è¡¨ç°ï¼Œç”±å›¾å¯å¾—ï¼Œæ¦‚ç‡è¶Šé è¿‘1çš„ï¼Œå–å®Œ-logåæŸå¤±å€¼å°±è¶Šå°ï¼Œåä¹‹è¶Šå¤§

åŒ…æ‹¬nn.CrossEntropyLossçš„æŸå¤±è®¡ç®—å…¬å¼ï¼Œæ•´ä½“ä¹Ÿæ˜¯è¿™ç§è®¡ç®—æ€è·¯ã€‚

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20230928090826996.png" alt="image-20230928090826996" style="zoom:67%;" />

### 6.2.8 æ¢¯åº¦ä¸‹é™

æ¢¯åº¦ä¸‹é™å°±æ˜¯æ±‚ä¸€ä¸ªå‡½æ•°çš„æœ€å°å€¼ã€‚

æ¢¯åº¦ä¸‹é™æ˜¯æœºå™¨å­¦ä¹ ä¸­çš„[å¸¸ç”¨ç®—æ³•](https://so.csdn.net/so/search?q=å¸¸ç”¨ç®—æ³•&spm=1001.2101.3001.7020)ï¼Œé€šè¿‡ä¸æ–­è¿­ä»£è®¡ç®—å‡½æ•°çš„æ¢¯åº¦ï¼Œåˆ¤æ–­è¯¥ç‚¹çš„æŸä¸€æ–¹å‘å’Œç›®æ ‡ä¹‹é—´çš„è·ç¦»ï¼Œ***æœ€ç»ˆæ±‚å¾—æœ€å°çš„æŸå¤±å‡½æ•°å’Œç›¸å…³å‚æ•°***ï¼Œä¸ºå»ºç«‹çº¿æ€§æ¨¡å‹æä¾›æ”¯æŒã€‚

ä¸­å¿ƒæ€æƒ³ï¼šå°±æ˜¯é€šè¿‡ä¸æ–­è¿­ä»£å¾—åˆ°ä½¿å¾—æŸå¤±å‡½æ•°æœ€å°çš„æƒé‡ã€‚

å¯¹åº”ä»£ç å°±æ˜¯torchçš„ä¼˜åŒ–å™¨optimï¼ˆ4.6.6ï¼‰éƒ¨åˆ†

#### 6.2.8.1 æ¢¯åº¦ä¸‹é™çš„3ç§ä¸åŒå½¢å¼

##### 1 æ‰¹é‡æ¢¯åº¦ä¸‹é™

ï¼ˆBatch Gradient Descentï¼‰ 

##### 2 éšæœºæ¢¯åº¦ä¸‹é™

ï¼ˆStochastic Gradient Descentï¼‰

##### 3 å°æ‰¹é‡æ¢¯åº¦ä¸‹é™(æ·±åº¦å­¦ä¹ å¸¸ç”¨)

ï¼ˆMini-Batch Gradient Descentï¼‰

#### 6.2.8.2 å­¦ä¹ é€Ÿç‡Lr

è¿ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•è¿›è¡Œä¼˜åŒ–æ—¶ï¼Œæƒé‡çš„æ›´æ–°è§„åˆ™ä¸­ï¼Œåœ¨æ¢¯åº¦é¡¹å‰ä¼šä¹˜ä»¥ä¸€ä¸ªç³»æ•°ï¼Œè¿™ä¸ªç³»æ•°å°±å«å­¦ä¹ é€Ÿç‡ Î± ï¼š

- å¦‚æœå­¦ä¹ é€Ÿç‡å¤ªå°ï¼Œåˆ™ä¼šä½¿æ”¶æ•›è¿‡æ…¢ã€‚

- å¦‚æœå­¦ä¹ é€Ÿç‡å¤ªå¤§ï¼Œåˆ™ä¼šå¯¼è‡´ä»£ä»·å‡½æ•°æŒ¯è¡ï¼Œè¿­ä»£è¿‡å¿«ï¼Œæ¢¯åº¦ä¸‹é™æ³•å¯èƒ½ä¼šè¶Šè¿‡æœ€ä½ç‚¹ï¼Œç”šè‡³å¯èƒ½å‘æ•£ã€‚
  





### 6.2.9 åå‘ä¼ æ’­



### 6.2.10 è¾¹ç¼˜å¡«å……Padding

 ç›®çš„æ˜¯ä¸ºäº†ä½¿å¾—ç‰¹å¾å›¾è¾¹ç¼˜çš„ç‰¹å¾èƒ½å¤Ÿè¢«å¹³ç­‰çš„åˆ©ç”¨ã€‚



## 6.3 [tensorä¸­ç»´åº¦çš„ç†è§£](https://blog.csdn.net/AlexFaker/article/details/122526169?ops_request_misc=&request_id=&biz_id=102&utm_term=tensor%20%E7%BB%B4%E5%BA%A6&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-0-122526169.142^v94^insert_down28v1&spm=1018.2226.3001.4187)

```py
import torch

a = torch.randn(3, 4, 5)

print(a)

b = torch.cat((a,a), dim=0)
print(b)

c = torch.cat((a,a), dim=1)
print(c)

d = torch.cat((a,a), dim=2)
print(d)
```

```py
#è¾“å‡º a
tensor([[[ 0.0696,  0.6560,  0.2202, -1.0453,  0.9021],
         [-0.1584, -0.9985, -1.1443, -1.4210, -0.4188],
         [ 1.4070,  2.9814, -2.1767,  1.0888,  0.9540],
         [ 0.3563, -0.7126,  0.2440, -0.1334, -1.0844]],

        [[ 0.2997,  0.8679, -0.8382,  0.8501, -1.4777],
         [-0.2198, -0.0803, -0.4598, -0.0678,  0.1530],
         [-0.4743, -0.5473, -1.2885, -1.7756, -0.4839],
         [ 0.8187, -0.0167,  1.6490,  0.4461, -1.6552]],

        [[ 1.3202, -0.8440,  0.1945,  0.3633,  0.2360],
         [ 1.0943,  2.1030, -0.5662, -0.8079, -1.3058],
         [ 0.6459, -0.2108, -0.8447, -0.7190,  0.3210],
         [-0.1285,  1.5799,  0.1454,  1.6499, -1.3747]]])
# b = torch.cat((a,a), dim=0)  -> è¿™é‡Œçš„0ç»´å¯¹åº”çš„æ˜¯açš„ç¬¬ä¸€ä¸ª3ï¼Œæœ€é«˜ç»´æ‹¼æ¥
tensor([[[ 0.0696,  0.6560,  0.2202, -1.0453,  0.9021],
         [-0.1584, -0.9985, -1.1443, -1.4210, -0.4188],
         [ 1.4070,  2.9814, -2.1767,  1.0888,  0.9540],
         [ 0.3563, -0.7126,  0.2440, -0.1334, -1.0844]],

        [[ 0.2997,  0.8679, -0.8382,  0.8501, -1.4777],
         [-0.2198, -0.0803, -0.4598, -0.0678,  0.1530],
         [-0.4743, -0.5473, -1.2885, -1.7756, -0.4839],
         [ 0.8187, -0.0167,  1.6490,  0.4461, -1.6552]],

        [[ 1.3202, -0.8440,  0.1945,  0.3633,  0.2360],
         [ 1.0943,  2.1030, -0.5662, -0.8079, -1.3058],
         [ 0.6459, -0.2108, -0.8447, -0.7190,  0.3210],
         [-0.1285,  1.5799,  0.1454,  1.6499, -1.3747]],

        [[ 0.0696,  0.6560,  0.2202, -1.0453,  0.9021],
         [-0.1584, -0.9985, -1.1443, -1.4210, -0.4188],
         [ 1.4070,  2.9814, -2.1767,  1.0888,  0.9540],
         [ 0.3563, -0.7126,  0.2440, -0.1334, -1.0844]],

        [[ 0.2997,  0.8679, -0.8382,  0.8501, -1.4777],
         [-0.2198, -0.0803, -0.4598, -0.0678,  0.1530],
         [-0.4743, -0.5473, -1.2885, -1.7756, -0.4839],
         [ 0.8187, -0.0167,  1.6490,  0.4461, -1.6552]],

        [[ 1.3202, -0.8440,  0.1945,  0.3633,  0.2360],
         [ 1.0943,  2.1030, -0.5662, -0.8079, -1.3058],
         [ 0.6459, -0.2108, -0.8447, -0.7190,  0.3210],
         [-0.1285,  1.5799,  0.1454,  1.6499, -1.3747]]])
#c = torch.cat((a,a), dim=1)  -> 1ç»´å¯¹åº”ç¬¬äºŒç»´ï¼Œåˆ—æ‹¼æ¥
tensor([[[ 0.0696,  0.6560,  0.2202, -1.0453,  0.9021],
         [-0.1584, -0.9985, -1.1443, -1.4210, -0.4188],
         [ 1.4070,  2.9814, -2.1767,  1.0888,  0.9540],
         [ 0.3563, -0.7126,  0.2440, -0.1334, -1.0844],
         [ 0.0696,  0.6560,  0.2202, -1.0453,  0.9021],
         [-0.1584, -0.9985, -1.1443, -1.4210, -0.4188],
         [ 1.4070,  2.9814, -2.1767,  1.0888,  0.9540],
         [ 0.3563, -0.7126,  0.2440, -0.1334, -1.0844]],

        [[ 0.2997,  0.8679, -0.8382,  0.8501, -1.4777],
         [-0.2198, -0.0803, -0.4598, -0.0678,  0.1530],
         [-0.4743, -0.5473, -1.2885, -1.7756, -0.4839],
         [ 0.8187, -0.0167,  1.6490,  0.4461, -1.6552],
         [ 0.2997,  0.8679, -0.8382,  0.8501, -1.4777],
         [-0.2198, -0.0803, -0.4598, -0.0678,  0.1530],
         [-0.4743, -0.5473, -1.2885, -1.7756, -0.4839],
         [ 0.8187, -0.0167,  1.6490,  0.4461, -1.6552]],

        [[ 1.3202, -0.8440,  0.1945,  0.3633,  0.2360],
         [ 1.0943,  2.1030, -0.5662, -0.8079, -1.3058],
         [ 0.6459, -0.2108, -0.8447, -0.7190,  0.3210],
         [-0.1285,  1.5799,  0.1454,  1.6499, -1.3747],
         [ 1.3202, -0.8440,  0.1945,  0.3633,  0.2360],
         [ 1.0943,  2.1030, -0.5662, -0.8079, -1.3058],
         [ 0.6459, -0.2108, -0.8447, -0.7190,  0.3210],
         [-0.1285,  1.5799,  0.1454,  1.6499, -1.3747]]])
#d = torch.cat((a,a), dim=2)  -> dim=2å¯¹åº”æœ€ä½ç»´ï¼Œå¯¹åº”è¡Œæ‹¼æ¥
tensor([[[ 0.0696,  0.6560,  0.2202, -1.0453,  0.9021,  0.0696,  0.6560,
           0.2202, -1.0453,  0.9021],
         [-0.1584, -0.9985, -1.1443, -1.4210, -0.4188, -0.1584, -0.9985,
          -1.1443, -1.4210, -0.4188],
         [ 1.4070,  2.9814, -2.1767,  1.0888,  0.9540,  1.4070,  2.9814,
          -2.1767,  1.0888,  0.9540],
         [ 0.3563, -0.7126,  0.2440, -0.1334, -1.0844,  0.3563, -0.7126,
           0.2440, -0.1334, -1.0844]],

        [[ 0.2997,  0.8679, -0.8382,  0.8501, -1.4777,  0.2997,  0.8679,
          -0.8382,  0.8501, -1.4777],
         [-0.2198, -0.0803, -0.4598, -0.0678,  0.1530, -0.2198, -0.0803,
          -0.4598, -0.0678,  0.1530],
         [-0.4743, -0.5473, -1.2885, -1.7756, -0.4839, -0.4743, -0.5473,
          -1.2885, -1.7756, -0.4839],
         [ 0.8187, -0.0167,  1.6490,  0.4461, -1.6552,  0.8187, -0.0167,
           1.6490,  0.4461, -1.6552]],

        [[ 1.3202, -0.8440,  0.1945,  0.3633,  0.2360,  1.3202, -0.8440,
           0.1945,  0.3633,  0.2360],
         [ 1.0943,  2.1030, -0.5662, -0.8079, -1.3058,  1.0943,  2.1030,
          -0.5662, -0.8079, -1.3058],
         [ 0.6459, -0.2108, -0.8447, -0.7190,  0.3210,  0.6459, -0.2108,
          -0.8447, -0.7190,  0.3210],
         [-0.1285,  1.5799,  0.1454,  1.6499, -1.3747, -0.1285,  1.5799,
           0.1454,  1.6499, -1.3747]]])

Process finished with exit code 0

```





## 6.4 [è¿ç§»å­¦ä¹ ](https://blog.csdn.net/sikh_0529/article/details/126864397?ops_request_misc=&request_id=&biz_id=102&utm_term=%E8%BF%81%E7%A7%BB%E5%AD%A6%E4%B9%A0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-126864397.142^v94^insert_down28v1&spm=1018.2226.3001.4187)

è¿ç§»å­¦ä¹ (Transfer Learning)æ˜¯ä¸€ç§æœºå™¨å­¦ä¹ æ–¹æ³•ï¼Œå°±æ˜¯æŠŠä¸ºä»»åŠ¡ A å¼€å‘çš„æ¨¡å‹ä½œä¸ºåˆå§‹ç‚¹ï¼Œé‡æ–°ä½¿ç”¨åœ¨ä¸ºä»»åŠ¡ B å¼€å‘æ¨¡å‹çš„è¿‡ç¨‹ä¸­ã€‚è¿ç§»å­¦ä¹ æ˜¯é€šè¿‡ä»å·²å­¦ä¹ çš„ç›¸å…³ä»»åŠ¡ä¸­è½¬ç§»çŸ¥è¯†æ¥æ”¹è¿›å­¦ä¹ çš„æ–°ä»»åŠ¡ï¼Œè™½ç„¶å¤§å¤šæ•°æœºå™¨å­¦ä¹ ç®—æ³•éƒ½æ˜¯ä¸ºäº†è§£å†³å•ä¸ªä»»åŠ¡è€Œè®¾è®¡çš„ï¼Œä½†æ˜¯ä¿ƒè¿›è¿ç§»å­¦ä¹ çš„ç®—æ³•çš„å¼€å‘æ˜¯æœºå™¨å­¦ä¹ ç¤¾åŒºæŒç»­å…³æ³¨çš„è¯é¢˜ã€‚ è¿ç§»å­¦ä¹ å¯¹äººç±»æ¥è¯´å¾ˆå¸¸è§ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šå‘ç°å­¦ä¹ è¯†åˆ«è‹¹æœå¯èƒ½æœ‰åŠ©äºè¯†åˆ«æ¢¨ï¼Œæˆ–è€…å­¦ä¹ å¼¹å¥ç”µå­ç´å¯èƒ½æœ‰åŠ©äºå­¦ä¹ é’¢ç´ã€‚

æ‰¾åˆ°ç›®æ ‡é—®é¢˜çš„ç›¸ä¼¼æ€§ï¼Œè¿ç§»å­¦ä¹ ä»»åŠ¡å°±æ˜¯ä»ç›¸ä¼¼æ€§å‡ºå‘ï¼Œå°†æ—§é¢†åŸŸ(domain)å­¦ä¹ è¿‡çš„æ¨¡å‹åº”ç”¨åœ¨æ–°é¢†åŸŸä¸Šã€‚



- 

  









# 7 å„ç§ç¥ç»ç½‘ç»œ

## 7.0 ç¥ç»ç½‘ç»œ

å°†ä¸‹å›¾çš„è¿™ç§å•ä¸ªç¥ç»å…ƒ

![img](./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/20160703140734967.png)

ç»„ç»‡åœ¨ä¸€èµ·ï¼Œä¾¿å½¢æˆäº†ç¥ç»ç½‘ç»œã€‚ä¸‹å›¾ä¾¿æ˜¯ä¸€ä¸ªä¸‰å±‚ç¥ç»ç½‘ç»œç»“æ„

![img](./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/20160703140745657.png)

## 7.1 [å·ç§¯ç¥ç»ç½‘ç»œ(cnn)](https://blog.csdn.net/v_JULY_v/article/details/51812459?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169572917716800197023772%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=169572917716800197023772&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-51812459-null-null.142^v94^insert_down28v1&utm_term=cnn&spm=1018.2226.3001.4187)

### 7.1.1 cnnè¦è§£å†³çš„é—®é¢˜

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/format,png.png" alt="img" style="zoom: 67%;" />

å½“æ¯”è¾ƒä¸¤å¹…å›¾çš„æ—¶å€™ï¼Œå¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªåƒç´ å€¼ä¸åŒ¹é…ï¼Œé‚£ä¹ˆè¿™ä¸¤å¹…å›¾å°±ä¸åŒ¹é…ï¼Œè‡³å°‘å¯¹äºè®¡ç®—æœºæ¥è¯´æ˜¯è¿™æ ·çš„ã€‚å¯¹äºè¿™ä¸ªä¾‹å­ï¼Œè®¡ç®—æœºè®¤ä¸ºä¸Šè¿°ä¸¤å¹…å›¾ä¸­çš„ç™½è‰²åƒç´ é™¤äº†ä¸­é—´çš„3*3çš„å°æ–¹æ ¼é‡Œé¢æ˜¯ç›¸åŒçš„ï¼Œå…¶ä»–å››ä¸ªè§’ä¸Šéƒ½ä¸åŒï¼šä½†æ˜¯è¿™ä¹ˆåšï¼Œæ˜¾å¾—å¤ªä¸åˆç†äº†ã€‚ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›ï¼Œå¯¹äºé‚£äº›ä»…ä»…åªæ˜¯åšäº†ä¸€äº›åƒå¹³ç§»ï¼Œç¼©æ”¾ï¼Œæ—‹è½¬ï¼Œå¾®å˜å½¢ç­‰ç®€å•å˜æ¢çš„å›¾åƒï¼Œè®¡ç®—æœºä»ç„¶èƒ½å¤Ÿè¯†åˆ«å‡ºå›¾ä¸­çš„"X"å’Œ"O"ã€‚å°±åƒä¸‹é¢è¿™äº›æƒ…å†µï¼Œæˆ‘ä»¬å¸Œæœ›è®¡ç®—æœºä¾ç„¶èƒ½å¤Ÿå¾ˆå¿«å¹¶ä¸”å¾ˆå‡†çš„è¯†åˆ«å‡ºæ¥ï¼š

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/format,png-1695776838913-7.png" alt="img" style="zoom:80%;" />

***å¯¹äºCNNæ¥è¯´ï¼Œå®ƒæ˜¯ä¸€å—ä¸€å—åœ°æ¥è¿›è¡Œæ¯”å¯¹ã€‚å®ƒæ‹¿æ¥æ¯”å¯¹çš„è¿™ä¸ªâ€œå°å—â€æˆ‘ä»¬ç§°ä¹‹ä¸ºFeaturesï¼ˆç‰¹å¾/å·ç§¯æ ¸ï¼‰ã€‚åœ¨ä¸¤å¹…å›¾ä¸­å¤§è‡´ç›¸åŒçš„ä½ç½®æ‰¾åˆ°ä¸€äº›ç²—ç³™çš„ç‰¹å¾è¿›è¡Œå·ç§¯è¿ç®—ï¼ŒCNNèƒ½å¤Ÿæ›´å¥½çš„çœ‹åˆ°ä¸¤å¹…å›¾çš„ç›¸ä¼¼æ€§ï¼Œç›¸æ¯”èµ·ä¼ ç»Ÿçš„æ•´å¹…å›¾é€ä¸€æ¯”å¯¹çš„æ–¹æ³•ã€‚***

æ¯ä¸€ä¸ªfeatureå°±åƒæ˜¯ä¸€ä¸ªå°å›¾ï¼ˆå°±æ˜¯ä¸€ä¸ªæ¯”è¾ƒå°çš„æœ‰å€¼çš„äºŒç»´æ•°ç»„ï¼‰ã€‚ä¸åŒçš„FeatureåŒ¹é…å›¾åƒä¸­ä¸åŒçš„ç‰¹å¾ã€‚åœ¨å­—æ¯"X"çš„ä¾‹å­ä¸­ï¼Œé‚£äº›ç”±å¯¹è§’çº¿å’Œäº¤å‰çº¿ç»„æˆçš„featuresåŸºæœ¬ä¸Šèƒ½å¤Ÿè¯†åˆ«å‡ºå¤§å¤šæ•°"X"æ‰€å…·æœ‰çš„é‡è¦ç‰¹å¾ã€‚
è¿™äº›featureså¾ˆæœ‰å¯èƒ½å°±æ˜¯åŒ¹é…ä»»ä½•å«æœ‰å­—æ¯"X"çš„å›¾ä¸­å­—æ¯Xçš„å››ä¸ªè§’å’Œå®ƒçš„ä¸­å¿ƒã€‚å¦‚ä¸‹ï¼š

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/format,png-1695777000050-10.png" alt="img" style="zoom:80%;" />





## 7.2 [RNN/LSTM](RNN/LSTM)

rnnæ˜¯å¤„ç†åºåˆ—å‹æ•°æ®

å¦‚ï¼š

1. è‡ªç„¶è¯­è¨€å¤„ç†é—®é¢˜ã€‚x1å¯ä»¥çœ‹åšæ˜¯ç¬¬ä¸€ä¸ªå•è¯ï¼Œx2å¯ä»¥çœ‹åšæ˜¯ç¬¬äºŒä¸ªå•è¯ï¼Œä¾æ¬¡ç±»æ¨ã€‚
2. è¯­éŸ³å¤„ç†ã€‚æ­¤æ—¶ï¼Œx1ã€x2ã€x3â€¦â€¦æ˜¯æ¯å¸§çš„å£°éŸ³ä¿¡å·ã€‚
3. æ—¶é—´åºåˆ—é—®é¢˜ã€‚ä¾‹å¦‚æ¯å¤©çš„è‚¡ç¥¨ä»·æ ¼ç­‰ç­‰ã€‚



å¾ªç¯ä½¿å¾—RNNçœ‹èµ·æ¥éå¸¸ç¥ç§˜ã€‚ç„¶è€Œï¼Œå¦‚æœä½ ä»”ç»†æƒ³æƒ³ï¼Œè¿™æ ·ä¹Ÿä¸æ¯”ä¸€ä¸ªæ­£å¸¸çš„ç¥ç»ç½‘ç»œéš¾äºç†è§£ã€‚RNNå¯ä»¥è¢«çœ‹åšæ˜¯åŒä¸€ç¥ç»ç½‘ç»œçš„å¤šæ¬¡å¤åˆ¶ï¼Œæ¯ä¸ªç¥ç»ç½‘ç»œæ¨¡å—ä¼šæŠŠæ¶ˆæ¯ä¼ é€’ç»™ä¸‹ä¸€ä¸ªã€‚æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬å°†è¿™ä¸ªå¾ªç¯å±•å¼€ï¼š

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20231007094939125.png" alt="image-20231007094939125" style="zoom:67%;" />

### 



## 7.3 [Resnet](https://blog.csdn.net/qq_42309130/article/details/117635432?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169681821416800197089073%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=169681821416800197089073&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-12-117635432-null-null.142^v95^insert_down28v1&utm_term=width_per_group&spm=1018.2226.3001.4187)

Resnetä¸»è¦æ˜¯ä¸ºäº†é˜²æ­¢ä¼ ç»Ÿç¥ç»ç½‘ç»œå±‚æ•°è¿‡å¤šè€Œå¯¼è‡´çš„æ¢¯åº¦æ¶ˆå¤±æˆ–è€…æ¢¯åº¦çˆ†ç‚¸è€Œè®¾è®¡ã€‚

å…¶ä¸»è¦åŸç†å°±æ˜¯åœ¨å¯¹æ•°æ®è¿›è¡Œå˜æ¢åå¾—åˆ°F(x)çš„åŒæ—¶æœ€åè¿˜è¦åŠ ä¸ŠåŸæ¥çš„xï¼Œå¦‚æœxéœ€è¦ä¼˜åŒ–å°±+F(x)å˜æ¢ï¼Œæ•ˆæœä¸å¥½å°±F(x)=0ä¸å˜

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQyMzA5MTMw,size_16,color_FFFFFF,t_70.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°" style="zoom: 33%;" />

åŒæ—¶ï¼Œè¿˜è¦æ³¨æ„ç»´åº¦çš„é—®é¢˜ï¼Œå› ä¸ºå¦‚æœåœ¨å˜æ¢æ—¶strideâ‰ 1ï¼Œåˆ™åŸæ¥xçš„å°ºå¯¸ä¼šç¼©å°ï¼Œè¿™ä¸ªæ—¶å€™ç›´è¿ä¹Ÿéœ€è¦è¿›è¡Œç›¸åº”å˜åŒ–ï¼ˆå¦‚å¯¹Xåš1x1çš„å·ç§¯ï¼‰ï¼›

æ±‚F(X)æ®‹å·®çš„å·ç§¯å‡ä½¿ç”¨3x3convï¼Œä¸‹é‡‡æ ·å¤§å°é™ç»´ä¸€åŠã€‚

ç”±äºæ’ç­‰æ˜ å°„Xçš„å­˜åœ¨ï¼Œåå‘ä¼ æ’­æ—¶ï¼Œæ¢¯åº¦å¯ä»¥ä»æ·±å±‚ç›´æ¥ç»™åˆ°æµ…å±‚ï¼Œé¿å…äº†æ¢¯åº¦æ¶ˆå¤±ä¸çˆ†ç‚¸ã€‚

### 7.3.0 å„ç±»Resnetçš„ç»“æ„

<img src="./æ·±åº¦å­¦ä¹ ç¬”è®°.assets/image-20231010110803635.png" alt="image-20231010110803635"  />



***æˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ResNetä¸­å¯¹äº50å±‚ä»¥ä¸‹(18/34)çš„æ„å»ºå—é‡‡ç”¨çš„æ˜¯2å±‚çš„BasicBlockï¼Œè€Œå¤§äº50çš„æ·±å±‚**(50/101/152)**åˆ™é‡‡ç”¨çš„æ˜¯3å±‚çš„Bottleneck***

### 7.3.1 Resnet18/34

#### 7.3.1.1 ***Resnet18/34ä½¿ç”¨çš„æ®‹å·®å—BasicBlock***

```py
class BasicBlock(nn.Module):
    expansion = 1
    #expansionæ˜¯ä¸ä¸‰å±‚æ®‹å·®å—å¯¹åº”,ä¸‰å±‚æ®‹å·®å—çš„æœ€åä¸€å±‚æ·±åº¦ä¼šç¿»4å€

    def __init__(self, in_channel, out_channel, stride=1, downsample=None, **kwargs):
        """
        ä¼ å…¥å‚æ•°åŒ…æ‹¬è¾“å…¥å›¾åƒçš„æ·±åº¦,è¾“å‡ºå›¾åƒçš„æ·±åº¦,å·ç§¯æ­¥é•¿é»˜è®¤æ˜¯1,æ˜¯å¦è¿›è¡Œä¸‹é‡‡æ ·
        """
        super(BasicBlock, self).__init__()
        self.conv1 = nn.Conv2d(in_channels=in_channel, out_channels=out_channel,
                               kernel_size=3, stride=stride, padding=1, bias=False)
        #ä¸¤å±‚å‹æ®‹å·®å—çš„å·ç§¯æ ¸æ·±åº¦å³ä¸ºè¾“å…¥å›¾åƒçš„æ·±åº¦,å·ç§¯æ ¸ä¸ªæ•°å³ä¸ºè¾“å‡ºçš„æ·±åº¦,ä¸”å‡ä¸º3*3å·ç§¯æ ¸
        #ç¬¬ä¸€å±‚çš„å·ç§¯æ ¸æ­¥é•¿å½“è¿›è¡Œä¸‹é‡‡æ ·æ—¶ä¸º2,æ•…è¿™é‡Œå®šä¸ºstride
        self.bn1 = nn.BatchNorm2d(out_channel)
        self.relu = nn.ReLU()
        self.conv2 = nn.Conv2d(in_channels=out_channel, out_channels=out_channel,
                               kernel_size=3, stride=1, padding=1, bias=False)
        self.bn2 = nn.BatchNorm2d(out_channel)
        self.downsample = downsample

    def forward(self, x):
        identity = x
        if self.downsample is not None:
            identity = self.downsample(x)

        out = self.conv1(x)
        out = self.bn1(out)
        out = self.relu(out)

        out = self.conv2(out)
        out = self.bn2(out)

        out += identity
        out = self.relu(out)

        return out
```



### 7.3.2 [Resnet50](https://blog.csdn.net/qq_42309130/article/details/117635432?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522169681821416800197089073%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=169681821416800197089073&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_ecpm_v1~rank_v31_ecpm-12-117635432-null-null.142^v95^insert_down28v1&utm_term=width_per_group&spm=1018.2226.3001.4187)

#### 7.3.2.1 ***Resnet50ä½¿ç”¨çš„æ®‹å·®å—Bottleneck***

```py
class Bottleneck(nn.Module):
    """
    æ³¨æ„ï¼šåŸè®ºæ–‡ä¸­ï¼Œåœ¨è™šçº¿æ®‹å·®ç»“æ„çš„ä¸»åˆ†æ”¯ä¸Šï¼Œç¬¬ä¸€ä¸ª1x1å·ç§¯å±‚çš„æ­¥è·æ˜¯2ï¼Œç¬¬äºŒä¸ª3x3å·ç§¯å±‚æ­¥è·æ˜¯1ã€‚
    ä½†åœ¨pytorchå®˜æ–¹å®ç°è¿‡ç¨‹ä¸­æ˜¯ç¬¬ä¸€ä¸ª1x1å·ç§¯å±‚çš„æ­¥è·æ˜¯1ï¼Œç¬¬äºŒä¸ª3x3å·ç§¯å±‚æ­¥è·æ˜¯2ï¼Œ
    è¿™ä¹ˆåšçš„å¥½å¤„æ˜¯èƒ½å¤Ÿåœ¨top1ä¸Šæå‡å¤§æ¦‚0.5%çš„å‡†ç¡®ç‡ã€‚
    å¯å‚è€ƒResnet v1.5 https://ngc.nvidia.com/catalog/model-scripts/nvidia:resnet_50_v1_5_for_pytorch
    """
    expansion = 4
    #å–4æ˜¯å› ä¸ºç¬¬ä¸‰å±‚çš„æ·±åº¦ä¼šç¿»4å€

    def __init__(self, in_channel, out_channel, stride=1, downsample=None,
                 groups=1, width_per_group=64):
        super(Bottleneck, self).__init__()
        #out_channelæ˜¯æŒ‡ç¬¬1,2å±‚çš„æ·±åº¦,width_per_groupæ˜¯æŒ‡?,å…¶ä½™ä¸2å±‚æ®‹å·®å—ä¸€è‡´

        width = int(out_channel * (width_per_group / 64.)) * groups
        #widthæ˜¯æŒ‡ä¸€é€šè®¡ç®—ä»¥åç¬¬1,2å±‚çš„æ·±åº¦,è¿™é‡Œä¸out_channelç›¸ç­‰
        
        """
        ç®—ä¾‹:ä»¥conv_3å®çº¿ç»“æ„ä¸ºä¾‹
        """
        self.conv1 = nn.Conv2d(in_channels=in_channel, out_channels=width,
                               kernel_size=1, stride=1, bias=False)  # squeeze channels
        self.bn1 = nn.BatchNorm2d(width)
        # -----------------------------------------
        self.conv2 = nn.Conv2d(in_channels=width, out_channels=width, groups=groups,
                               kernel_size=3, stride=stride, bias=False, padding=1)
        #ç¬¬äºŒå±‚çš„å·ç§¯æ ¸æ­¥é•¿å½“è¿›è¡Œä¸‹é‡‡æ ·(è™šçº¿è¿æ¥)æ—¶ä¸º2,æ•…è¿™é‡Œå®šä¸ºstride
        self.bn2 = nn.BatchNorm2d(width)
        # -----------------------------------------
        self.conv3 = nn.Conv2d(in_channels=width, out_channels=out_channel*self.expansion,
                               kernel_size=1, stride=1, bias=False)  # unsqueeze channels
        #ç¬¬ä¸‰å±‚è¦æ³¨æ„æ·±åº¦ç¿»4å€
        self.bn3 = nn.BatchNorm2d(out_channel*self.expansion)
        self.relu = nn.ReLU(inplace=True)
        self.downsample = downsample

    def forward(self, x):
        identity = x
        if self.downsample is not None:
            identity = self.downsample(x)

        out = self.conv1(x)
        out = self.bn1(out)
        out = self.relu(out)

        out = self.conv2(out)
        out = self.bn2(out)
        out = self.relu(out)

        out = self.conv3(out)
        out = self.bn3(out)

        out += identity
        out = self.relu(out)

        return out
```

### 7.3.3 Resnetæ­å»º

#### 7.3.3.1 conv1æ­å»º

```py
self.conv1 = nn.Conv2d(3, self.in_channel, kernel_size=7, stride=2,
                               padding=3, bias=False)
self.bn1 = nn.BatchNorm2d(self.in_channel)
self.relu = nn.ReLU(inplace=True)
self.maxpool = nn.MaxPool2d(kernel_size=3, stride=2, padding=1)
#å…¶ä½™ç•¥ï¼Œè¯¦è§åšå®¢
```

#### 7.3.3.2 conv2_x~conv5_xæ­å»º

```py
#ä½¿ç”¨_make_layer()æ­å»ºï¼š
#blockï¼šBasicBlock/Bottleneck
#channelï¼šæ®‹å·®å—ä¸­ç¬¬ä¸€ä¸ªå·ç§¯å±‚çš„å·ç§¯æ ¸ä¸ªæ•°
#block_numï¼šæ®‹å·®å—ä¸ªæ•° 
#å…·ä½“å®šä¹‰è¯¦è§åšå®¢
def _make_layer(self, block, channel, block_num, stride=1):
-----------------------------------------------------------
#æ­å»º
self.layer1 = self._make_layer(block, 64, blocks_num[0])
self.layer2 = self._make_layer(block, 128, blocks_num[1], stride=2)
self.layer3 = self._make_layer(block, 256, blocks_num[2], stride=2)
self.layer4 = self._make_layer(block, 512, blocks_num[3], stride=2)
```

#### 7.3.3.3 forward( )æ­å»º

```py
def forward(self, x):
        x = self.conv1(x)
        x = self.bn1(x)

        x = self.relu(x)
        x = self.maxpool(x)

        x = self.layer1(x)
        x = self.layer2(x)
        x = self.layer3(x)
        x = self.layer4(x)

        if self.include_top:  # ä¸€èˆ¬ä¸ºTrue
            x = self.avgpool(x)
            x = torch.flatten(x, 1)
            x = self.fc(x)

        return x
```

#### 7.3.3.4 å®šä¹‰ä¸åŒç±»å‹çš„Resnet

```py
def resnet50(num_classes=1000, include_top=True):
    # https://download.pytorch.org/models/resnet50-19c8e357.pth
    return ResNet(Bottleneck, [3, 4, 6, 3], num_classes=num_classes, include_top=include_top)


def resnet34(num_classes=1000, include_top=True):
    # https://download.pytorch.org/models/resnet34-333f7ec4.pth
    return ResNet(BasicBlock, [3, 4, 6, 3], num_classes=num_classes, include_top=include_top)


def resnet101(num_classes=1000, include_top=True):
    # https://download.pytorch.org/models/resnet101-5d3b4d8f.pth
    return ResNet(Bottleneck, [3, 4, 23, 3], num_classes=num_classes, include_top=include_top)
```

### 7.3.4 è®­ç»ƒ









## 7.4 [MLP/ANN](MLP/ANN)

 å¤šå±‚æ„ŸçŸ¥æœºï¼ˆMLPï¼ŒMultilayer Perceptronï¼‰ä¹Ÿå«[äººå·¥ç¥ç»ç½‘ç»œ](https://so.csdn.net/so/search?q=äººå·¥ç¥ç»ç½‘ç»œ&spm=1001.2101.3001.7020)ï¼ˆANNï¼ŒArtificial Neural Networkï¼‰ï¼Œé™¤äº†è¾“å…¥è¾“å‡ºå±‚ï¼Œå®ƒä¸­é—´å¯ä»¥æœ‰å¤šä¸ªéšå±‚ï¼Œæœ€ç®€å•çš„MLPåªå«ä¸€ä¸ªéšå±‚ï¼Œå³ä¸‰å±‚çš„ç»“æ„ï¼Œå¦‚ä¸‹å›¾ï¼š

1
